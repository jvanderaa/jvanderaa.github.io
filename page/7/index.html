
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Josh VanDeraa">
      
      
        <link rel="canonical" href="https://josh-v.com/page/7/">
      
      
      
        <link rel="next" href="../../about/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.24">
    
    
      
        <title>üè† Home - Josh VanDeraa</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 12a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M6 13h8l-3.5 3.5 1.42 1.42L17.84 12l-5.92-5.92L10.5 7.5 14 11H6v2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-QCDLSTK9K6"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-QCDLSTK9K6",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-QCDLSTK9K6",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#home" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Josh VanDeraa" class="md-header__button md-logo" aria-label="Josh VanDeraa" data-md-component="logo">
      
  <img src="../../assets/router.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Josh VanDeraa
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              üè† Home
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jvanderaa/jvanderaa.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jvanderaa/jvanderaa.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  üè† Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
    
  
  üë§ About

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../book/" class="md-tabs__link">
        
  
    
  
  üìñ Book: OSS Net Mgmt

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../links/" class="md-tabs__link">
        
  
    
  
  üîó Links

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../archive/2024/" class="md-tabs__link">
          
  
    
  
  üìö Posts

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../category/ansible/" class="md-tabs__link">
          
  
    
  
  üè∑Ô∏è Categories

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Josh VanDeraa" class="md-nav__button md-logo" aria-label="Josh VanDeraa" data-md-component="logo">
      
  <img src="../../assets/router.png" alt="logo">

    </a>
    Josh VanDeraa
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jvanderaa/jvanderaa.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jvanderaa/jvanderaa.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    üè† Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="../.." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    üè† Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ansible-for-enterprise" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible for Enterprise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-for-automation-environment-ansible-210" class="md-nav__link">
    <span class="md-ellipsis">
      Docker for Automation Environment - Ansible 2.10
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-apple-automator-to-open-projects" class="md-nav__link">
    <span class="md-ellipsis">
      Using Apple Automator to Open Projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-cisco-ios-user-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Cisco IOS User Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-cisco-ios_interfaces-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Cisco ios_interfaces module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disney-plus-streaming-bandwidth" class="md-nav__link">
    <span class="md-ellipsis">
      Disney Plus Streaming Bandwidth
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-differences-between-ios-command-and-cli-command" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible differences between ios command and cli command
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eve-ng-for-automation-practice-and-testing" class="md-nav__link">
    <span class="md-ellipsis">
      EVE-NG for Automation Practice and Testing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üë§ About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../book/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üìñ Book: OSS Net Mgmt
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üîó Links
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìö Posts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üìö Posts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üè∑Ô∏è Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üè∑Ô∏è Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ansible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ansible
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/arista/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arista
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/asa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/asa_og/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asa_og
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/automation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    automation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco_ios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco_ios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco_nxos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco_nxos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco_wlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco_wlc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/communications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    communications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/debian/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    debian
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/devnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    devnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/earth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    earth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/eveng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eveng
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/expert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    expert
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/flask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flask
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/golang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    golang
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/golf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    golf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/graphql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/hashicorp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hashicorp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/homeassistant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    homeassistant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ios_interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ios_interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/juniper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    juniper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/meraki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    meraki
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nautobot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nautobot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/netbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netbox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/netdevops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netdevops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/netmiko/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netmiko
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/network-simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network simulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/network_design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/networking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    networking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nornir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nornir
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/poetry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    poetry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/productivity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    productivity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/prometheus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prometheus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/redux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/saving_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    saving_config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/slack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/vault/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vault
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/wan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wan
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ansible-for-enterprise" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible for Enterprise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-for-automation-environment-ansible-210" class="md-nav__link">
    <span class="md-ellipsis">
      Docker for Automation Environment - Ansible 2.10
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-apple-automator-to-open-projects" class="md-nav__link">
    <span class="md-ellipsis">
      Using Apple Automator to Open Projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-cisco-ios-user-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Cisco IOS User Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-cisco-ios_interfaces-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Cisco ios_interfaces module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disney-plus-streaming-bandwidth" class="md-nav__link">
    <span class="md-ellipsis">
      Disney Plus Streaming Bandwidth
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-differences-between-ios-command-and-cli-command" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible differences between ios command and cli command
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eve-ng-for-automation-practice-and-testing" class="md-nav__link">
    <span class="md-ellipsis">
      EVE-NG for Automation Practice and Testing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="home">üè† Home<a class="headerlink" href="#home" title="Permanent link">#</a></h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2020-08-11 00:00:00">August 11, 2020</time></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-for-enterprise"><a class="toclink" href="../../ansible_for_enterprise/">Ansible for Enterprise</a></h2>
<p>One of the appealing features that I have towards working with Ansible is that it is able to
automate components across the entire Enterprise IT stacks. Rather than having to stitch together
your network, server, and desktop automation tools, there is at least one automation tool that will
work with just about your entire IT stack. In this I will take a high level overview of some of the
features that are there for you to explore.</p>
<h3 id="ansible-for-network-automation"><a class="toclink" href="../../ansible_for_enterprise/#ansible-for-network-automation">Ansible for Network Automation</a></h3>
<p>The first area that I will be brief on is from the network side of things. I am a long time network
engineer and that is close to my heart.  </p>
<p>Ansible is agentless and uses SSH as it's communication path. That leads well to interacting with
some of the more legacy network devices. Ansible also supports using the newer tooling of APIs from
devices, so until all of your entire Enterprise IT infrastructure supports API calls for automation,
Ansible can definitely fit the bill.  </p>
<p>The other interesting shift in the modules for networking is the move towards helping with intent
based configuration. The newer modules being written by the Ansible team have an absolute intent
configuration to them. This being that you need to send through your entire defined state to the
modules, or else they will be seen as intended to have a blank configuration. The modules will then
configure the devices as such. To see more on that look at my
<a href="https://josh-v.com/blog/2020/01/26/ansible-cisco-ios-interfaces-module.html">post on the interfaces module</a>.</p>
<p>If you are running an OS in your network that is Linux based, then you are in luck as well! Continue
to the next section about Linux automation.</p>
<h3 id="ansible-for-linux-server-automation"><a class="toclink" href="../../ansible_for_enterprise/#ansible-for-linux-server-automation">Ansible for Linux Server Automation</a></h3>
<p>This is the original purpose of Ansible. It was built to automate Linux systems. Many of the core
modules that will be part of the Ansible base moving forward are modules that you use to manage
Linux systems. This is an absolute fit for the market. The times that I have written Ansible
Playbooks for Linux OS it has been a joy to work with and works very smoothly.</p>
<h3 id="ansible-for-docker"><a class="toclink" href="../../ansible_for_enterprise/#ansible-for-docker">Ansible for Docker</a></h3>
<p>Ansible is able to automate your Docker environment as well. With support for both Docker containers
and docker-compose functionality. This will help you through your life cycle of Docker containers.
Although it does not get to the level of what Kubernetes will do from an orchestration level without
some level of effort.</p>
<h3 id="ansible-for-windows"><a class="toclink" href="../../ansible_for_enterprise/#ansible-for-windows">Ansible for Windows</a></h3>
<p>Ansible for Windows is a thing! Although I do think it takes a little more effort to get off the
ground than even the network side. You need to enable WinRM on the Windows host for the
functionality to work. After that under the hood instead of using Python Ansible is leveraging
PowerShell code to interact with Windows OS. So yes, you can automate Windows devices.</p>
<h3 id="ansible-for-macos"><a class="toclink" href="../../ansible_for_enterprise/#ansible-for-macos">Ansible for MacOS</a></h3>
<p>Being a *nix operating system, you can manage your Mac deployment with Ansible. Now you just need
to make sure the hosts are online when executing. So there isn't an out of the box check in agent
within Ansible. That's what makes Ansible awesome for networking is that it is agentless. Take a
look at Ansible for your Macs.</p>
<h3 id="ansible-for-cloud"><a class="toclink" href="../../ansible_for_enterprise/#ansible-for-cloud">Ansible for Cloud</a></h3>
<p>I will need to find the link again, but Ansible is one of the largest percentage increase in tools
to manage your cloud environments. There are quite the number of modules available for the leading
public cloud (and private) providers. If there isn't a specific module, one characteristic of a
good cloud environment these days is the ability to have a REST API. With Ansible you can leverage
the URI module for this.  </p>
<p>On the cloud module front, take a look at the table below. This is the number of modules that there
are within Ansible for managing their cloud environment. In my opinion, that is quite a bit and can
get you what you need.</p>
<table>
<thead>
<tr>
<th>Cloud</th>
<th>Module Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>AWS</td>
<td>45+</td>
</tr>
<tr>
<td>Azure</td>
<td>169</td>
</tr>
<tr>
<td>Oracle Cloud</td>
<td>30 ‚Äúservices‚Äù</td>
</tr>
<tr>
<td>Google</td>
<td>153</td>
</tr>
<tr>
<td>Digital Ocean</td>
<td>22</td>
</tr>
<tr>
<td>Rackspace</td>
<td>26</td>
</tr>
<tr>
<td>Avi Networks</td>
<td>65</td>
</tr>
<tr>
<td>VMWare</td>
<td>140+</td>
</tr>
</tbody>
</table>
<h3 id="downside-of-ansible"><a class="toclink" href="../../ansible_for_enterprise/#downside-of-ansible">Downside of Ansible</a></h3>
<p>The biggest downside to leveraging Ansible would be the timeliness of execution. If you are looking
for speed on execution, then Ansible would either need some tweaks (such as installing mitogen).  </p>
<p>When it comes to automation, in my book the first gain is not speed. Speed is a by product of not
having to do rework and to move verification into an automated state. The real gain is by having a
consistent environment. Then moving your operations into Playbooks, which many may have heard of a
"runbook" which defines the process. Now your process is defined into a system that actually does
something.</p>
<h3 id="summary"><a class="toclink" href="../../ansible_for_enterprise/#summary">Summary</a></h3>
<p>In my opinion Ansible is still a right tool for the job when it comes to automating both your
network environments, and your entire enterprise IT stack. I encourage you to take a look, evaluate
other options as well. I hope this summary may be helpful. Let me know your thoughts in the comments
or on Twitter/LinkedIn.</p>
<p>Josh</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2020-06-27 00:00:00">June 27, 2020</time></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="docker-for-automation-environment-ansible-210"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/">Docker for Automation Environment - Ansible 2.10</a></h2>
<p>Docker is a terrific solution for making a consistent working environment. It's been about a year or
so since I built my very first own Docker container. I had always known why you use a container, but
was always intimidated too much so to even get started. I am glad that I did get started and am off
on my journey of using Docker containers. Let me jump into the problem and why? Couple the recent
experiences with Docker, and the upcoming move to slim down Ansible and install Collections for
most Network Automation modules, I thought it would be a good thing to get a write up done.</p>
<h3 id="problem"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#problem">Problem</a></h3>
<p>From a Network Automation standpoint, there is much change still occurring in the tooling ecosystem.
First that January 1, 2020 marked the end of support for Python 2.7. Yet there are still many setups
that require Python 2.7.  </p>
<p>Upcoming Ansible is changing the behavior from a full batteries included for Network Automation
tooling, moving over to a base package where you install Collections on top of it. This is going to
be, in my opinion, a second driver for really digging into using containers for your enterprise
automation envrionment.</p>
<h3 id="why-is-it-a-solution"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#why-is-it-a-solution">Why is it a Solution?</a></h3>
<h4 id="ansible-experience"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#ansible-experience">Ansible Experience</a></h4>
<p>This is a solution because it helps that you do your development work within a container. When you
run the command <code>ansible-playbook</code> you are getting the <code>ansible-playbook</code> executable that is built
into the container image. If outside of a container, there are several things that could happen. You
may install some things with Python 2, could with Python 3, which version of Python 3? Which version
of Python does the executables associated with Ansible reference? There are several methods to get
multiple versions of Python to be executing on your system. Installing Ansible dependencies into the
wrong Python PIP can definitely hamper it.</p>
<h4 id="i-dont-use-ansible-why-then"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#i-dont-use-ansible-why-then">I Don't Use Ansible, Why Then?</a></h4>
<p>This is an answer still for both Ansible and Python a like. One, if you mess up an installation you
just rebuild the container image. Yes, it is shorter to just delete a virtual environment as well.
When you go to install the Python application into the customer environment, you get portability, as
you bring your own Python installation with the container. As long as the customer supports
containers it adds portability. No more differing sets of instructions. Just a simple, docker
command or update of a docker-compose file and away you go.  </p>
<h4 id="portability"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#portability">Portability</a></h4>
<p>One of the tenants of the <a href="https://www.12factor.net">12-factor app</a> for developing modern apps is to
ask the question if you could open source your project tomorrow. If developing in virtual
environments you will still need to have a setup instruction set that could miss something that you
just have in your environment. With a container you bring a blank OS to the table inside of the
container. You install explicitly everything you need to get the app up and running.</p>
<h4 id="rhel-vs-ubuntu-vs-macos-vs-any-other-linux-os"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#rhel-vs-ubuntu-vs-macos-vs-any-other-linux-os">RHEL vs Ubuntu vs MacOS vs Any Other Linux OS</a></h4>
<p>The next thing about containers if you are going to interact with a file system in any way is that
you get consistency for your app. No longer do you need to understand how to interact with MacOS
with this command, and CentOS is this command, and Ubuntu is this other command. You choose the base
OS image, and interact with it as such.</p>
<h3 id="getting-started"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#getting-started">Getting Started</a></h3>
<p>My methodology for getting started with Docker was to read some getting started guides, and adapt
them for my Network Automation flavor. I'm going to try to walk you along so you can learn from some
of the things I learned along the way, and improve upon them.  </p>
<p>I started off with installing Docker Desktop on my Mac. The best way to get started is to install
Docker onto your OS of choice. The installation guide is <a href="https://docs.docker.com/get-docker/">https://docs.docker.com/get-docker/</a>. There
is also a HomeBrew package available for installing Docker as well.  </p>
<h4 id="docker-labs-on-the-internet"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#docker-labs-on-the-internet">Docker Labs on the Internet</a></h4>
<p>There are several resources available on the Internet for you to get experience with Docker.</p>
<ul>
<li><a href="https://developer.cisco.com/learning/lab/docker-101/step/1">Cisco DevNet Learning Labs</a></li>
<li><a href="https://labs.play-with-docker.com/">Play with Docker Labs</a> </li>
</ul>
<p>I encourage you to take a look at these if you do not want to get started on your own in your own
machine. The following examples will be done on your local machine.</p>
<h4 id="writing-a-dockerfile"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#writing-a-dockerfile">Writing A Dockerfile</a></h4>
<p>A Dockerfile is the set of instructions of how to build your container. So if you want to follow
along, create a directory anywhere that is accessible via command line called <code>docker_test</code>. Take
the following and paste it into a file called <code>Dockerfile</code>.  </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>FROM<span class="w"> </span>python:3.8.3-slim-buster
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>RUN<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>sshpass<span class="w"> </span>vim<span class="w"> </span>-y
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>COPY<span class="w"> </span>.<span class="w"> </span>/local
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>WORKDIR<span class="w"> </span>/local
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>RUN<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>RUN<span class="w"> </span>ansible-galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.yml
</span></code></pre></div>
<p>What this is doing:</p>
<table>
<thead>
<tr>
<th>Line Number</th>
<th>Outline</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Selecting the base image, this can be found on <a href="https://hub.docker.com">https://hub.docker.com</a>, searching Python</td>
</tr>
<tr>
<td>3</td>
<td>Installing <code>sshpass</code> and <code>vim</code> via apt. Updating the apt repo list first. Being a slim image, VIM is not pre-installed</td>
</tr>
<tr>
<td>5</td>
<td>Copies everything in the local directory into a directory /local</td>
</tr>
<tr>
<td>6</td>
<td>Changes the working directory, similar to <code>cd</code> in many OSes</td>
</tr>
<tr>
<td>8</td>
<td>Installs Python packages from the local <code>requirements.txt</code> file that was copied on line 5</td>
</tr>
<tr>
<td>9</td>
<td>Uses <code>ansible-galaxy</code> to install Galaxy collections from the local <code>requirements.yml</code> file</td>
</tr>
</tbody>
</table>
<p>To have this work right, lets use this as an opportunity to test out installing the new version of
Ansible into a container, by pip installing <code>ansible-base</code>.  </p>
<p>In order to build this container, you will need to have a requirements file ready to go for both
Python and Ansible Galaxy. So to this effort, here are those two files with a few packages:</p>
<h5 id="requirementstxt"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#requirementstxt">requirements.txt</a></h5>
<div class="language-toml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">ansible-base</span>
</span></code></pre></div></td></tr></table></div>
<p>The only Python package going to install this for is <code>ansible-base</code> which will install the current
beta versions of Ansible Base 2.10.</p>
<h5 id="requirementsyml"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#requirementsyml">requirements.yml</a></h5>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nn">---</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1"># Collection Installations</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nt">collections</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco.asa</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0.0</span>
</span></code></pre></div>
<p>This has a few more keys to the requirements.yml file that Ansible Galaxy will install with. The YML
file first has a key of <code>collections</code>. This is because you can use the file to install both roles
and collections, not just collections. Here this will install the 1.0.0 release of the Ansible
modules for the Cisco ASA platform. You will likely need to add additional roles to here. To get the
name you leverage <a href="https://galaxy.ansible.com">https://galaxy.ansible.com</a> to search and find the modules that you would install.</p>
<h3 id="helper"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#helper">Helper</a></h3>
<p>The last piece I'd like to provide some info on as well is a helper file. Many of the *nix systems
have Make available to them. If unable to use Make on your filesystem, I will suggest to take a look
at the Python package <a href="http://www.pyinvoke.org/">invoke</a>. Invoke does have more flexibility than
make as it is written in Python, but for this demo I want to use Make so you can see the command
line commands that are used.  </p>
<p>The arguments for Make are made available by defining information in a <code>Makefile</code>. Here is the
Makefile that I will be using for this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">IMG_NAME</span><span class="o">=</span>jvanderaa/network_automation
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="nv">IMG_VERSION</span><span class="o">=</span><span class="m">2</span>.0-rc2
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>.DEFAULT_GOAL<span class="w"> </span>:<span class="o">=</span><span class="w"> </span>cli
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>.PHONY:<span class="w"> </span>build
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>build:
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">    </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span><span class="k">$(</span>IMG_NAME<span class="k">)</span>:<span class="k">$(</span>IMG_VERSION<span class="k">)</span><span class="w"> </span>.<span class="w"> </span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>.PHONY:<span class="w"> </span>cli
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>cli:
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">        </span>-v<span class="w"> </span><span class="k">$(</span>shell<span class="w"> </span><span class="nb">pwd</span><span class="k">)</span>:/local<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">        </span>-w<span class="w"> </span>/local<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">        </span><span class="k">$(</span>IMG_NAME<span class="k">)</span>:<span class="k">$(</span>IMG_VERSION<span class="k">)</span><span class="w"> </span>bash
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Line Number</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Defining a variable for image name, here <code>jvanderaa/network_automation</code></td>
</tr>
<tr>
<td>2</td>
<td>Defining a variable for IMG_VERSION so you can version your Docker containers</td>
</tr>
<tr>
<td>3</td>
<td>Setting a default goal so you can just type make and that is what will be done</td>
</tr>
<tr>
<td>5</td>
<td>.PHONY is saying that this is a phony file that is upcoming. It is best practice to include but not required</td>
</tr>
<tr>
<td>6</td>
<td>The key build: is what will be executed with the <code>make build</code> command</td>
</tr>
<tr>
<td>7</td>
<td>The actual command, it is <strong>tabbed</strong> in. You <strong>MUST NOT</strong> use spaces and <strong>MUST</strong> use tabs with Make</td>
</tr>
<tr>
<td>9</td>
<td>Definition of .PHONY for CLI</td>
</tr>
<tr>
<td>10</td>
<td>Defining a key of cli for <code>make cli</code> or just <code>make</code> due to the default goal defined</td>
</tr>
<tr>
<td>11</td>
<td>Start of the Docker run command, which includes mapping the local directory into the container directory so you can make live updates, changing the working directory, and launching bash</td>
</tr>
</tbody>
</table>
<h3 id="building-the-container"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#building-the-container">Building The Container</a></h3>
<p>First in my container image list I have no containers (I just pruned them all, and they are now all
deleted with the command <code>docker system prune -a</code>):</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>$<span class="w"> </span>docker<span class="w"> </span>image<span class="w"> </span>ls<span class="w">       </span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>REPOSITORY<span class="w">          </span>TAG<span class="w">                 </span>IMAGE<span class="w"> </span>ID<span class="w">            </span>CREATED<span class="w">             </span>SIZE
</span></code></pre></div></td></tr></table></div>
<p>With no containers, I execute the command from the <code>Makefile</code> of <code>make build</code>. This will download
all of the layers, run the apt installations, pip install, and galaxy install. The output is below
with many of the lines removed.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>jvanderaa/network_automation:2.0-rc2<span class="w"> </span>.<span class="w"> </span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>Sending<span class="w"> </span>build<span class="w"> </span>context<span class="w"> </span>to<span class="w"> </span>Docker<span class="w"> </span>daemon<span class="w">   </span><span class="m">5</span>.12kB
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>Step<span class="w"> </span><span class="m">1</span>/6<span class="w"> </span>:<span class="w"> </span>FROM<span class="w"> </span>python:3.8.3-slim-buster
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="m">3</span>.8.3-slim-buster:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/python
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a>8559a31e96f4:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a>62e60f3ef11e:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a>93c8ae153782:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a>ea222f757df7:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a>e97d3933bbbe:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span><span class="w"> </span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a>Digest:<span class="w"> </span>sha256:938fd520a888e9dbac3de374b8ba495cc50fe96440030264a40f733052001895
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a>Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>python:3.8.3-slim-buster
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w"> </span>---&gt;<span class="w"> </span>9d84edf35a0a
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13"></a>Step<span class="w"> </span><span class="m">2</span>/6<span class="w"> </span>:<span class="w"> </span>RUN<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>sshpass<span class="w"> </span>vim<span class="w"> </span>-y
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="w"> </span>---&gt;<span class="w"> </span>Running<span class="w"> </span><span class="k">in</span><span class="w"> </span>66e37abb454a
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15"></a>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16"></a>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="o">[</span><span class="w"> </span>I<span class="w"> </span>REMOVED<span class="w"> </span>A<span class="w"> </span>BUNCH<span class="w"> </span>OF<span class="w"> </span>LINES<span class="w"> </span>HERE<span class="o">]</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18"></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19"></a>Step<span class="w"> </span><span class="m">6</span>/6<span class="w"> </span>:<span class="w"> </span>RUN<span class="w"> </span>ansible-galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.yml
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="w"> </span>---&gt;<span class="w"> </span>Running<span class="w"> </span><span class="k">in</span><span class="w"> </span>94ca0bb3f3c9
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21"></a>Starting<span class="w"> </span>galaxy<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>process
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22"></a>Process<span class="w"> </span>install<span class="w"> </span>dependency<span class="w"> </span>map
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23"></a>Starting<span class="w"> </span>collection<span class="w"> </span>install<span class="w"> </span>process
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24"></a>Installing<span class="w"> </span><span class="s1">&#39;cisco.asa:1.0.0&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/root/.ansible/collections/ansible_collections/cisco/asa&#39;</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25"></a>Installing<span class="w"> </span><span class="s1">&#39;ansible.netcommon:1.0.0&#39;</span><span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;/root/.ansible/collections/ansible_collections/ansible/netcommon&#39;</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26"></a>Removing<span class="w"> </span>intermediate<span class="w"> </span>container<span class="w"> </span>94ca0bb3f3c9
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="w"> </span>---&gt;<span class="w"> </span>0805ddb1719f
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28"></a>Successfully<span class="w"> </span>built<span class="w"> </span>0805ddb1719f
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29"></a>Successfully<span class="w"> </span>tagged<span class="w"> </span>jvanderaa/network_automation:2.0-rc2
</span></code></pre></div></td></tr></table></div>
<p>If you have followed along, congratulations, you have created your first Docker Image. This is what
will be used to create additional containers, which are a copy of the image, but a whole separate
container.  </p>
<p>Because of the tags, I prefer to use the <code>Makefile</code> to execute my containers as well. Now I just go
to the command line within the container by issuing <code>make cli</code> command. This will then take me to
the root user prompt of my conatiner.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="l l-Scalar l-Scalar-Plain">$ make cli</span><span class="w">  </span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="l l-Scalar l-Scalar-Plain">docker run -it \</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">-v /Users/joshv/projects/docker_test:/local \</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">-w /local \</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">                </span><span class="l l-Scalar l-Scalar-Plain">jvanderaa/network_automation:2.0-rc2 bash</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="l l-Scalar l-Scalar-Plain">root@58a4ea071203:/local# ansible-galaxy collection list</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="l l-Scalar l-Scalar-Plain"># /root/.ansible/collections/ansible_collections</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="l l-Scalar l-Scalar-Plain">Collection        Version</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="l l-Scalar l-Scalar-Plain">----------------- -------</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="l l-Scalar l-Scalar-Plain">ansible.netcommon 1.0.0</span><span class="w">  </span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="l l-Scalar l-Scalar-Plain">cisco.asa         1.0.0</span><span class="w">  </span>
</span></code></pre></div></td></tr></table></div>
<p>Inside of the container I execute the command <code>ansible-galaxy collection list</code>. This now shows me
that there are two collections installed:</p>
<ul>
<li>ansible.netcommon</li>
<li>cisco.asa</li>
</ul>
<h3 id="summary"><a class="toclink" href="../../docker_for_automation_environment_ansible_210/#summary">Summary</a></h3>
<p>With the container built, and a Dockerfile in place. I can now upload the Dockerfile along with the
rest of the project file to Git. This coupled with the Makefile will help to build any system
quickly. No more trying to find a place to host the Docker image (like Docker Hub), how to install
into the proper Python executable any modules that may be needed (like pandevice for PANOS modules)
or other SDKs that are helpers to the Ansible Collections being created.  </p>
<p>Hopefully this has been helpful. Take a look at the links!</p>
<p>Thanks,</p>
<p>-Josh</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2020-06-21 00:00:00">June 21, 2020</time></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="using-apple-automator-to-open-projects"><a class="toclink" href="../../apple_automator/">Using Apple Automator to Open Projects</a></h2>
<p>Today I'm going to walk through the newest part of my personal workflow for working with projects.
Straight to the point, this is going to be using Apple Automator to quickly open your project that
you wish to work on within VS Code, and presumably PyCharm as well.  </p>
<h3 id="problem"><a class="toclink" href="../../apple_automator/#problem">Problem</a></h3>
<p>So what is the problem that I'm trying to solve? I am one that generally likes the workspace concept
within VS Code, but I don't like having to maintain workspace files. I have found them a little
difficult to maintain and keep organized. To that end I have found that there is an option to
install VS Code shortcut into your OS path from the command pallet (cmd-P), and <code>path</code>.</p>
<p><img alt="VS Code Path" src="/images/2020/vscode-path.png" /></p>
<p>Once this is installed, you can issue at a terminal (or iTerm2) prompt the command <code>code .</code> and this
will bring up VS Code from the folder that you are currently working on.  </p>
<p>This sounds great, what is the problem? Well, I tend to open a lot of iTerm2 tabs just to open up
and go into VS Code. While working in VS Code, I then use the terminal that is baked into VS Code as
my terminal. So I have a window that is open unnecessarily.</p>
<h3 id="my-solution-apple-script-and-automator"><a class="toclink" href="../../apple_automator/#my-solution-apple-script-and-automator">My Solution - Apple Script and Automator</a></h3>
<p>So I was reminded about Apple Automator for some particular reason and I thought this would be a
great solution to opening VS Code directly to my folder that I want to work on and be able to close
VS Code windows whenever I was done working in a folder. So for me I use a specific directory on my
Mac to have all of my projects in them. This is a typical directory structure:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>projects
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>‚îú‚îÄ‚îÄ<span class="w"> </span>project1
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>‚îú‚îÄ‚îÄ<span class="w"> </span>project2
</span></code></pre></div>
<h4 id="automator-flow"><a class="toclink" href="../../apple_automator/#automator-flow">Automator Flow</a></h4>
<p>The flow is going to have a prompt come to the top when a command shortcut is executed. So -&gt;:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>command-shortcut<span class="w"> </span>-&gt;<span class="w"> </span>Select<span class="w"> </span>project<span class="w"> </span>-&gt;<span class="w"> </span>Open<span class="w"> </span>VS<span class="w"> </span>Code
</span></code></pre></div>
<h4 id="start-a-new-quick-action"><a class="toclink" href="../../apple_automator/#start-a-new-quick-action">Start a New Quick Action</a></h4>
<p>When creating a new document in your Automator, make sure to select the type as <strong>Quick Action</strong>.
This type is needed in order to use the Keyboard shortcut later.</p>
<h4 id="first-step-run-applescript"><a class="toclink" href="../../apple_automator/#first-step-run-applescript">First Step: Run AppleScript</a></h4>
<p>I looked at a couple of options here to get the prompt to display. From what I could tell there was
options in both AppleScript and JavaScript. I choose to stick with AppleScript in the current
iteration for ease of access to the file system. I will have to do additional research, but that
would be for a learning thing, not necessarily for productivity gains. I worked through a few links
and eventually came up with the following AppleScript:</p>
<div class="language-applescript highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">on</span> <span class="nb">run</span> <span class="p">{</span><span class="nv">input</span><span class="p">,</span> <span class="nv">parameters</span><span class="p">}</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="c"># Define the folder that is being used as project directory. This is the only thing that needs to be set</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="k">set</span> <span class="nv">projectFolder</span> <span class="k">to</span> <span class="s2">&quot;/Users/joshv/projects/&quot;</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="c"># Use the finder application to get the list of all the folders inside of the folder</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    <span class="k">tell</span> <span class="nb">application</span> <span class="s2">&quot;Finder&quot;</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>        <span class="k">set</span> <span class="nv">fileList</span> <span class="k">to</span> <span class="k">get</span> <span class="na">name</span> <span class="k">of</span> <span class="nv">folders</span> <span class="k">of</span> <span class="nv">folder</span> <span class="p">(</span><span class="nv">projectFolder</span> <span class="k">as</span> <span class="nv">POSIX</span> <span class="nv">file</span><span class="p">)</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>    <span class="k">end</span> <span class="k">tell</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="c"># Create a prompt</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>    <span class="nb">choose from list</span> <span class="nv">fileList</span> <span class="nv">with</span> <span class="na">prompt</span> <span class="s2">&quot;Which project?&quot;</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="c"># Create a string of projectFolder with result of response</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    <span class="k">set</span> <span class="nv">resultString</span> <span class="k">to</span> <span class="nv">projectFolder</span> <span class="o">&amp;</span> <span class="no">result</span> <span class="k">as </span><span class="nc">string</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    <span class="c"># Return the path</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="no">return</span> <span class="nb">the</span> <span class="nv">resultString</span> <span class="k">as </span><span class="nc">string</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="k">end</span> <span class="nb">run</span>
</span></code></pre></div>
<p>The only parameter that needs to be changed is the path to the directory on the third line, to match
what is your own project directory.</p>
<h4 id="second-step-run-shell-script"><a class="toclink" href="../../apple_automator/#second-step-run-shell-script">Second Step: Run Shell Script</a></h4>
<p>I then took the easy way out at the moment to execute an application. I will have to work to add
this all into one AppleScript or JavaScript execution in the future, but for now I know this works.
It is a short command, first I needed to find out where the <code>code</code> application that was mentioned
above is stored. So I did the command <code>which code</code> to get my path to the code shortcut. The final
result for me is:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>/usr/local/bin/code<span class="w"> </span><span class="nv">$1</span>
</span></code></pre></div>
<p>This takes an argument that is passed in from the AppleScript and passes it into the shell script.
The next change I needed to do on the Run Shell Script module of Automator was to set
<strong>Pass input</strong> to <em>as arguments</em> to pass it in as an argument.  </p>
<p>This now looks like the following from an Automator application:  </p>
<p><img alt="Automator" src="/images/2020/automator-complete.png" /></p>
<h4 id="keyboard-shortcuts"><a class="toclink" href="../../apple_automator/#keyboard-shortcuts">Keyboard Shortcuts</a></h4>
<p>Last thing to do is to assign a keyboard shortcut to your automation.</p>
<ol>
<li>Open Keyboard preferences</li>
<li>Select <strong>Shortcuts</strong></li>
<li>Select <em>Services</em> on the left</li>
<li>Scroll to the section <em>General</em></li>
<li>Find the name of your document that you created in Automator</li>
<li>Assign a keyboard shortcut, I'm using <code>CMD-Shift-'</code> for mine</li>
</ol>
<p><img alt="Shortcut" src="/images/2020/shortcuts.png" />  </p>
<p>Now when I select the keyboard shortcut, I get a visual prompt of the folders in the project folder
specified. And when I select the project and <strong>OK</strong> I am then taken to either a new VS Code window
based in that directory or the already opened VS Code window for that project folder.  </p>
<h3 id="summary"><a class="toclink" href="../../apple_automator/#summary">Summary</a></h3>
<p>Not all automation tools have to be Python, Ansible, or other modern language. You can use tools
that are provided that may feel old to help you in your every day work. Hopefully this comes in
handy for you as well! Let me know. In the end, if this helps great, otherwise this is good
documentation for myself if needed in the future!  </p>
<p>Thanks,</p>
<p>-Josh</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2020-03-14 00:00:00">March 14, 2020</time></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-cisco-ios-user-module"><a class="toclink" href="../../ansible-cisco-ios-user/">Ansible Cisco IOS User Module</a></h2>
<p>In this post I will be taking a look at some of the usability setup of managing Cisco IOS devices
with the <a href="https://docs.ansible.com/ansible/latest/modules/ios_config_module.html">Ansible Cisco IOS User Module</a>.
This can be very helpful for setting up managed user accounts on systems, or the backup user
accounts when you have TACACS or RADIUS setup.</p>
<p>The module documentation overall looks complete from what I have done for user account management on
devices in the past. There are a couple of interesting parameters available, that I may not get to
completely on this post. There is support for aggregate, meaning that you can generate the
configuration for multiple user accounts and pass it in as one. You can set a password in clear text
that gets encrypted when on the device, or you can set a hashed_password with the type of hash and
its corresponding value. And as expected with a module for setting user accounts you can also set
the privilege level for which the user account uses.</p>
<h3 id="ssh-before-setting-up-ssh-keys"><a class="toclink" href="../../ansible-cisco-ios-user/#ssh-before-setting-up-ssh-keys">SSH Before Setting Up SSH Keys</a></h3>
<p>You have probably seen this before, but for completeness sake I did get the output of the SSH login
banner. This has the default lab setup on the device. So we do get a banner, but I'm getting
prompted for a Password as well.</p>
<div class="language-shell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>ssh<span class="w"> </span>rtr-1
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>The<span class="w"> </span>authenticity<span class="w"> </span>of<span class="w"> </span>host<span class="w"> </span><span class="s1">&#39;rtr-1 (10.250.0.167)&#39;</span><span class="w"> </span>can<span class="s1">&#39;t be established.</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="s1">RSA key fingerprint is SHA256:iyEgRBFlLhkW+Z2OOYWPvrjuzhTVY9wULmoHkWYgbrw.</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="s1">Are you sure you want to continue connecting (yes/no)? yes</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="s1">Warning: Permanently added &#39;</span>rtr-1<span class="s1">&#39; (RSA) to the list of known hosts.</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="s1">Warning: the RSA host key for &#39;</span>rtr-1<span class="s1">&#39; differs from the key for the IP address &#39;</span><span class="m">10</span>.250.0.167<span class="s1">&#39;</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="s1">Offending key for IP in /Users/joshv/.ssh/known_hosts:170</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="s1">Are you sure you want to continue connecting (yes/no)? yes</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="s1">**************************************************************************</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="s1">* IOSv is strictly limited to use for evaluation, demonstration and IOS  *</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="s1">* education. IOSv is provided as-is and is not supported by Cisco&#39;</span>s<span class="w">      </span>*
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a>*<span class="w"> </span>Technical<span class="w"> </span>Advisory<span class="w"> </span>Center.<span class="w"> </span>Any<span class="w"> </span>use<span class="w"> </span>or<span class="w"> </span>disclosure,<span class="w"> </span><span class="k">in</span><span class="w"> </span>whole<span class="w"> </span>or<span class="w"> </span><span class="k">in</span><span class="w"> </span>part,<span class="w"> </span>*
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a>*<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>IOSv<span class="w"> </span>Software<span class="w"> </span>or<span class="w"> </span>Documentation<span class="w"> </span>to<span class="w"> </span>any<span class="w"> </span>third<span class="w"> </span>party<span class="w"> </span><span class="k">for</span><span class="w"> </span>any<span class="w">       </span>*
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a>*<span class="w"> </span>purposes<span class="w"> </span>is<span class="w"> </span>expressly<span class="w"> </span>prohibited<span class="w"> </span>except<span class="w"> </span>as<span class="w"> </span>otherwise<span class="w"> </span>authorized<span class="w"> </span>by<span class="w">     </span>*
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a>*<span class="w"> </span>Cisco<span class="w"> </span><span class="k">in</span><span class="w"> </span>writing.<span class="w">                                                      </span>*
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a>**************************************************************************Password:
</span></code></pre></div></td></tr></table></div>
<h3 id="adding-ssh-key-users"><a class="toclink" href="../../ansible-cisco-ios-user/#adding-ssh-key-users">Adding SSH Key Users</a></h3>
<p>Copying from the example on the module definition, I went ahead and created a playbook that will
create an account on the same device but with my local computer account. Here is the playbook:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nn">---</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PLAY</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">WORKING</span><span class="nv"> </span><span class="s">WITH</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">USER</span><span class="nv"> </span><span class="s">MODULE&quot;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco_routers</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Add</span><span class="nv"> </span><span class="s">local</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">SSH</span><span class="nv"> </span><span class="s">Key&quot;</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">      </span><span class="nt">ios_user</span><span class="p">:</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">joshv</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">        </span><span class="nt">nopassword</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">        </span><span class="nt">sshkey</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">lookup(&#39;file&#39;,</span><span class="nv"> </span><span class="s">&#39;~/.ssh/id_rsa.pub&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;FINAL</span><span class="nv"> </span><span class="s">TASK:</span><span class="nv"> </span><span class="s">Save</span><span class="nv"> </span><span class="s">Config&quot;</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">      </span><span class="nt">ios_config</span><span class="p">:</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">        </span><span class="nt">save_when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always</span>
</span></code></pre></div>
<p>It is a single play playbook, with 2 tasks. Task 1 will add the local id_rsa public key to the IOS
device. The final task is a play to save the configuration.</p>
<div class="language-shell highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span>
<span class="normal"><a href="#__codelineno-2-35">35</a></span>
<span class="normal"><a href="#__codelineno-2-36">36</a></span>
<span class="normal"><a href="#__codelineno-2-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>ansible-playbook<span class="w"> </span>working_with_ios_user-1.yml
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>PLAY<span class="w"> </span><span class="o">[</span>PLAY<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>WORKING<span class="w"> </span>WITH<span class="w"> </span>IOS<span class="w"> </span>USER<span class="w"> </span>MODULE<span class="o">]</span><span class="w"> </span>****************************************************
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Add<span class="w"> </span><span class="nb">local</span><span class="w"> </span>username<span class="w"> </span>with<span class="w"> </span>SSH<span class="w"> </span>Key<span class="o">]</span><span class="w"> </span>*************************************************
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="o">[</span>WARNING<span class="o">]</span>:<span class="w"> </span>Module<span class="w"> </span>did<span class="w"> </span>not<span class="w"> </span><span class="nb">set</span><span class="w"> </span>no_log<span class="w"> </span><span class="k">for</span><span class="w"> </span>update_password
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="o">[</span>WARNING<span class="o">]</span>:<span class="w"> </span>Module<span class="w"> </span>did<span class="w"> </span>not<span class="w"> </span><span class="nb">set</span><span class="w"> </span>no_log<span class="w"> </span><span class="k">for</span><span class="w"> </span>password_type
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>changed:<span class="w"> </span><span class="o">[</span>r1<span class="o">]</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a>TASK<span class="w"> </span><span class="o">[</span>debug<span class="o">]</span><span class="w"> </span>***********************************************************************************
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a>ok:<span class="w"> </span><span class="o">[</span>r1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="w">        </span><span class="s2">&quot;ansible_facts&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="w">            </span><span class="s2">&quot;discovered_interpreter_python&quot;</span>:<span class="w"> </span><span class="s2">&quot;/usr/bin/python&quot;</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="w">        </span><span class="o">}</span>,
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="w">            </span><span class="s2">&quot;ip ssh pubkey-chain&quot;</span>,
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="w">            </span><span class="s2">&quot;username joshv&quot;</span>,
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="w">            </span><span class="s2">&quot;key-hash ssh-rsa &lt;hash_masked&gt; joshv@&lt;adevice&gt;&quot;</span>,
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="w">            </span><span class="s2">&quot;exit&quot;</span>,
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="w">            </span><span class="s2">&quot;exit&quot;</span>,
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23"></a><span class="w">            </span><span class="s2">&quot;username joshv nopassword&quot;</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26"></a><span class="w">        </span><span class="s2">&quot;warnings&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27"></a><span class="w">            </span><span class="s2">&quot;Module did not set no_log for update_password&quot;</span>,
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="w">            </span><span class="s2">&quot;Module did not set no_log for password_type&quot;</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29"></a><span class="w">        </span><span class="o">]</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="o">}</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32"></a>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33"></a>TASK<span class="w"> </span><span class="o">[</span>FINAL<span class="w"> </span>TASK:<span class="w"> </span>Save<span class="w"> </span>Config<span class="o">]</span><span class="w"> </span>*****************************************************************
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34"></a>changed:<span class="w"> </span><span class="o">[</span>r1<span class="o">]</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35"></a>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>*************************************************************************************
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37"></a>r1<span class="w">                         </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">3</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">2</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="Playbook1 Execution" src="/images/2020/03/add_user_with_key_mask.gif" /></p>
<p>On execution one can see that the commands pushed in the debug task including setting up an IP SSH
keypair, setting a username of joshv, and setting the key hash. Then Ansible exits to what is
expected to be the first level of config mode and sets username <code>joshv</code> without a password.  </p>
<p>Execution is pretty much what we would expect of adding a username to the device. Taking a look at
if we get prompted when connecting to the device is a no, I do not.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="l l-Scalar l-Scalar-Plain">$ ssh rtr-1</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="l l-Scalar l-Scalar-Plain">**************************************************************************</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="l l-Scalar l-Scalar-Plain">* IOSv is strictly limited to use for evaluation, demonstration and IOS  *</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="l l-Scalar l-Scalar-Plain">* education. IOSv is provided as-is and is not supported by Cisco&#39;s      *</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="l l-Scalar l-Scalar-Plain">* Technical Advisory Center. Any use or disclosure, in whole or in part, *</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="l l-Scalar l-Scalar-Plain">* of the IOSv Software or Documentation to any third party for any       *</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="l l-Scalar l-Scalar-Plain">* purposes is expressly prohibited except as otherwise authorized by     *</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="l l-Scalar l-Scalar-Plain">* Cisco in writing.                                                      *</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="l l-Scalar l-Scalar-Plain">**************************************************************************</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="l l-Scalar l-Scalar-Plain">**************************************************************************</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="l l-Scalar l-Scalar-Plain">* IOSv is strictly limited to use for evaluation, demonstration and IOS  *</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="l l-Scalar l-Scalar-Plain">* education. IOSv is provided as-is and is not supported by Cisco&#39;s      *</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="l l-Scalar l-Scalar-Plain">* Technical Advisory Center. Any use or disclosure, in whole or in part, *</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="l l-Scalar l-Scalar-Plain">* of the IOSv Software or Documentation to any third party for any       *</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="l l-Scalar l-Scalar-Plain">* purposes is expressly prohibited except as otherwise authorized by     *</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="l l-Scalar l-Scalar-Plain">* Cisco in writing.                                                      *</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="l l-Scalar l-Scalar-Plain">**************************************************************************</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="l l-Scalar l-Scalar-Plain">rtr-1#</span>
</span></code></pre></div></td></tr></table></div>
<p>Taking a look at the configuration in the router, it looks exactly as we would expect. There are
only two users configured. The first being the one that Ansible uses to connect to this device. The
second being the one we just reconfigured.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="l l-Scalar l-Scalar-Plain">rtr-1#show run | i username</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="l l-Scalar l-Scalar-Plain">username cisco secret 5 $1$GNTQ$RpNy.E9LZMzgrOz/g2pYJ.</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="l l-Scalar l-Scalar-Plain">username joshv nopassword</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">username joshv</span>
</span></code></pre></div></td></tr></table></div>
<p>On the output you see that there is the username <code>joshv</code> multiple times. One is in the generic
username section that was created with the command <code>username joshv nopassword</code> and then another time
that is within the public key section of the SSH configuration.  </p>
<h4 id="removing-ssh-key-user"><a class="toclink" href="../../ansible-cisco-ios-user/#removing-ssh-key-user">Removing SSH Key User</a></h4>
<p>To go along with creating an user on the device, I have created the playbook to remove the same user
from the device. This is as simple as changing the state from <code>present</code> to <code>absent</code>. This will
remove all of what was created on the device.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nn">---</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PLAY</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">WORKING</span><span class="nv"> </span><span class="s">WITH</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">USER</span><span class="nv"> </span><span class="s">MODULE&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco_routers</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Remove</span><span class="nv"> </span><span class="s">local</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">SSH</span><span class="nv"> </span><span class="s">Key&quot;</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">      </span><span class="nt">ios_user</span><span class="p">:</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">joshv</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">        </span><span class="nt">nopassword</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">        </span><span class="nt">sshkey</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">lookup(&#39;file&#39;,</span><span class="nv"> </span><span class="s">&#39;~/.ssh/id_rsa.pub&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config_output</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">config_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;FINAL</span><span class="nv"> </span><span class="s">TASK:</span><span class="nv"> </span><span class="s">Save</span><span class="nv"> </span><span class="s">Config&quot;</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">      </span><span class="nt">ios_config</span><span class="p">:</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">        </span><span class="nt">save_when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always</span>
</span></code></pre></div>
<p>Execution looks extremely similar. Here it is:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span>
<span class="normal"><a href="#__codelineno-6-27">27</a></span>
<span class="normal"><a href="#__codelineno-6-28">28</a></span>
<span class="normal"><a href="#__codelineno-6-29">29</a></span>
<span class="normal"><a href="#__codelineno-6-30">30</a></span>
<span class="normal"><a href="#__codelineno-6-31">31</a></span>
<span class="normal"><a href="#__codelineno-6-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WORKING WITH IOS USER MODULE] ****************************************************</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remove local username with SSH Key] **********************************************</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="p p-Indicator">[</span><span class="nv">WARNING</span><span class="p p-Indicator">]:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Module did not set no_log for update_password</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="p p-Indicator">[</span><span class="nv">WARNING</span><span class="p p-Indicator">]:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Module did not set no_log for password_type</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="l l-Scalar l-Scalar-Plain">TASK [debug] ***********************************************************************************</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">        </span><span class="s">&quot;ansible_facts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">            </span><span class="s">&quot;discovered_interpreter_python&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;/usr/bin/python&quot;</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">        </span><span class="p p-Indicator">},</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">            </span><span class="s">&quot;ip</span><span class="nv"> </span><span class="s">ssh</span><span class="nv"> </span><span class="s">pubkey-chain&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">joshv&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">            </span><span class="s">&quot;exit&quot;</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="w">        </span><span class="s">&quot;warnings&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="w">            </span><span class="s">&quot;Module</span><span class="nv"> </span><span class="s">did</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">no_log</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">update_password&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="w">            </span><span class="s">&quot;Module</span><span class="nv"> </span><span class="s">did</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">no_log</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">password_type&quot;</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="w">        </span><span class="p p-Indicator">]</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="err">}</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27"></a>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="l l-Scalar l-Scalar-Plain">TASK [FINAL TASK</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Save Config] *****************************************************************</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30"></a>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *************************************************************************************</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32"></a><span class="nt">r1                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<blockquote>
<p>In writing of this I did find what I would consider a bug within Ansilbe's ios_user. If you use an
SSH Key with the credential, you will need to remove the user account with running the same taskk
2 times. This is filed under issue <a href="https://github.com/ansible/ansible/issues/68238">https://github.com/ansible/ansible/issues/68238</a></p>
</blockquote>
<p><img alt="Playbook2 Execution" src="/images/2020/03/removing_user_with_key.gif" /></p>
<p>Executing the module a second time you get the full removal of the user account.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span>
<span class="normal"><a href="#__codelineno-7-30">30</a></span>
<span class="normal"><a href="#__codelineno-7-31">31</a></span>
<span class="normal"><a href="#__codelineno-7-32">32</a></span>
<span class="normal"><a href="#__codelineno-7-33">33</a></span>
<span class="normal"><a href="#__codelineno-7-34">34</a></span>
<span class="normal"><a href="#__codelineno-7-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WORKING WITH IOS USER MODULE] ****************************************************</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remove local username with SSH Key] **********************************************</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="p p-Indicator">[</span><span class="nv">WARNING</span><span class="p p-Indicator">]:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Module did not set no_log for update_password</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="p p-Indicator">[</span><span class="nv">WARNING</span><span class="p p-Indicator">]:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Module did not set no_log for password_type</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="l l-Scalar l-Scalar-Plain">TASK [debug] ***********************************************************************************</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">        </span><span class="s">&quot;ansible_facts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">            </span><span class="s">&quot;discovered_interpreter_python&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;/usr/bin/python&quot;</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">        </span><span class="p p-Indicator">},</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="w">                </span><span class="s">&quot;answer&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;y&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">                </span><span class="s">&quot;command&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">joshv&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">                </span><span class="s">&quot;newline&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="w">                </span><span class="s">&quot;prompt&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;This</span><span class="nv"> </span><span class="s">operation</span><span class="nv"> </span><span class="s">will</span><span class="nv"> </span><span class="s">remove</span><span class="nv"> </span><span class="s">all</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">related</span><span class="nv"> </span><span class="s">configurations</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">same</span><span class="nv"> </span><span class="s">name&quot;</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="w">            </span><span class="p p-Indicator">}</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="w">        </span><span class="s">&quot;warnings&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="w">            </span><span class="s">&quot;Module</span><span class="nv"> </span><span class="s">did</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">no_log</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">update_password&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26"></a><span class="w">            </span><span class="s">&quot;Module</span><span class="nv"> </span><span class="s">did</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">no_log</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">password_type&quot;</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27"></a><span class="w">        </span><span class="p p-Indicator">]</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29"></a><span class="err">}</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30"></a>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31"></a><span class="l l-Scalar l-Scalar-Plain">TASK [FINAL TASK</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Save Config] *****************************************************************</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33"></a>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *************************************************************************************</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35"></a><span class="nt">r1                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="setting-username-and-password-no-key"><a class="toclink" href="../../ansible-cisco-ios-user/#setting-username-and-password-no-key">Setting Username and Password - No Key</a></h3>
<p>Now that I have gone through the use of creating a SSH Key user, let's take a look at setting an
user account on the device with a credential. I've created a local environmental variable named
<code>NEW_PASSWORD</code> that has the credential that I wish to set the username to. This could be any
lookup that gets a password, such as a lookup to a password manager.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nn">---</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PLAY</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">WORKING</span><span class="nv"> </span><span class="s">WITH</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">USER</span><span class="nv"> </span><span class="s">MODULE&quot;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cisco_routers</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Add</span><span class="nv"> </span><span class="s">local</span><span class="nv"> </span><span class="s">username</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">SSH</span><span class="nv"> </span><span class="s">Key&quot;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">      </span><span class="nt">ios_user</span><span class="p">:</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">josh2</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">        </span><span class="nt">configured_password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">lookup(&#39;env&#39;,</span><span class="nv"> </span><span class="s">&#39;NEW_PASSWORD&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">        </span><span class="nt">privilege</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config_output</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">config_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;FINAL</span><span class="nv"> </span><span class="s">TASK:</span><span class="nv"> </span><span class="s">Save</span><span class="nv"> </span><span class="s">Config&quot;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">      </span><span class="nt">ios_config</span><span class="p">:</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">        </span><span class="nt">save_when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always</span>
</span></code></pre></div>
<p>The output on this particular setup is <strong>not</strong> idempotent. Each time the play will be run it will
set a new username and password on the device due to the checking of the running configuration. You
will need to add some additional logic to your playbook to have the task only executed when a
condition is met.  </p>
<p>Here is the execution. Note that Ansible masks the password being set.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span>
<span class="normal"><a href="#__codelineno-9-18">18</a></span>
<span class="normal"><a href="#__codelineno-9-19">19</a></span>
<span class="normal"><a href="#__codelineno-9-20">20</a></span>
<span class="normal"><a href="#__codelineno-9-21">21</a></span>
<span class="normal"><a href="#__codelineno-9-22">22</a></span>
<span class="normal"><a href="#__codelineno-9-23">23</a></span>
<span class="normal"><a href="#__codelineno-9-24">24</a></span>
<span class="normal"><a href="#__codelineno-9-25">25</a></span>
<span class="normal"><a href="#__codelineno-9-26">26</a></span>
<span class="normal"><a href="#__codelineno-9-27">27</a></span>
<span class="normal"><a href="#__codelineno-9-28">28</a></span>
<span class="normal"><a href="#__codelineno-9-29">29</a></span>
<span class="normal"><a href="#__codelineno-9-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WORKING WITH IOS USER MODULE] ****************************************************</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add local username with SSH Key] *************************************************</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="p p-Indicator">[</span><span class="nv">WARNING</span><span class="p p-Indicator">]:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Module did not set no_log for update_password</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="p p-Indicator">[</span><span class="nv">WARNING</span><span class="p p-Indicator">]:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Module did not set no_log for password_type</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7"></a>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="l l-Scalar l-Scalar-Plain">TASK [debug] ***********************************************************************************</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="w">        </span><span class="s">&quot;ansible_facts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="w">            </span><span class="s">&quot;discovered_interpreter_python&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;/usr/bin/python&quot;</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="w">        </span><span class="p p-Indicator">},</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="w">            </span><span class="s">&quot;username</span><span class="nv"> </span><span class="s">josh2</span><span class="nv"> </span><span class="s">secret</span><span class="nv"> </span><span class="s">********&quot;</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="w">        </span><span class="s">&quot;warnings&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="w">            </span><span class="s">&quot;Module</span><span class="nv"> </span><span class="s">did</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">no_log</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">update_password&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="w">            </span><span class="s">&quot;Module</span><span class="nv"> </span><span class="s">did</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">no_log</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">password_type&quot;</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="w">        </span><span class="p p-Indicator">]</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="err">}</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25"></a>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26"></a><span class="l l-Scalar l-Scalar-Plain">TASK [FINAL TASK</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Save Config] *****************************************************************</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28"></a>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *************************************************************************************</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30"></a><span class="nt">r1                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="Playbook2 Execution" src="/images/2020/03/add_user_with_pass.gif" /></p>
<h3 id="summary"><a class="toclink" href="../../ansible-cisco-ios-user/#summary">Summary</a></h3>
<p>From the examples that I have given, hopefully this will help to see what you <em>could</em> do in your own
environment. Need to regularly rotate an offline access password? A playbook may be a way that is
low impact to get you on your way for automating the management of your Cisco IOS devices.  </p>
<p>I also started with the use of SSH keys as well as this may be an under utilized method to log into
devices. This sets up and uses a known cryptographic key set for authentication. Please check with
the team/individuals responsible for security before implementing.  </p>
<p>As always, I hope this has helped!</p>
<p>I've added the Playbooks executed within this post to my collection of examples on Github at
<a href="https://github.com/jvanderaa/ansible-using_ios">https://github.com/jvanderaa/ansible-using_ios</a>.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2020-01-26 00:00:00">January 26, 2020</time></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-cisco-ios_interfaces-module"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/">Ansible Cisco ios_interfaces module</a></h2>
<p>This has become a post about the <strong>ios_interfaces</strong> module with documentation that can be found
<a href="https://docs.ansible.com/ansible/latest/modules/ios_interfaces_module.html">Ansible ios_interfaces doc</a>.
Originally I was going to write about the deprecations for just the Cisco IOS modules. Then as I
investigated further, I had found that there are many more modules that are being deprecated. In
this post I will take a closer look at the differences between the <code>ios_interface</code> and <code>ios_vlan</code>
modules that I had written posts on last year and what their new counter parts look like. And in the
end the post had quite a bit of good detail about the module. I think you will like what is here.  </p>
<blockquote>
<p>Previous Posts</p>
<ul>
<li><a href="https://josh-v.com/blog/2019/03/17/ansible-cisco-ios-interface.html">ios_interface</a></li>
<li><a href="https://josh-v.com/blog/2019/03/09/ansible-ios-vlan.html">ios_vlan</a></li>
</ul>
</blockquote>
<h3 id="module-deprecations"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#module-deprecations">Module Deprecations</a></h3>
<p>In addition to the Cisco "legacy" interface and vlan modules that are being deprecated, the Ansible
generic modules are being deprecated as well. These include <code>net_interface</code>, <code>net_linkagg</code>,
<code>net_l2/l3_interface</code>, and <code>net_l2/l3_vlan</code>.  </p>
<p>Not to be outdone, not only are the Cisco and Ansible generic modules being deprecated, so are each
of the same set of modules for Juniper, EOS, VYOS, NXOS, IOSXR, and Netvisor.  </p>
<p>In all by doing a browser search for <code>(D)</code> on the Ansible 2.9 Network Modules
<a href="https://docs.ansible.com/ansible/2.9/modules/list_of_network_modules.html">page</a> I come across a
total of 77 different modules that are in the process of being deprecated. That is quite a bit, so
make sure that you are taking a look at your playbooks to look for this.  </p>
<p>One of the downsides I see coming out of this module change is the change from <code>ios_interface</code> to
<code>ios_interfaces</code>. This is such a subtle difference between the two. You are going to need to pay
extra attention to it. In fact I was taken back when I first saw the parameters of the module being
posted on the Network To Code Public Slack that I had to take a second look. I thought that someone
was way off on the parameters they were using. Then I saw the deprecations and new modules.</p>
<h4 id="panos-module-deprecation"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#panos-module-deprecation">PANOS Module Deprecation</a></h4>
<p>I did also observe an interesting (in my mind) planned deprecation. All of the PANOS modules are
planned to be deprecated in favor of using community drivers from Ansible Galaxy. Why is this
interesting? Well, this is the start of the move to move modules out of Ansible Core and start using
Ansible Galaxy to distribute the modules that you need. More on that to come in another post.</p>
<h3 id="differences"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#differences">Differences</a></h3>
<p>There are quite a bit of differences in the modules. The first level parameters for <em>_interfaces
across vendors has been reduced to just two, </em><em>config</em><em> and </em><em>state</em>*.  </p>
<p>A second difference that I'm observing is the lack of the ability to save the config when change.
This means that you as the playbook creator will need to take action such as notifying a handler or
running a save config when there is a change. You can do this, or have a task executed when there is
a change.</p>
<h4 id="config"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#config">Config</a></h4>
<p>All of the bulk of the configuration has moved into the config parameter. Within Cisco
<code>ios_interfaces</code> you now have the options to configure the <em>description</em>, <em>duplex</em>, <em>enabled</em>,
<em>mtu</em>, <em>name</em>*, and <em>speed</em>. These were previously first level parameters within the module
definition. You can find the module definition at
<a href="https://docs.ansible.com/ansible/latest/modules/ios_interfaces_module.html">Ansible Docs ios_interfaces</a>.</p>
<h4 id="state"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#state">State</a></h4>
<p>The state is now referencing the configuration of the interface. It does not state whether or not
the interface is enabled or disabled. That is controlled by the <em>enabled</em> sub-parameter of
<strong>config</strong>. The options for <strong>state</strong> include <em>merged</em> (default setting), <em>replaced</em>, <em>overridden</em>,
and <em>deleted</em>.</p>
<h5 id="state-merged"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#state-merged">State: Merged</a></h5>
<p>This looks to take whatever is already in the interface configuration and adding/replacing based on
what the module parameters that are configured. So if you have an interface that has just the speed
configured and you just have a task that configures the duplex, you will have speed and duplex
configured.  </p>
<p>With the merged module, you will run the commands that are defined, not worrying about the defaults.
For this demo, I have set the MTU to 1450, which is different than the default of 1500 for this
device type. You will see that in other states, that Ansible will change the configuration. Where as
with the <strong>merged</strong> type, you will run the commands seen in the module parameters, not worrying
about the other parameters not provided.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">some</span><span class="nv"> </span><span class="s">interfaces</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">merge&quot;</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">        </span><span class="nt">ios_interfaces</span><span class="p">:</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replaced</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/3</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">        </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios_interface_output</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">SYS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">DEBUG</span><span class="nv"> </span><span class="s">OUTPUT&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">        </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ios_interface_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">GigabitEthernet0/3&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="s">&quot;description</span><span class="nv"> </span><span class="s">Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span></code></pre></div></td></tr></table></div>
<h5 id="state-replaced"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#state-replaced">State: Replaced</a></h5>
<p>When using replaced, the entire interface will be configured with what is set in the module. If you
set duplex only, you will only get the duplex of the interface set.  </p>
<p>In this example I will only be looking to enable the interface and change the description. There
will be no changes to the other interfaces defined.  </p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">some</span><span class="nv"> </span><span class="s">interfaces</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">merge&quot;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">      </span><span class="nt">ios_interfaces</span><span class="p">:</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replaced</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/3</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios_interface_output</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">SYS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">DEBUG</span><span class="nv"> </span><span class="s">OUTPUT&quot;</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ios_interface_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>The output (shown in full here only, will skip the "after" and "before" keys in subsequent examples)
shows that the only changes being made are to <code>GigabitEthernet0/3</code>. This is similar to what we will
see in the overridden section. Overridden will configure every interface on the device vs replaced
looks to only be handling the interface defined within the config parameter.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span>
<span class="normal"><a href="#__codelineno-3-36">36</a></span>
<span class="normal"><a href="#__codelineno-3-37">37</a></span>
<span class="normal"><a href="#__codelineno-3-38">38</a></span>
<span class="normal"><a href="#__codelineno-3-39">39</a></span>
<span class="normal"><a href="#__codelineno-3-40">40</a></span>
<span class="normal"><a href="#__codelineno-3-41">41</a></span>
<span class="normal"><a href="#__codelineno-3-42">42</a></span>
<span class="normal"><a href="#__codelineno-3-43">43</a></span>
<span class="normal"><a href="#__codelineno-3-44">44</a></span>
<span class="normal"><a href="#__codelineno-3-45">45</a></span>
<span class="normal"><a href="#__codelineno-3-46">46</a></span>
<span class="normal"><a href="#__codelineno-3-47">47</a></span>
<span class="normal"><a href="#__codelineno-3-48">48</a></span>
<span class="normal"><a href="#__codelineno-3-49">49</a></span>
<span class="normal"><a href="#__codelineno-3-50">50</a></span>
<span class="normal"><a href="#__codelineno-3-51">51</a></span>
<span class="normal"><a href="#__codelineno-3-52">52</a></span>
<span class="normal"><a href="#__codelineno-3-53">53</a></span>
<span class="normal"><a href="#__codelineno-3-54">54</a></span>
<span class="normal"><a href="#__codelineno-3-55">55</a></span>
<span class="normal"><a href="#__codelineno-3-56">56</a></span>
<span class="normal"><a href="#__codelineno-3-57">57</a></span>
<span class="normal"><a href="#__codelineno-3-58">58</a></span>
<span class="normal"><a href="#__codelineno-3-59">59</a></span>
<span class="normal"><a href="#__codelineno-3-60">60</a></span>
<span class="normal"><a href="#__codelineno-3-61">61</a></span>
<span class="normal"><a href="#__codelineno-3-62">62</a></span>
<span class="normal"><a href="#__codelineno-3-63">63</a></span>
<span class="normal"><a href="#__codelineno-3-64">64</a></span>
<span class="normal"><a href="#__codelineno-3-65">65</a></span>
<span class="normal"><a href="#__codelineno-3-66">66</a></span>
<span class="normal"><a href="#__codelineno-3-67">67</a></span>
<span class="normal"><a href="#__codelineno-3-68">68</a></span>
<span class="normal"><a href="#__codelineno-3-69">69</a></span>
<span class="normal"><a href="#__codelineno-3-70">70</a></span>
<span class="normal"><a href="#__codelineno-3-71">71</a></span>
<span class="normal"><a href="#__codelineno-3-72">72</a></span>
<span class="normal"><a href="#__codelineno-3-73">73</a></span>
<span class="normal"><a href="#__codelineno-3-74">74</a></span>
<span class="normal"><a href="#__codelineno-3-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">        </span><span class="s2">&quot;after&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;loopback0&quot;</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/0&quot;</span>,
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">                </span><span class="s2">&quot;description&quot;</span>:<span class="w"> </span><span class="s2">&quot;MANAGEMENT&quot;</span>,
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/1&quot;</span>,
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">                </span><span class="s2">&quot;description&quot;</span>:<span class="w"> </span><span class="s2">&quot;PRODUCTION&quot;</span>,
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">                </span><span class="s2">&quot;mtu&quot;</span>:<span class="w"> </span><span class="m">1400</span>,
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/2&quot;</span>,
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29"></a><span class="w">                </span><span class="s2">&quot;description&quot;</span>:<span class="w"> </span><span class="s2">&quot;Configured by Ansible&quot;</span>,
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/3&quot;</span>,
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="w">            </span><span class="o">}</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="w">        </span><span class="s2">&quot;before&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;loopback0&quot;</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/0&quot;</span>,
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48"></a><span class="w">                </span><span class="s2">&quot;description&quot;</span>:<span class="w"> </span><span class="s2">&quot;MANAGEMENT&quot;</span>,
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/1&quot;</span>,
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55"></a><span class="w">                </span><span class="s2">&quot;description&quot;</span>:<span class="w"> </span><span class="s2">&quot;PRODUCTION&quot;</span>,
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58"></a><span class="w">                </span><span class="s2">&quot;mtu&quot;</span>:<span class="w"> </span><span class="m">1400</span>,
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/2&quot;</span>,
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63"></a><span class="w">                </span><span class="s2">&quot;description&quot;</span>:<span class="w"> </span><span class="s2">&quot;BEFORE ANSIBLE&quot;</span>,
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64"></a><span class="w">                </span><span class="s2">&quot;duplex&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>,
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65"></a><span class="w">                </span><span class="s2">&quot;enabled&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66"></a><span class="w">                </span><span class="s2">&quot;mtu&quot;</span>:<span class="w"> </span><span class="m">1450</span>,
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67"></a><span class="w">                </span><span class="s2">&quot;name&quot;</span>:<span class="w"> </span><span class="s2">&quot;GigabitEthernet0/3&quot;</span>,
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68"></a><span class="w">                </span><span class="s2">&quot;speed&quot;</span>:<span class="w"> </span><span class="s2">&quot;auto&quot;</span>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69"></a><span class="w">            </span><span class="o">}</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73"></a><span class="w">            </span><span class="s2">&quot;interface GigabitEthernet0/3&quot;</span>,
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74"></a><span class="w">            </span><span class="s2">&quot;no mtu&quot;</span>,
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75"></a><span class="w">            </span><span class="s2">&quot;description Configured by Ansible&quot;</span>
</span></code></pre></div></td></tr></table></div>
<h5 id="state-overridden"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#state-overridden">State: Overridden</a></h5>
<p>This one was not completely obvious to me when originally looking at. But as I tested, I have now
come to find that this state is something to be <strong>VERY</strong> cautious with. In the testing, I had the
following configuration on the devices:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>interface<span class="w"> </span>GigabitEthernet0/1
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w"> </span>description<span class="w"> </span>MANAGEMENT
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w"> </span>OUTPUT<span class="w"> </span>OMITTED
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>!
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a>interface<span class="w"> </span>GigabitEthernet0/2
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w"> </span>description<span class="w"> </span>PRODUCTION
</span></code></pre></div></td></tr></table></div>
<p>You can see that there are configurations applied to the description. I then created these playbook
tasks to test the <code>Overridden</code> setting.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">some</span><span class="nv"> </span><span class="s">interfaces</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">merge&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">      </span><span class="nt">ios_interfaces</span><span class="p">:</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overridden</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/3</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios_interface_output</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">SYS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">DEBUG</span><span class="nv"> </span><span class="s">OUTPUT&quot;</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ios_interface_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>The output shows that Ansible is going to erase the description lines:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">    </span><span class="s2">&quot;interface GigabitEthernet0/1&quot;</span>,
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">    </span><span class="s2">&quot;no description&quot;</span>,
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">    </span><span class="s2">&quot;interface GigabitEthernet0/2&quot;</span>,
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">    </span><span class="s2">&quot;no description&quot;</span>
</span></code></pre></div></td></tr></table></div>
<p>This indicates that Ansible will default settings that are not specifically defined within the
module.</p>
<p>The next test I changed the MTU on <code>GigabitEthernet0/1</code> and <code>GigabitEthernet0/2</code> to some random
14xx MTUs. I've left everything else the same as the play above with no changing fo the MTU, just
setting the description on a single interface. The results from running that playbook now show that
the interface MTU is reset to default since it was not statically defined in the task.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span>
<span class="normal"><a href="#__codelineno-7-4">4</a></span>
<span class="normal"><a href="#__codelineno-7-5">5</a></span>
<span class="normal"><a href="#__codelineno-7-6">6</a></span>
<span class="normal"><a href="#__codelineno-7-7">7</a></span>
<span class="normal"><a href="#__codelineno-7-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="w">    </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">    </span><span class="s2">&quot;interface GigabitEthernet0/1&quot;</span>,
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="s2">&quot;no mtu&quot;</span>,
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">    </span><span class="s2">&quot;interface GigabitEthernet0/2&quot;</span>,
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="s2">&quot;no mtu&quot;</span>,
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">    </span><span class="s2">&quot;interface GigabitEthernet0/3&quot;</span>,
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">    </span><span class="s2">&quot;no mtu&quot;</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="o">]</span>,
</span></code></pre></div></td></tr></table></div>
<h6 id="state-overridden-loop"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#state-overridden-loop">State: Overridden - Loop</a></h6>
<p>So what does this look like if we wanted to loop over a set of interfaces? Would there be special
considerations made for the module? The answer is no. If you attempted to loop over a module that is
using the state of <strong>overridden</strong>, then you are going to default the other interfaces. Given the
following task:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">some</span><span class="nv"> </span><span class="s">interfaces</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">merge&quot;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">      </span><span class="nt">ios_interfaces</span><span class="p">:</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overridden</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios_interface_output</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">      </span><span class="nt">loop</span><span class="p">:</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/2&quot;</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/3&quot;</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">      </span><span class="nt">loop_control</span><span class="p">:</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">        </span><span class="nt">loop_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">item</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">SYS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">DEBUG</span><span class="nv"> </span><span class="s">OUTPUT&quot;</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ios_interface_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>You will have two loops. The first time through the loop when the loop_var is <code>GigabitEthernet0/2</code>
you will have the other interfaces all defaulted, except <code>GigabitEthernet0/2</code> will have the state
enabled and the description set to <code>Configured by Ansible</code>. The rest of the interface descriptions
will be removed. MTU all set to default, and so on.  </p>
<p>The second time through the loop the module will configure <code>GigabitEthernet0/3</code> with each of the
interface configurations. Defaulting the rest of the interfaces on teh device. So the description
at the end of this execution for <code>GigabitEthernet0/2</code> will be blank. Even though it was configured
on the first loop through.</p>
<p>To handle this you will need to define the interfaces within the context of the config. Here is the
new configuration of the tasks:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">some</span><span class="nv"> </span><span class="s">interfaces</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">merge&quot;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">      </span><span class="nt">ios_interfaces</span><span class="p">:</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overridden</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/2&quot;</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/3&quot;</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">            </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios_interface_output</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">SYS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">DEBUG</span><span class="nv"> </span><span class="s">OUTPUT&quot;</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ios_interface_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>With having multiple interfaces defined under the config as another list item you are able to get
both of the interfaces configured with what you are looking to do.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span>
<span class="normal"><a href="#__codelineno-10-26">26</a></span>
<span class="normal"><a href="#__codelineno-10-27">27</a></span>
<span class="normal"><a href="#__codelineno-10-28">28</a></span>
<span class="normal"><a href="#__codelineno-10-29">29</a></span>
<span class="normal"><a href="#__codelineno-10-30">30</a></span>
<span class="normal"><a href="#__codelineno-10-31">31</a></span>
<span class="normal"><a href="#__codelineno-10-32">32</a></span>
<span class="normal"><a href="#__codelineno-10-33">33</a></span>
<span class="normal"><a href="#__codelineno-10-34">34</a></span>
<span class="normal"><a href="#__codelineno-10-35">35</a></span>
<span class="normal"><a href="#__codelineno-10-36">36</a></span>
<span class="normal"><a href="#__codelineno-10-37">37</a></span>
<span class="normal"><a href="#__codelineno-10-38">38</a></span>
<span class="normal"><a href="#__codelineno-10-39">39</a></span>
<span class="normal"><a href="#__codelineno-10-40">40</a></span>
<span class="normal"><a href="#__codelineno-10-41">41</a></span>
<span class="normal"><a href="#__codelineno-10-42">42</a></span>
<span class="normal"><a href="#__codelineno-10-43">43</a></span>
<span class="normal"><a href="#__codelineno-10-44">44</a></span>
<span class="normal"><a href="#__codelineno-10-45">45</a></span>
<span class="normal"><a href="#__codelineno-10-46">46</a></span>
<span class="normal"><a href="#__codelineno-10-47">47</a></span>
<span class="normal"><a href="#__codelineno-10-48">48</a></span>
<span class="normal"><a href="#__codelineno-10-49">49</a></span>
<span class="normal"><a href="#__codelineno-10-50">50</a></span>
<span class="normal"><a href="#__codelineno-10-51">51</a></span>
<span class="normal"><a href="#__codelineno-10-52">52</a></span>
<span class="normal"><a href="#__codelineno-10-53">53</a></span>
<span class="normal"><a href="#__codelineno-10-54">54</a></span>
<span class="normal"><a href="#__codelineno-10-55">55</a></span>
<span class="normal"><a href="#__codelineno-10-56">56</a></span>
<span class="normal"><a href="#__codelineno-10-57">57</a></span>
<span class="normal"><a href="#__codelineno-10-58">58</a></span>
<span class="normal"><a href="#__codelineno-10-59">59</a></span>
<span class="normal"><a href="#__codelineno-10-60">60</a></span>
<span class="normal"><a href="#__codelineno-10-61">61</a></span>
<span class="normal"><a href="#__codelineno-10-62">62</a></span>
<span class="normal"><a href="#__codelineno-10-63">63</a></span>
<span class="normal"><a href="#__codelineno-10-64">64</a></span>
<span class="normal"><a href="#__codelineno-10-65">65</a></span>
<span class="normal"><a href="#__codelineno-10-66">66</a></span>
<span class="normal"><a href="#__codelineno-10-67">67</a></span>
<span class="normal"><a href="#__codelineno-10-68">68</a></span>
<span class="normal"><a href="#__codelineno-10-69">69</a></span>
<span class="normal"><a href="#__codelineno-10-70">70</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="w">        </span><span class="s">&quot;after&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;loopback0&quot;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/0&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/1&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19"></a><span class="w">                </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/2&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26"></a><span class="w">                </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/3&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31"></a><span class="w">            </span><span class="p p-Indicator">}</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32"></a><span class="w">        </span><span class="p p-Indicator">]</span><span class="err">,</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33"></a><span class="w">        </span><span class="s">&quot;before&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;loopback0&quot;</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/0&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/1&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51"></a><span class="w">                </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;BEFORE</span><span class="nv"> </span><span class="s">ANSIBLE&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/2&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58"></a><span class="w">                </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;BEFORE</span><span class="nv"> </span><span class="s">ANSIBLE&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59"></a><span class="w">                </span><span class="s">&quot;duplex&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60"></a><span class="w">                </span><span class="s">&quot;enabled&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61"></a><span class="w">                </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;GigabitEthernet0/3&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62"></a><span class="w">                </span><span class="s">&quot;speed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;auto&quot;</span>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63"></a><span class="w">            </span><span class="p p-Indicator">}</span>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64"></a><span class="w">        </span><span class="p p-Indicator">]</span><span class="err">,</span>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true,</span>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67"></a><span class="w">            </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">GigabitEthernet0/2&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68"></a><span class="w">            </span><span class="s">&quot;description</span><span class="nv"> </span><span class="s">Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69"></a><span class="w">            </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">GigabitEthernet0/3&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70"></a><span class="w">            </span><span class="s">&quot;description</span><span class="nv"> </span><span class="s">Configured</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible&quot;</span>
</span></code></pre></div></td></tr></table></div>
<p>You now see within the <em>commands</em> key that both of hte interfaces are configured by Ansible. At this
point with both interfaces being defined in the config parameter, you get both of the interfaces
configured. To do this more programmatically  you would need to create the list ahead of time and
feed the list of interfaces with their state into the module. This may be a future blog post.</p>
<h5 id="state-deleted"><a class="toclink" href="../../ansible-cisco-ios-interfaces-module/#state-deleted">State: Deleted</a></h5>
<p>The task looks straight to the point for the deleted status. As expected. In this you define which
interface name is to have the configuration removed, and then the module will default all of the
sub-parameters of <em>description</em>, <em>duplex</em>, <em>enabled</em>, <em>mtu</em>, and <em>speed</em>. Note that the <em>enabled</em>
default in the module is currently (2020-01-26) set to enabled.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">IOS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">some</span><span class="nv"> </span><span class="s">interfaces</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">merge&quot;</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">      </span><span class="nt">ios_interfaces</span><span class="p">:</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deleted</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/3</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">        </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ios_interface_output</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">SYS</span><span class="nv"> </span><span class="s">&gt;&gt;</span><span class="nv"> </span><span class="s">DEBUG</span><span class="nv"> </span><span class="s">OUTPUT&quot;</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ios_interface_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>When the configuration previously had an interface description and an MTU set, the following is
the commands that are executed on just the single interface that is defined in the task:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">    </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">GigabitEthernet0/3&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">    </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">description&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">    </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">mtu&quot;</span>
</span></code></pre></div></td></tr></table></div>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-11-14 00:00:00">November 14, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="disney-plus-streaming-bandwidth"><a class="toclink" href="../../disney_plus_streaming/">Disney Plus Streaming Bandwidth</a></h2>
<p>This will be a brief departure from the automation focused attention that I have been giving to this
blog over the past year or so. This week in the United States was the launch of Disney+ streaming
service. I have subscribed to it at this point and have found some interesting data based on SNMP
polling my network.  </p>
<p>This post is about the bandwidth that I am seeing used, not about anything about the service, or if
another service is better. I don't have the time for that at this time. This is just about what was
an unexpected jump in the bandwidth usage with the new application. But I am very much OK with that
as my subscription level is taking care of that.</p>
<h3 id="streaming-setup"><a class="toclink" href="../../disney_plus_streaming/#streaming-setup">Streaming Setup</a></h3>
<p>So what this is going to show is numbers with just a single device. So this isn't a full across the
board deep test. But it is something to get some numbers out there. My household streaming consists
of primarily an Apple TV Full HD (not the 4k one) or an iPad mini streaming.  </p>
<p>My broadband provider is a cable service provider that speed tests have shown consistent speeds at
around 200 Mbps down, 11 Mbps up.</p>
<h3 id="streaming-bandwidth-number-historically"><a class="toclink" href="../../disney_plus_streaming/#streaming-bandwidth-number-historically">Streaming Bandwidth Number - Historically</a></h3>
<p>Historically I've always maintained that based on a Netflix stream, or use of PlayStation Vue that
an HD stream would use somewhere between 3-5 Mbps of bandwidth on a broadband network. I'll show
where that still remains true on the bandwidth graph. That has held true so far.</p>
<h4 id="disney-streaming"><a class="toclink" href="../../disney_plus_streaming/#disney-streaming">Disney+ Streaming</a></h4>
<p>So what have I seen at this point from just 2 days of use of Disney+? It uses much more bandwidth
than I originally expected, in fact, it has been over double that of Netflix streams. So much more
so that the 95th percentile on the home network with just a single stream running has consistently
run up to 11 Mbps for my download.</p>
<h4 id="quality"><a class="toclink" href="../../disney_plus_streaming/#quality">Quality?</a></h4>
<p>From the picture that I have seen, it does look very crisp and clear. Makes sense that there are
more bits coming across the wire. I would say that at least in my experience there is a correlation
of quality to the amount of bits coming across.  </p>
<p>The Netflix subscription is the basic HD level. I have not done that study of what that actually
means if that is 720p or 1080p that is coming across. I also do not know what compression there is
within the applications.  </p>
<h3 id="graph-to-show"><a class="toclink" href="../../disney_plus_streaming/#graph-to-show">Graph To Show</a></h3>
<p>Here is the bandwidth graphs. I will try to pretty up the graphics a little more in a future post.</p>
<p><img alt="Graph from LibreNMS" src="/images/2019/12/disney_plus_bandwidth.png" />  </p>
<p>The two spikes up to the red line (95th percentile) on the top side of 0 Mbps are the two times that
Disney+ was in use. Definitely some good amount of usage there. If you see the other couple of early
morning spikes, that is Netflix to an iPad in use. There are some other general streams of data that
happen throughout the day as the family jumps in and out of some other streaming services. But
nothing close to the Disney+ numbers.  </p>
<h3 id="summary"><a class="toclink" href="../../disney_plus_streaming/#summary">Summary</a></h3>
<p>There has been some negative press around the large launch, although I have not had the experiences.
Thus far things have been good, we see that there is more bandwidth utilized from Disney+ launch. At
this point a kudos to Disney's CDN providers as well that have been able to push out this kind of
data rates. I assume that others are likely having the same bandwidth utilization with the
service.  </p>
<p>I hope this helps!</p>
<blockquote>
<p>I have it on my radar to move to a more modern network graphing setup as well, I'm just not to
that point in the home environment yet.</p>
</blockquote>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-10-20 00:00:00">October 20, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              9 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-differences-between-ios-command-and-cli-command"><a class="toclink" href="../../ansible-cli-vs-ios-command/">Ansible differences between ios command and cli command</a></h2>
<p>In an earlier <a href="https://josh-v.com/blog/2019/01/12/ansible-cli-vs-ios-high-level.html">post</a> I
covered the differences between <code>ios_config</code> and  <code>cli_config</code>. However I did not cover what the
difference was between <code>ios_command</code> and <code>cli_command</code>. Most of the items covered there remain the
same. So this will be a post that mostly gets straight to it and sees what the difference is.  </p>
<blockquote>
<p>A reminder that I am also putting playbooks used here out on Github. You can find this at:
<a href="https://github.com/jvanderaa/ansible-using_ios">https://github.com/jvanderaa/ansible-using_ios</a></p>
</blockquote>
<h3 id="differences"><a class="toclink" href="../../ansible-cli-vs-ios-command/#differences">Differences</a></h3>
<p>First, for the <code>cli_commands</code> module, you must be using a connection method of <code>network_cli</code>. You
should not use <code>connection: local</code> for this module. Note that the <code>cli_command</code> can also be used
with multiple device types, including multiple vendors. Take a look at the <code>cli_command</code>
documentation page that there is a link at the bottom of the post.</p>
<h4 id="parameters"><a class="toclink" href="../../ansible-cli-vs-ios-command/#parameters">Parameters</a></h4>
<p>As in the config modules, the first difference is how you pass what you wish to have executed. With
<code>cli_command</code> you are sending a single string, just one command. This is under the <strong>command</strong>
parameter. With <code>ios_command</code> you get to send a <strong>list of commands</strong> send with the <strong>commands</strong>
parameter. This <em>can</em> be handy in some times to execute a whole bunch of commands in one task to a
device.</p>
<h4 id="output"><a class="toclink" href="../../ansible-cli-vs-ios-command/#output">Output</a></h4>
<p>The second major difference according to the documentation between <code>cli_command</code> and <code>ios_command</code>
is the return format. Assuming a single command on the <code>ios_command</code> side of things is sent, here
are the returns from the module:</p>
<h5 id="ios_command-returns"><a class="toclink" href="../../ansible-cli-vs-ios-command/#ios_command-returns">ios_command returns</a></h5>
<ul>
<li>failed_conditions</li>
<li>stdout</li>
<li>stdout_lines</li>
</ul>
<h5 id="cli_command-returns"><a class="toclink" href="../../ansible-cli-vs-ios-command/#cli_command-returns">cli_command returns</a></h5>
<ul>
<li>json</li>
<li>stdout</li>
</ul>
<h5 id="analysis-of-returns"><a class="toclink" href="../../ansible-cli-vs-ios-command/#analysis-of-returns">Analysis of returns</a></h5>
<p>The first thing about the <strong>stdout_lines</strong> output is that it makes it very human readable what the
output of the command is. If you are working on something programmatically speaking, you will likely
only want to use <strong>stdout</strong>.  </p>
<p>Next we see that cli_command has a json return, which is going to provide more structured feedback
from the command.  </p>
<p>Both have in common the <strong>stdout</strong> return, however, the data type is <strong>very</strong> different. Since
<code>cli_command</code> sent only a single string, the return is a single string. On <code>ios_command</code> this is a
list of responses. Even if you sent a single command, it comes back as a list that is only one item.
So you will need to access <code>variable_name.stdout.0</code> (or <code>variable_name.stdout[0]</code>) to get at the
command output.  </p>
<p>Let's get to taking a look at the output.</p>
<h3 id="demo-of-commands"><a class="toclink" href="../../ansible-cli-vs-ios-command/#demo-of-commands">Demo of commands</a></h3>
<p>Let's take a look at how the responses look with just a single command first. I have a preference of
taking a look at NTP associations lately.</p>
<h4 id="ios_command-single-command"><a class="toclink" href="../../ansible-cli-vs-ios-command/#ios_command-single-command">ios_command - single command</a></h4>
<p>Here is what the task portion of the playbook looks like with a single command.  </p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span>
<span class="normal"><a href="#__codelineno-8-29">29</a></span>
<span class="normal"><a href="#__codelineno-8-30">30</a></span>
<span class="normal"><a href="#__codelineno-8-31">31</a></span>
<span class="normal"><a href="#__codelineno-8-32">32</a></span>
<span class="normal"><a href="#__codelineno-8-33">33</a></span>
<span class="normal"><a href="#__codelineno-8-34">34</a></span>
<span class="normal"><a href="#__codelineno-8-35">35</a></span>
<span class="normal"><a href="#__codelineno-8-36">36</a></span>
<span class="normal"><a href="#__codelineno-8-37">37</a></span>
<span class="normal"><a href="#__codelineno-8-38">38</a></span>
<span class="normal"><a href="#__codelineno-8-39">39</a></span>
<span class="normal"><a href="#__codelineno-8-40">40</a></span>
<span class="normal"><a href="#__codelineno-8-41">41</a></span>
<span class="normal"><a href="#__codelineno-8-42">42</a></span>
<span class="normal"><a href="#__codelineno-8-43">43</a></span>
<span class="normal"><a href="#__codelineno-8-44">44</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Get</span><span class="nv"> </span><span class="s">NTP</span><span class="nv"> </span><span class="s">Associations&quot;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">    </span><span class="nt">ios_command</span><span class="p">:</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="w">      </span><span class="nt">commands</span><span class="p">:</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">show ntp associations</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">    </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Debug</span><span class="nv"> </span><span class="s">output&quot;</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">    </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">      </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="err">```}</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="nt">The output from this is as follows assuming an NTP association to the cloudflare NTP servers</span><span class="p">:</span><span class="w">  </span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="err">```</span><span class="l l-Scalar l-Scalar-Plain">yaml linenums=&quot;1&quot;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18"></a>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19"></a>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Using ios_command for a single command] **********************************************</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21"></a>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get NTP Associations] ****************************************************************</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24"></a>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Debug output] ************************************************************************</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30"></a><span class="w">        </span><span class="s">&quot;stdout&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31"></a><span class="w">            </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp\n*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">     </span><span class="s">14</span><span class="nv">     </span><span class="s">64</span><span class="nv">     </span><span class="s">7</span><span class="nv"> </span><span class="s">21.111</span><span class="nv">  </span><span class="s">72.531</span><span class="nv">  </span><span class="s">0.746\n</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33"></a><span class="w">        </span><span class="s">&quot;stdout_lines&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34"></a><span class="w">            </span><span class="p p-Indicator">[</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35"></a><span class="w">                </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36"></a><span class="w">                </span><span class="s">&quot;*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">     </span><span class="s">14</span><span class="nv">     </span><span class="s">64</span><span class="nv">     </span><span class="s">7</span><span class="nv"> </span><span class="s">21.111</span><span class="nv">  </span><span class="s">72.531</span><span class="nv">  </span><span class="s">0.746&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37"></a><span class="w">                </span><span class="s">&quot;</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38"></a><span class="w">            </span><span class="p p-Indicator">]</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39"></a><span class="w">        </span><span class="p p-Indicator">]</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41"></a><span class="err">}</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42"></a>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP ************************************************************************************************************</span>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44"></a><span class="nt">r1                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="IOS Command Single" src="/images/2019/10/blog-ios_single.gif" /></p>
<p>There are four items returned, with the first two primarily being "standard" Ansible returns for
<code>changed</code> and <code>failed</code>. There is then:</p>
<ul>
<li><code>stdout</code>: <strong>List</strong> of outputs, so when there are multiple commands.</li>
<li><code>stdout_lines</code>: <strong>List</strong> of <strong>lists</strong>, the inner list is the commands printed line by line, which
makes it more human readable. The outer list is like that of stdout, that is for each command run,
including if there is only a single command. <strong>Look at the end of line 11, and line 13</strong>. This shows
that there is in fact a list [] of responses to parse through.  </li>
</ul>
<h4 id="cli_command-single-command"><a class="toclink" href="../../ansible-cli-vs-ios-command/#cli_command-single-command">cli_command - single command</a></h4>
<p>The tasks on the <code>cli_command</code> looks pretty similar. However there a few differences. First the
value of <code>command:</code> is a string, this you will see by not having a <code>-</code> in the line. I'm also going
to use quotes around to demonstrate this.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Get</span><span class="nv"> </span><span class="s">NTP</span><span class="nv"> </span><span class="s">Associations&quot;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="nt">cli_command</span><span class="p">:</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;show</span><span class="nv"> </span><span class="s">ntp</span><span class="nv"> </span><span class="s">associations&quot;</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Debug</span><span class="nv"> </span><span class="s">output&quot;</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">    </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">      </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>The command output looks awfully similar now in recent versions of Ansible.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Using cli_command for a single command] ****************************************************************************</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get NTP Associations] **********************************************************************************************</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Debug output] ******************************************************************************************************</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">        </span><span class="s">&quot;stdout&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp\n*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">     </span><span class="s">50</span><span class="nv">     </span><span class="s">64</span><span class="nv">   </span><span class="s">377</span><span class="nv"> </span><span class="s">16.772</span><span class="nv">  </span><span class="s">28.507</span><span class="nv">  </span><span class="s">5.117\n</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">        </span><span class="s">&quot;stdout_lines&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">            </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">            </span><span class="s">&quot;*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">     </span><span class="s">50</span><span class="nv">     </span><span class="s">64</span><span class="nv">   </span><span class="s">377</span><span class="nv"> </span><span class="s">16.772</span><span class="nv">  </span><span class="s">28.507</span><span class="nv">  </span><span class="s">5.117&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">            </span><span class="s">&quot;</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="w">        </span><span class="p p-Indicator">]</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="err">}</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19"></a>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP ***********************************************************************************************************************</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="nt">r1                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="CLI Command Single" src="/images/2019/10/blog-cli_single.gif" /></p>
<p>The big difference here is that the <strong>stdout</strong> part of the response is of type string, and not of a
type list like <code>ios_command</code>. Take a look at line number 11 where <strong>stdout</strong> is. Immediately
following the colon is a double quote, indicating that this is a string. So if you are doing work on
this variable, you will need to take string actions.</p>
<h4 id="ios_comamnd-multiple-commands"><a class="toclink" href="../../ansible-cli-vs-ios-command/#ios_comamnd-multiple-commands">ios_comamnd - multiple commands</a></h4>
<p>The "bonus" of the ios_command module is that you can run multiple commands within a single task. As
I type that out, it seems against the idea of individual task execution, to do 2 or more things in a
single task. But that is what the module allows us in this instance. Let's take a look at this
playbook to verify NTP information and then get the time from the device.</p>
<blockquote>
<p>This could be a part of the <code>ios_command</code> history as well. When <code>ios_command</code> was written each
individual task would start a new connection to IOS devices. So to preserve the number of logins
required it would be good to be able to execute multiple lines.</p>
</blockquote>
<p>There is now a single task, but there are two commands in the commands section. These will be run
and saved to a variable named <code>command_output</code>.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Get</span><span class="nv"> </span><span class="s">NTP</span><span class="nv"> </span><span class="s">Associations&quot;</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="nt">ios_command</span><span class="p">:</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="nt">commands</span><span class="p">:</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">show ntp associations</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">show clock</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">  </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Debug</span><span class="nv"> </span><span class="s">output&quot;</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">  </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>Let's take a look at how this looks now:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span>
<span class="normal"><a href="#__codelineno-12-23">23</a></span>
<span class="normal"><a href="#__codelineno-12-24">24</a></span>
<span class="normal"><a href="#__codelineno-12-25">25</a></span>
<span class="normal"><a href="#__codelineno-12-26">26</a></span>
<span class="normal"><a href="#__codelineno-12-27">27</a></span>
<span class="normal"><a href="#__codelineno-12-28">28</a></span>
<span class="normal"><a href="#__codelineno-12-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Using ios_command for a single command] ****************************************************************************</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get NTP Associations] **********************************************************************************************</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Debug output] ******************************************************************************************************</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">        </span><span class="s">&quot;stdout&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="w">            </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp\n*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">    </span><span class="s">262</span><span class="nv">    </span><span class="s">512</span><span class="nv">   </span><span class="s">377</span><span class="nv"> </span><span class="s">16.551</span><span class="nv">  </span><span class="s">65.112</span><span class="nv">  </span><span class="s">0.097\n</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">            </span><span class="s">&quot;21:57:28.776</span><span class="nv"> </span><span class="s">UTC</span><span class="nv"> </span><span class="s">Sun</span><span class="nv"> </span><span class="s">Oct</span><span class="nv"> </span><span class="s">20</span><span class="nv"> </span><span class="s">2019&quot;</span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">        </span><span class="s">&quot;stdout_lines&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">            </span><span class="p p-Indicator">[</span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="w">                </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">                </span><span class="s">&quot;*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">    </span><span class="s">262</span><span class="nv">    </span><span class="s">512</span><span class="nv">   </span><span class="s">377</span><span class="nv"> </span><span class="s">16.551</span><span class="nv">  </span><span class="s">65.112</span><span class="nv">  </span><span class="s">0.097&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">                </span><span class="s">&quot;</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="w">            </span><span class="p p-Indicator">],</span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="w">            </span><span class="p p-Indicator">[</span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="w">                </span><span class="s">&quot;21:57:28.776</span><span class="nv"> </span><span class="s">UTC</span><span class="nv"> </span><span class="s">Sun</span><span class="nv"> </span><span class="s">Oct</span><span class="nv"> </span><span class="s">20</span><span class="nv"> </span><span class="s">2019&quot;</span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="w">            </span><span class="p p-Indicator">]</span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24"></a><span class="w">        </span><span class="p p-Indicator">]</span>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="err">}</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27"></a>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP ***********************************************************************************************************************</span>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29"></a><span class="nt">r1                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="IOS Command Multiple" src="/images/2019/10/blog-ios_multiple.gif" /></p>
<p>This is where you start to see that there are multiple list items in the response. Taking a look at
line number 11 we still have the <code>[</code> of the list showing at the end, then line 12 ends in a comma,
indicating the next list item. Line 13 ends the list. This repeats on the stdout_lines as well.  </p>
<p>If you wanted to get at just the time of the device in this instance, this is how you would do a
debug task for it:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Debug</span><span class="nv"> </span><span class="s">time&quot;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output.stdout[1]</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>You see that you need to call the variable name, then the return value that you are looking for - 
stdout. Then you need the list position on the response that corresponds to where it was called on
the <code>ios_command</code> module.  </p>
<h4 id="cli_command-multiple-commands"><a class="toclink" href="../../ansible-cli-vs-ios-command/#cli_command-multiple-commands">cli_command - multiple commands</a></h4>
<p>To do the same multiple commands on the <code>cli_command</code> front, you will want to use a loop. Here I
prefer to use the <code>with_items</code> loop. You will see several more key/value pairs on the variable when
using a loop, so let's take a look below:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Get</span><span class="nv"> </span><span class="s">NTP</span><span class="nv"> </span><span class="s">Associations&quot;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">  </span><span class="nt">cli_command</span><span class="p">:</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">  </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">  </span><span class="nt">with_items</span><span class="p">:</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;show</span><span class="nv"> </span><span class="s">ntp</span><span class="nv"> </span><span class="s">associations&quot;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;show</span><span class="nv"> </span><span class="s">clock&quot;</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Debug</span><span class="nv"> </span><span class="s">command</span><span class="nv"> </span><span class="s">output&quot;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">  </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>The output:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span>
<span class="normal"><a href="#__codelineno-15-21">21</a></span>
<span class="normal"><a href="#__codelineno-15-22">22</a></span>
<span class="normal"><a href="#__codelineno-15-23">23</a></span>
<span class="normal"><a href="#__codelineno-15-24">24</a></span>
<span class="normal"><a href="#__codelineno-15-25">25</a></span>
<span class="normal"><a href="#__codelineno-15-26">26</a></span>
<span class="normal"><a href="#__codelineno-15-27">27</a></span>
<span class="normal"><a href="#__codelineno-15-28">28</a></span>
<span class="normal"><a href="#__codelineno-15-29">29</a></span>
<span class="normal"><a href="#__codelineno-15-30">30</a></span>
<span class="normal"><a href="#__codelineno-15-31">31</a></span>
<span class="normal"><a href="#__codelineno-15-32">32</a></span>
<span class="normal"><a href="#__codelineno-15-33">33</a></span>
<span class="normal"><a href="#__codelineno-15-34">34</a></span>
<span class="normal"><a href="#__codelineno-15-35">35</a></span>
<span class="normal"><a href="#__codelineno-15-36">36</a></span>
<span class="normal"><a href="#__codelineno-15-37">37</a></span>
<span class="normal"><a href="#__codelineno-15-38">38</a></span>
<span class="normal"><a href="#__codelineno-15-39">39</a></span>
<span class="normal"><a href="#__codelineno-15-40">40</a></span>
<span class="normal"><a href="#__codelineno-15-41">41</a></span>
<span class="normal"><a href="#__codelineno-15-42">42</a></span>
<span class="normal"><a href="#__codelineno-15-43">43</a></span>
<span class="normal"><a href="#__codelineno-15-44">44</a></span>
<span class="normal"><a href="#__codelineno-15-45">45</a></span>
<span class="normal"><a href="#__codelineno-15-46">46</a></span>
<span class="normal"><a href="#__codelineno-15-47">47</a></span>
<span class="normal"><a href="#__codelineno-15-48">48</a></span>
<span class="normal"><a href="#__codelineno-15-49">49</a></span>
<span class="normal"><a href="#__codelineno-15-50">50</a></span>
<span class="normal"><a href="#__codelineno-15-51">51</a></span>
<span class="normal"><a href="#__codelineno-15-52">52</a></span>
<span class="normal"><a href="#__codelineno-15-53">53</a></span>
<span class="normal"><a href="#__codelineno-15-54">54</a></span>
<span class="normal"><a href="#__codelineno-15-55">55</a></span>
<span class="normal"><a href="#__codelineno-15-56">56</a></span>
<span class="normal"><a href="#__codelineno-15-57">57</a></span>
<span class="normal"><a href="#__codelineno-15-58">58</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Using cli_command for a single command] ****************************************************************************</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get NTP Associations] **********************************************************************************************</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; (item=show ntp associations)</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; (item=show clock)</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Debug command output] **********************************************************************************************</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">        </span><span class="s">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;All</span><span class="nv"> </span><span class="s">items</span><span class="nv"> </span><span class="s">completed&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="w">        </span><span class="s">&quot;results&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="w">                </span><span class="s">&quot;ansible_loop_var&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;item&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="w">                </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16"></a><span class="w">                </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="w">                </span><span class="s">&quot;invocation&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="w">                    </span><span class="s">&quot;module_args&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="w">                        </span><span class="s">&quot;answer&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">null</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="w">                        </span><span class="s">&quot;check_all&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="w">                        </span><span class="s">&quot;command&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;show</span><span class="nv"> </span><span class="s">ntp</span><span class="nv"> </span><span class="s">associations&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22"></a><span class="w">                        </span><span class="s">&quot;prompt&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">null</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23"></a><span class="w">                        </span><span class="s">&quot;sendonly&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24"></a><span class="w">                    </span><span class="p p-Indicator">}</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25"></a><span class="w">                </span><span class="p p-Indicator">},</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26"></a><span class="w">                </span><span class="s">&quot;item&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;show</span><span class="nv"> </span><span class="s">ntp</span><span class="nv"> </span><span class="s">associations&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27"></a><span class="w">                </span><span class="s">&quot;stdout&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp\n*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">     </span><span class="s">64</span><span class="nv">    </span><span class="s">128</span><span class="nv">   </span><span class="s">377</span><span class="nv"> </span><span class="s">16.354</span><span class="nv"> </span><span class="s">-25.131</span><span class="nv">  </span><span class="s">2.283\n</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28"></a><span class="w">                </span><span class="s">&quot;stdout_lines&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29"></a><span class="w">                    </span><span class="s">&quot;address</span><span class="nv">         </span><span class="s">ref</span><span class="nv"> </span><span class="s">clock</span><span class="nv">       </span><span class="s">st</span><span class="nv">   </span><span class="s">when</span><span class="nv">   </span><span class="s">poll</span><span class="nv"> </span><span class="s">reach</span><span class="nv">  </span><span class="s">delay</span><span class="nv">  </span><span class="s">offset</span><span class="nv">   </span><span class="s">disp&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30"></a><span class="w">                    </span><span class="s">&quot;*~162.159.200.123</span><span class="nv"> </span><span class="s">10.72.8.95</span><span class="nv">       </span><span class="s">3</span><span class="nv">     </span><span class="s">64</span><span class="nv">    </span><span class="s">128</span><span class="nv">   </span><span class="s">377</span><span class="nv"> </span><span class="s">16.354</span><span class="nv"> </span><span class="s">-25.131</span><span class="nv">  </span><span class="s">2.283&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31"></a><span class="w">                    </span><span class="s">&quot;</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">sys.peer,</span><span class="nv"> </span><span class="s">#</span><span class="nv"> </span><span class="s">selected,</span><span class="nv"> </span><span class="s">+</span><span class="nv"> </span><span class="s">candidate,</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">outlyer,</span><span class="nv"> </span><span class="s">x</span><span class="nv"> </span><span class="s">falseticker,</span><span class="nv"> </span><span class="s">~</span><span class="nv"> </span><span class="s">configured&quot;</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32"></a><span class="w">                </span><span class="p p-Indicator">]</span>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33"></a><span class="w">            </span><span class="p p-Indicator">},</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34"></a><span class="w">            </span><span class="p p-Indicator">{</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35"></a><span class="w">                </span><span class="s">&quot;ansible_loop_var&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;item&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36"></a><span class="w">                </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37"></a><span class="w">                </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38"></a><span class="w">                </span><span class="s">&quot;invocation&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39"></a><span class="w">                    </span><span class="s">&quot;module_args&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40"></a><span class="w">                        </span><span class="s">&quot;answer&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">null</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41"></a><span class="w">                        </span><span class="s">&quot;check_all&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42"></a><span class="w">                        </span><span class="s">&quot;command&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;show</span><span class="nv"> </span><span class="s">clock&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43"></a><span class="w">                        </span><span class="s">&quot;prompt&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">null</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-44"><a id="__codelineno-15-44" name="__codelineno-15-44"></a><span class="w">                        </span><span class="s">&quot;sendonly&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-15-45"><a id="__codelineno-15-45" name="__codelineno-15-45"></a><span class="w">                    </span><span class="p p-Indicator">}</span>
</span><span id="__span-15-46"><a id="__codelineno-15-46" name="__codelineno-15-46"></a><span class="w">                </span><span class="p p-Indicator">},</span>
</span><span id="__span-15-47"><a id="__codelineno-15-47" name="__codelineno-15-47"></a><span class="w">                </span><span class="s">&quot;item&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;show</span><span class="nv"> </span><span class="s">clock&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-48"><a id="__codelineno-15-48" name="__codelineno-15-48"></a><span class="w">                </span><span class="s">&quot;stdout&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;02:19:22.598</span><span class="nv"> </span><span class="s">UTC</span><span class="nv"> </span><span class="s">Mon</span><span class="nv"> </span><span class="s">Oct</span><span class="nv"> </span><span class="s">21</span><span class="nv"> </span><span class="s">2019&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-15-49"><a id="__codelineno-15-49" name="__codelineno-15-49"></a><span class="w">                </span><span class="s">&quot;stdout_lines&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-15-50"><a id="__codelineno-15-50" name="__codelineno-15-50"></a><span class="w">                    </span><span class="s">&quot;02:19:22.598</span><span class="nv"> </span><span class="s">UTC</span><span class="nv"> </span><span class="s">Mon</span><span class="nv"> </span><span class="s">Oct</span><span class="nv"> </span><span class="s">21</span><span class="nv"> </span><span class="s">2019&quot;</span>
</span><span id="__span-15-51"><a id="__codelineno-15-51" name="__codelineno-15-51"></a><span class="w">                </span><span class="p p-Indicator">]</span>
</span><span id="__span-15-52"><a id="__codelineno-15-52" name="__codelineno-15-52"></a><span class="w">            </span><span class="p p-Indicator">}</span>
</span><span id="__span-15-53"><a id="__codelineno-15-53" name="__codelineno-15-53"></a><span class="w">        </span><span class="p p-Indicator">]</span>
</span><span id="__span-15-54"><a id="__codelineno-15-54" name="__codelineno-15-54"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-15-55"><a id="__codelineno-15-55" name="__codelineno-15-55"></a><span class="err">}</span>
</span><span id="__span-15-56"><a id="__codelineno-15-56" name="__codelineno-15-56"></a>
</span><span id="__span-15-57"><a id="__codelineno-15-57" name="__codelineno-15-57"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP ***********************************************************************************************************************</span>
</span><span id="__span-15-58"><a id="__codelineno-15-58" name="__codelineno-15-58"></a><span class="nt">r1                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="CLI Command Multiple" src="/images/2019/10/blog-cli_multiple-looping.gif" /></p>
<p>In this execution we now have to get at the information within the results section. You do however
also get the command in the output, as well as some other module arguments, which can be handy! To
get at the results from <code>show ntp associations</code> you will need to use
<code>command_output.results[0].stdout</code> and <code>command_output.results[1].stdout</code> to get at the results of
<code>show clock</code>. </p>
<h3 id="summary"><a class="toclink" href="../../ansible-cli-vs-ios-command/#summary">Summary</a></h3>
<p>I hope this has been valuable to you as a reader. With <code>cli_command</code> still relatively new, having
been released in Ansible 2.7, I expect that it will continue to evolve. Take a look at the docs
pages for these here:</p>
<p><a href="https://docs.ansible.com/ansible/latest/modules/cli_command_module.html">cli_command</a><br />
<a href="https://docs.ansible.com/ansible/latest/modules/ios_command_module.html">ios_command</a>  </p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-08-04 00:00:00">August 4, 2019</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/eveng/" class="md-meta__link">eveng</a>, 
              <a href="../../category/ansible/" class="md-meta__link">ansible</a>, 
              <a href="../../category/network-simulation/" class="md-meta__link">network simulation</a>, 
              <a href="../../category/netdevops/" class="md-meta__link">netdevops</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="eve-ng-for-automation-practice-and-testing"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/">EVE-NG for Automation Practice and Testing</a></h2>
<p>As I restarted looking at how I'm continuing my education on the Network
Automation and certification realm I asked the question "How are you simulating
your network environment?" At the same time there has been thought on the idea
of leveraging cloud resources to gain experience there.  </p>
<p>First requirement for me is that whatever tool/simulation set that I use it has
to work. That being said, I need to be able to generate configurations, connect
devices to each other, and have packets flow through the simulated network, just
like any other network.</p>
<p>Second requirement is that I desire the solution to be economical. As a
<strong>budget</strong> for this there wasn't a lot of money left to be throwing around.  </p>
<p>Asking around, the third softer requirement is the solution should have a GUI of
some sorts to make things work quickly so you aren't fussing around with
creating your own middleware solution.  </p>
<p>My answer then to this at this point in time (2019-08-04) is EVE-NG. There is a
strong possibility of this changing in the near future based on what I saw at
2019 Cisco Live to Cisco's VIRL, but at the moment, EVE-NG and GNS3 both meet
the requirements.</p>
<p>If you are looking for the part about how I get at devices in the EVE-NG network
jump down to "EVE-NG for Automation Practice".  </p>
<p>This is not going to be a post on getting started on using the solutions.
This post assumes that you are up and running with EVE locally on your network
already. There are links further down that do help though for getting
connectivity.</p>
<h3 id="requirements-for-automation"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/#requirements-for-automation">Requirements for automation</a></h3>
<ul>
<li>Must be able to simulate larger networks</li>
<li>Must be able to SSH to the devices directly for automation (Not just click on
and get a console window)</li>
</ul>
<h3 id="evaluation-in-my-mind-no-formal-written-down"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/#evaluation-in-my-mind-no-formal-written-down">Evaluation (In my mind, no formal written down)</a></h3>
<p>First when looking at the cloud side of things for running EVE-NG, I had built
out an instance of EVE-NG in Google Cloud with the help of
<a href="https://twitter.com/showipintbri">@showipintbri</a>'s article on
<a href="https://showipintbri.blogspot.com/2018/08/eve-ng-in-cloud.html">EVE-NG in the Cloud</a>.
As I looked at what I had already done with a bare metal host it appeared that
I would need to create a VPN to be able to get at the network behind the cloud
of an EVE-NG. Looking at the pricing on a VPN tunnel per minute/hour with Google
Cloud, I made the evaluation that doing this in the cloud would not be
economical.  </p>
<p>GNS3 has been a solid main stay for some time in the Network simulation world.
There is nothing wrong with it. I have been successful in reaching into the
GNS3 simulated world from a real network. There are some instructions on the web
about how to do so. I had basically followed this instruction set (that has been removed, using the
way back machine to get the old post) - 
<a href="https://web.archive.org/web/20190521002219/https://docs.gns3.com/1vFs-KENh2uUFfb47Q2oeSersmEK4WahzWX-HrMIMd00/index.html">Connect GNS3 to the Internet</a>.  </p>
<p>For me to get started quickly, I had recently installed an EVE-NG bare metal
installation. That is the route that I have chosen at the moment to get started
quickly. For instructions on doing a bare metal installation of EVE-NG I
followed the online docs located on the EVE-NG main page - 
<a href="https://www.eve-ng.net/documentation/installation/bare-install">EVE-NG Bare Metal Install</a>.</p>
<h3 id="eve-ng-for-automation-practice-and-testing_1"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/#eve-ng-for-automation-practice-and-testing_1">EVE-NG for Automation Practice and Testing</a></h3>
<p>So now how do we get access to the network? First within EVE-NG I <strong>Add a New
Network</strong> to the project. I make sure that it is set to:</p>
<ul>
<li>Number of Networks to build: 1</li>
<li>Name/Prefix: Internet (Be creative if you wish)</li>
<li>Type: <strong>bridge</strong></li>
</ul>
<p><img alt="EVE-NG Bridge Net" src="/images/2019/07/eveng_add_bridge_net.png" /><br />
The type of <strong>bridge</strong> is what we are looking for to enable the connectivity.  </p>
<h4 id="connecting-your-router"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/#connecting-your-router">Connecting your router</a></h4>
<p>First thing you need to do within EVE-NG is to add a router and connect it to
your <em>Outside</em> network. I've done so as shown here:</p>
<p><img alt="EVE-NG Router Host" src="/images/2019/07/eveng_add_bridge_host.png" />  </p>
<p>Then the configuration on this Cisco edge device I have configured the following
on the interface that has been connected to the outside.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>interface<span class="w"> </span>GigabitEthernet0/0
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w"> </span>ip<span class="w"> </span>address<span class="w"> </span>dhcp
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w"> </span>duplex<span class="w"> </span>full
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w"> </span>speed<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w"> </span>media-type<span class="w"> </span>rj45
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>end
</span></code></pre></div>
<p>This allows the device to come online and get a network address. If you wanted
to prescribe what address it is in a static fashion, that is something you can
do too. I like to use DHCP to verify that the device is in fact connected to the
home network.  </p>
<h4 id="routing"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/#routing">Routing</a></h4>
<p>For connectivity this is where I like to start with OSPF to peer with my home
firewall. Why? First, because the firewall at home supports OSPF and why not use
routing! Secondly it is more practice with OSPF. Much of the time in my career
has been spent at places where EIGRP is the predominant IGP. It always helps to
continue to gain experience. This is where you could use a static route for your
device to send the routes back into your EVE-NG environment. You'll want to make
sure that you have routes for the networks that are in the network and that they
do not overlap with your existing home network.  </p>
<h4 id="test-connections"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/#test-connections">Test Connections</a></h4>
<p>Once connected, I make sure that I make sure that I'm able to connect
successfully with SSH before starting the Ansible work. You could create and get
started with a playbook and test, but I found it is easier to verify that you
have SSH connectivity natively to your devices just like you would with a
non-virtualized network.  </p>
<h3 id="automation-testing"><a class="toclink" href="../../eveng-for-autoamtion-practice-and-testing/#automation-testing">Automation Testing</a></h3>
<p>Now that there is connectivity to the devices on the box that you can SSH to
each device from your home network, you are able to do testing of various
playbooks. Start with some simple show commands using the <strong>ios_command</strong> or the
newer <strong>cli_command</strong> module. And then debug it. Head on over to the post my
earlier post
<a href="https://josh-v.com/blog/2019/01/05/ansible-output-work.html">Ansible - working with command output</a>
for some samples on getting started with Cisco devices.  </p>
<p>Hope this is something that is helpful for you at home already running EVE
locally!</p>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../..">1</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="../5/">5</a> <a class="md-pagination__link" href="../6/">6</a> <span class="md-pagination__current">7</span> <a class="md-pagination__link" href="../8/">8</a> <a class="md-pagination__link" href="../9/">9</a>
</nav>
        
      
    </div>
  </div>

          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" hidden>
        
        
          
          <a href="../../about/" class="md-footer__link md-footer__link--next" aria-label="Next: üë§ About">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                üë§ About
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2018 - 2024 Josh VanDeraa ‚Äì <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jvanderaa" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/josh-vanderaa/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/vanderaaj" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://fosstodon.org/@jvanderaa" target="_blank" rel="noopener me" title="fosstodon.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "content.code.copy", "content.action.view", "content.tabs.link", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.081f42fc.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>