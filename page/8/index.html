
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Josh VanDeraa">
      
      
        <link rel="canonical" href="https://josh-v.com/page/8/">
      
      
      
        <link rel="next" href="../../about/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.24">
    
    
      
        <title>üè† Home - Josh VanDeraa</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 12a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M6 13h8l-3.5 3.5 1.42 1.42L17.84 12l-5.92-5.92L10.5 7.5 14 11H6v2Z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-QCDLSTK9K6"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-QCDLSTK9K6",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-QCDLSTK9K6",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#home" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Josh VanDeraa" class="md-header__button md-logo" aria-label="Josh VanDeraa" data-md-component="logo">
      
  <img src="../../assets/router.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Josh VanDeraa
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              üè† Home
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jvanderaa/jvanderaa.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jvanderaa/jvanderaa.github.io
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  üè† Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
    
  
  üë§ About

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../book/" class="md-tabs__link">
        
  
    
  
  üìñ Book: OSS Net Mgmt

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../links/" class="md-tabs__link">
        
  
    
  
  üîó Links

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../archive/2024/" class="md-tabs__link">
          
  
    
  
  üìö Posts

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../category/ansible/" class="md-tabs__link">
          
  
    
  
  üè∑Ô∏è Categories

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Josh VanDeraa" class="md-nav__button md-logo" aria-label="Josh VanDeraa" data-md-component="logo">
      
  <img src="../../assets/router.png" alt="logo">

    </a>
    Josh VanDeraa
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jvanderaa/jvanderaa.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jvanderaa/jvanderaa.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
      
    
  
  
    <li class="md-nav__item">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    üè† Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="../.." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    üè† Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ansible-ios-bgp-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible IOS BGP Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-asa-og-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible ASA OG Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-asa-command-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible ASA Command Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-saving-cisco-configs-to-nvram-with-cisco-specific-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Saving Cisco Configs to NVRAM with Cisco Specific Modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-cisco-ios-interface-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Cisco IOS Interface Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-ios-vlan" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible IOS VLAN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-ios-banner" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible IOS Banner
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-network-engine-and-ntc-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Network Engine and NTC Templates
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üë§ About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../book/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üìñ Book: OSS Net Mgmt
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üîó Links
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üìö Posts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üìö Posts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2019/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2019
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../archive/2018/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2018
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üè∑Ô∏è Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üè∑Ô∏è Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ansible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ansible
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/arista/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    arista
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/asa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asa
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/asa_og/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    asa_og
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/automation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    automation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    blog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco_ios/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco_ios
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco_nxos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco_nxos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/cisco_wlc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cisco_wlc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/communications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    communications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/debian/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    debian
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/devnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    devnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/earth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    earth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/eveng/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eveng
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/expert/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    expert
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/flask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flask
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/golang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    golang
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/golf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    golf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/graphql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    graphql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/hashicorp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hashicorp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/homeassistant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    homeassistant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/ios_interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ios_interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/juniper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    juniper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/meraki/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    meraki
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nautobot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nautobot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/netbox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netbox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/netdevops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netdevops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/netmiko/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    netmiko
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/network-simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network simulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/network_design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    network_design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/networking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    networking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/nornir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nornir
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/poetry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    poetry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/productivity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    productivity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/prometheus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    prometheus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/redux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    redux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/saving_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    saving_config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/slack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    slack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/vault/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vault
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/wan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wan
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ansible-ios-bgp-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible IOS BGP Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-asa-og-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible ASA OG Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-asa-command-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible ASA Command Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-saving-cisco-configs-to-nvram-with-cisco-specific-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Saving Cisco Configs to NVRAM with Cisco Specific Modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-cisco-ios-interface-module" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Cisco IOS Interface Module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-ios-vlan" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible IOS VLAN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-ios-banner" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible IOS Banner
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible-network-engine-and-ntc-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Network Engine and NTC Templates
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="home">üè† Home<a class="headerlink" href="#home" title="Permanent link">#</a></h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-07-13 00:00:00">July 13, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              9 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-ios-bgp-module"><a class="toclink" href="../../ansible-ios-bgp-module/">Ansible IOS BGP Module</a></h2>
<p>In this post I'm going to be taking a deeper dive into the new in Ansible 2.8
<a href="https://docs.ansible.com/ansible/2.8/modules/ios_bgp_module.html">IOS BGP</a>
module. This may be one of the more complex modules to date and I'll try to
make it as simple as possible.  </p>
<p>For a reminder about the BGP protocol is that this is the predominate protocol
that runs the Internet. It is used to peer up with other companies and is what
helps to make the Internet great. This is a very powerful protocol, and has been
expanded to support many things. This is also a protocol that is heavily used in
modern data centers.  </p>
<p>On this module there are a TON of parameters (OK - 47 parameters). That is going
to be too many to list out. If you want to take a look at each and every one of
the parameters (which I do recommend doing at times, or at least going to the 
examples) check out the link above that takes you to the Ansible documentation.  </p>
<p>Let's dive on in.</p>
<blockquote>
<p>Note: In this I will be working with a "fixed version" of the <code>ios_bgp</code>
module. In working on the post it was found that <code>next-hop-self</code> was not
getting applied when used in the module. This is fixed in a coming release of
Ansible. As of 2.8.1 this is still broken. See
<a href="https://github.com/ansible/ansible/pull/58789">https://github.com/ansible/ansible/pull/58789</a>
for more information.  </p>
</blockquote>
<h3 id="observations"><a class="toclink" href="../../ansible-ios-bgp-module/#observations">Observations</a></h3>
<p>A couple of general observations and my take on the module before getting into
the lab and demo portions. This module is a great start on simplifying what can
be a very complex configuration with BGP. By its nature BGP has a deep and
complex configuration because of how flexible and how much has been stuffed into
the BGP protocol. It's being used within Data Centers of single tenants! This is
not going to be a post about BGP however - you can find plenty of those
elsewhere that are more in depth at this point.  </p>
<p>This module gets the basics spot on. I'm going to look to leverage this wherever
I can. That said however, there are still a few pieces that I haven't been able
to figure out how to do with this, and first comes the ISP world. Where there
are multiple VRFs configured within BGP. I'm hopeful that this can be expanded
in the future to support VRF configuration as well.  </p>
<p>All that said, this is a complex module, and has a lot of great standardization
to it. Take a look at the module definition in the
<a href="https://docs.ansible.com/ansible/2.8/modules/ios_bgp_module.html">Ansible docs</a>.</p>
<p>A very impressive part to this as well is that the redistribution from multiple
protocols is covered within the module. Route maps can be applied on
redistributions as well as the network advertisements. It's going to continue to
improve!  </p>
<h3 id="lab-setup"><a class="toclink" href="../../ansible-ios-bgp-module/#lab-setup">Lab Setup</a></h3>
<h4 id="lab-devices"><a class="toclink" href="../../ansible-ios-bgp-module/#lab-devices">Lab Devices</a></h4>
<p>For this module in particular I went ahead and designed a new lab so we can dig
deep into the setup of various methods of BGP. First we are having R2 as the
edge of the lab, heading out Gig0/1 towards the Internet. R2 is acting as a
single router within an ISP in this instance. R1 is the edge of the virtualized
environment which allows me to leverage Ansible from my machine as the control
machine. R3 and R4 will be on the edge of the enterprise network, with R5
originating some routes via EIGRP to the routers on R3 and R4.  </p>
<p><img alt="BGPLabDesign" src="/images/2019/07/lab_for_bgp.png" />  </p>
<h4 id="networks"><a class="toclink" href="../../ansible-ios-bgp-module/#networks">Networks</a></h4>
<p>Routes being advertised by R5 are two /25 networks out of the 203.0.113.0/24
network. All of the addressing in the "production" area of this enterprise are
using <a href="https://tools.ietf.org/html/rfc5737">RFC5737</a> address space. These are:</p>
<ul>
<li>198.51.100.0/24</li>
<li>203.0.113.0/24</li>
<li>192.0.2.0/24</li>
</ul>
<h4 id="scenario"><a class="toclink" href="../../ansible-ios-bgp-module/#scenario">Scenario</a></h4>
<p>For demonstration purposes the configuration will be getting done on only R3
from a text perspective. There will however be the modules on the
<a href="https://github.com/jvanderaa/ansible-using_ios">Github</a> page, and in a follow
on subsequent video demonstration of the playbook.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span>
<span class="normal"><a href="#__codelineno-9-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;PLAY 1: Get Configuration Backup to verify connectivity&quot;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 1: Verify Config Backup&quot;</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;PLAY 2: Setup R2&quot;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 1: Setup eBGP Peers&quot;</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;PLAY 3: Setup R4&quot;</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 1: Setup BGP Peers&quot;</span>
</span></code></pre></div></td></tr></table></div>
<p>This is going to walk through getting R3 to eBGP peer with R2 as a 3rd party
connection, and to R4 as an iBGP peer for internal BGP. This will not work with
the internal routing protocols. We assume that these are already all set to
go.  </p>
<h5 id="initial-routing-configuration"><a class="toclink" href="../../ansible-ios-bgp-module/#initial-routing-configuration">Initial Routing Configuration</a></h5>
<p>This is more just to show where we are and that there is nothing configured for
BGP on R3.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a>R3#show<span class="w"> </span>run<span class="w"> </span><span class="p">|</span><span class="w"> </span>sec<span class="w"> </span>bgp
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>R3#
</span></code></pre></div></td></tr></table></div>
<h5 id="first-bgp-neighbor"><a class="toclink" href="../../ansible-ios-bgp-module/#first-bgp-neighbor">First BGP Neighbor</a></h5>
<p>The first BGP neighbor we should bring up is within the same AS. Let's make sure
that we are able to get BGP going to that within your same autonomous system
and control before bringing up an exterior peer. In this example we will be
building a BGP peer to 198.51.100.2 with the AS65500.  </p>
<h6 id="playbook-start-add-ibgp-peer"><a class="toclink" href="../../ansible-ios-bgp-module/#playbook-start-add-ibgp-peer">Playbook Start - Add iBGP peer</a></h6>
<p>Getting started with building the internal BGP connection the task does get a
touch lengthy, so leveraging copy and paste and finding the fields with the
help of the module documentation this is the play to build that iBGP neighbor:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PLAY</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Setup</span><span class="nv"> </span><span class="s">iBGP</span><span class="nv"> </span><span class="s">Peer</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">R4&quot;</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">r3</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Setup</span><span class="nv"> </span><span class="s">iBGP</span><span class="nv"> </span><span class="s">Peer&quot;</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">      </span><span class="nt">ios_bgp</span><span class="p">:</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">          </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65500</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">          </span><span class="nt">router_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.3</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">          </span><span class="nt">log_neighbor_changes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">          </span><span class="nt">neighbors</span><span class="p">:</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">neighbor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">198.51.100.2</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">              </span><span class="nt">remote_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65500</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">              </span><span class="nt">activate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="w">              </span><span class="nt">timers</span><span class="p">:</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="w">                </span><span class="nt">keepalive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">                </span><span class="nt">holdtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">45</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">                </span><span class="nt">min_neighbor_holdtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">              </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">R4</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">          </span><span class="nt">networks</span><span class="p">:</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">198.51.100.0</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">              </span><span class="nt">masklen</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">203.0.113.0</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">              </span><span class="nt">masklen</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="w">          </span><span class="nt">address_family</span><span class="p">:</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">afi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ipv4</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">              </span><span class="nt">safi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unicast</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="w">              </span><span class="nt">neighbors</span><span class="p">:</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">neighbor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">198.51.100.2</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">                  </span><span class="nt">activate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="w">                  </span><span class="nt">next_hop_self</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a><span class="w">        </span><span class="nt">operation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">merge</span>
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ibgp_peer1</span>
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a>
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Debug</span><span class="nv"> </span><span class="s">output&quot;</span>
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ibgp_peer1</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>Lines 10, 11, 12 are very common on the BGP configuration. Let's walk through
some of these.</p>
<p>Line 10: Sets the locally running BGP AS on the router<br />
Line 11: Sets the router-id to be used for the BGP process<br />
Line 12: Sets logging of neighbor changes to true<br />
Lines 13-21: Sets configuration of neighbor detail, outside of the address
family<br />
Lines 22-26: Are used for what networks we want to advertise from BGP<br />
Lines 27-33: Used for BGP address family configuration updates<br />
Lines 34-36: Identify our neighbor within the address family<br />
Line 37: The operation style from Merge, Replace, Override or Delete  </p>
<h6 id="playbook-ibgp-execution"><a class="toclink" href="../../ansible-ios-bgp-module/#playbook-ibgp-execution">Playbook iBGP - Execution</a></h6>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;PLAY 1: Setup iBGP Peer to R4&quot;</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 1: Setup iBGP Peer&quot;</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 2: Debug output&quot;</span>
</span></code></pre></div></td></tr></table></div>
<iframe width="853" height="480" src="https://www.youtube.com/embed/pqIDnPkiyiE?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>There are 2 tasks so we can see the output. The first task is to setup an iBGP
peer. We get to see the output on the second task.  </p>
<p>Task 2 output has all of the router configurations that are going to be applied.
Before the change there are no neighbors established. On the console there is
an immediate neighbor established on the iBGP side of things with this
configuration.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span>
<span class="normal"><a href="#__codelineno-13-31">31</a></span>
<span class="normal"><a href="#__codelineno-13-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup iBGP Peer to R4] *******************************************</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup iBGP Peer] *************************************************</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r3</span><span class="p p-Indicator">]</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Debug output] ****************************************************</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r3</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">            </span><span class="s">&quot;router</span><span class="nv"> </span><span class="s">bgp</span><span class="nv"> </span><span class="s">65500&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">            </span><span class="s">&quot;bgp</span><span class="nv"> </span><span class="s">router-id</span><span class="nv"> </span><span class="s">10.0.0.3&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">            </span><span class="s">&quot;bgp</span><span class="nv"> </span><span class="s">log-neighbor-changes&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">            </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">198.51.100.2</span><span class="nv"> </span><span class="s">remote-as</span><span class="nv"> </span><span class="s">65500&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="w">            </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">198.51.100.2</span><span class="nv"> </span><span class="s">timers</span><span class="nv"> </span><span class="s">15</span><span class="nv"> </span><span class="s">45</span><span class="nv"> </span><span class="s">5&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="w">            </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">198.51.100.2</span><span class="nv"> </span><span class="s">description</span><span class="nv"> </span><span class="s">R4&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="w">            </span><span class="s">&quot;network</span><span class="nv"> </span><span class="s">198.51.100.0</span><span class="nv"> </span><span class="s">mask</span><span class="nv"> </span><span class="s">255.255.255.0&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="w">            </span><span class="s">&quot;network</span><span class="nv"> </span><span class="s">203.0.113.0</span><span class="nv"> </span><span class="s">mask</span><span class="nv"> </span><span class="s">255.255.255.128&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="w">            </span><span class="s">&quot;address-family</span><span class="nv"> </span><span class="s">ipv4&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">auto-summary&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="w">            </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">198.51.100.2</span><span class="nv"> </span><span class="s">activate&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="w">            </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">198.51.100.2</span><span class="nv"> </span><span class="s">next-hop-self&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="w">            </span><span class="s">&quot;exit-address-family&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24"></a><span class="w">            </span><span class="s">&quot;exit&quot;</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="err">}</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29"></a>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31"></a><span class="nt">r3                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0    s</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32"></a><span class="l l-Scalar l-Scalar-Plain">kipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<p>Pretty straight to the point, that we have a complete BGP configuration getting
deployed. A second run of the playbook <em>should</em> be idempotent, however, when
executing the <code>show run</code> to get the configuration of the device and the network
is subnetted on its proper class boundary the Ansible playbook will re-execute
the command. </p>
<blockquote>
<p>In working on this I have opened up a bug report on the module to see if this
can be made idempotent. See
<a href="https://github.com/ansible/ansible/issues/59083">Github Ansible Issue #59083</a></p>
</blockquote>
<h5 id="second-neighbor-the-isp-connection"><a class="toclink" href="../../ansible-ios-bgp-module/#second-neighbor-the-isp-connection">Second neighbor - the ISP connection</a></h5>
<p>Let's get to adding the second BGP connection. We will add a few more pieces of
information onto the single task of creating a full BGP configuration.  </p>
<p>First let's take a look at the BGP table on the router at this time, there is
only one neighbor:  </p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a>BGP<span class="w"> </span>router<span class="w"> </span>identifier<span class="w"> </span><span class="m">10</span>.0.0.3,<span class="w"> </span><span class="nb">local</span><span class="w"> </span>AS<span class="w"> </span>number<span class="w"> </span><span class="m">65500</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>BGP<span class="w"> </span>table<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">37404</span>,<span class="w"> </span>main<span class="w"> </span>routing<span class="w"> </span>table<span class="w"> </span>version<span class="w"> </span><span class="m">37404</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="m">11</span><span class="w"> </span>network<span class="w"> </span>entries<span class="w"> </span>using<span class="w"> </span><span class="m">1584</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>memory
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="m">12</span><span class="w"> </span>path<span class="w"> </span>entries<span class="w"> </span>using<span class="w"> </span><span class="m">960</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>memory
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="m">6</span>/6<span class="w"> </span>BGP<span class="w"> </span>path/bestpath<span class="w"> </span>attribute<span class="w"> </span>entries<span class="w"> </span>using<span class="w"> </span><span class="m">912</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>memory
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="m">1</span><span class="w"> </span>BGP<span class="w"> </span>AS-PATH<span class="w"> </span>entries<span class="w"> </span>using<span class="w"> </span><span class="m">24</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>memory
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="m">0</span><span class="w"> </span>BGP<span class="w"> </span>route-map<span class="w"> </span>cache<span class="w"> </span>entries<span class="w"> </span>using<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>memory
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="m">0</span><span class="w"> </span>BGP<span class="w"> </span>filter-list<span class="w"> </span>cache<span class="w"> </span>entries<span class="w"> </span>using<span class="w"> </span><span class="m">0</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>memory
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>BGP<span class="w"> </span>using<span class="w"> </span><span class="m">3480</span><span class="w"> </span>total<span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span>memory
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a>BGP<span class="w"> </span>activity<span class="w"> </span><span class="m">18</span>/6<span class="w"> </span>prefixes,<span class="w"> </span><span class="m">18708</span>/18696<span class="w"> </span>paths,<span class="w"> </span>scan<span class="w"> </span>interval<span class="w"> </span><span class="m">60</span><span class="w"> </span>secs
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>Neighbor<span class="w">        </span>V<span class="w">           </span>AS<span class="w"> </span>MsgRcvd<span class="w"> </span>MsgSent<span class="w">   </span>TblVer<span class="w">  </span>InQ<span class="w"> </span>OutQ<span class="w"> </span>Up/Down<span class="w">  </span>State/PfxRcd
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="m">198</span>.51.100.2<span class="w">    </span><span class="m">4</span><span class="w">        </span><span class="m">65500</span><span class="w">   </span><span class="m">37400</span><span class="w">      </span><span class="m">63</span><span class="w">    </span><span class="m">37404</span><span class="w">    </span><span class="m">0</span><span class="w">    </span><span class="m">0</span><span class="w"> </span><span class="m">00</span>:13:39<span class="w">       </span><span class="m">11</span>
</span></code></pre></div></td></tr></table></div>
<p>THe playbook is now:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nn">---</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;PLAY</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Setup</span><span class="nv"> </span><span class="s">iBGP</span><span class="nv"> </span><span class="s">Peer</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">R4&quot;</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">r3</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Setup</span><span class="nv"> </span><span class="s">iBGP</span><span class="nv"> </span><span class="s">Peer&quot;</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">      </span><span class="nt">ios_bgp</span><span class="p">:</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">        </span><span class="nt">config</span><span class="p">:</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">          </span><span class="nt">bgp_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65500</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">          </span><span class="nt">router_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.3</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">          </span><span class="nt">log_neighbor_changes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">          </span><span class="nt">neighbors</span><span class="p">:</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">neighbor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">198.51.100.2</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">              </span><span class="nt">remote_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65500</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w">              </span><span class="nt">timers</span><span class="p">:</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w">                </span><span class="nt">keepalive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">                </span><span class="nt">holdtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">45</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">                </span><span class="nt">min_neighbor_holdtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w">              </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">R4</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">neighbor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.0.2.1</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="w">              </span><span class="nt">remote_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65510</span>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w">              </span><span class="nt">timers</span><span class="p">:</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">                </span><span class="nt">keepalive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="w">                </span><span class="nt">holdtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">45</span>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="w">                </span><span class="nt">min_neighbor_holdtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="w">              </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ISP Neighbor 1</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="w">          </span><span class="nt">networks</span><span class="p">:</span>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">198.51.100.0</span>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a><span class="w">              </span><span class="nt">masklen</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">203.0.113.0</span>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a><span class="w">              </span><span class="nt">masklen</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">203.0.113.128</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a><span class="w">              </span><span class="nt">masklen</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a><span class="w">          </span><span class="nt">address_family</span><span class="p">:</span>
</span><span id="__span-15-39"><a id="__codelineno-15-39" name="__codelineno-15-39" href="#__codelineno-15-39"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">afi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ipv4</span>
</span><span id="__span-15-40"><a id="__codelineno-15-40" name="__codelineno-15-40" href="#__codelineno-15-40"></a><span class="w">              </span><span class="nt">safi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unicast</span>
</span><span id="__span-15-41"><a id="__codelineno-15-41" name="__codelineno-15-41" href="#__codelineno-15-41"></a><span class="w">              </span><span class="nt">auto_summary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-15-42"><a id="__codelineno-15-42" name="__codelineno-15-42" href="#__codelineno-15-42"></a><span class="w">              </span><span class="nt">neighbors</span><span class="p">:</span>
</span><span id="__span-15-43"><a id="__codelineno-15-43" name="__codelineno-15-43" href="#__codelineno-15-43"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">neighbor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">198.51.100.2</span>
</span><span id="__span-15-44"><a id="__codelineno-15-44" name="__codelineno-15-44" href="#__codelineno-15-44"></a><span class="w">                  </span><span class="nt">activate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-15-45"><a id="__codelineno-15-45" name="__codelineno-15-45" href="#__codelineno-15-45"></a><span class="w">                  </span><span class="nt">next_hop_self</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-15-46"><a id="__codelineno-15-46" name="__codelineno-15-46" href="#__codelineno-15-46"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">neighbor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.0.2.1</span>
</span><span id="__span-15-47"><a id="__codelineno-15-47" name="__codelineno-15-47" href="#__codelineno-15-47"></a><span class="w">                  </span><span class="nt">activate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-15-48"><a id="__codelineno-15-48" name="__codelineno-15-48" href="#__codelineno-15-48"></a><span class="w">        </span><span class="nt">operation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">merge</span>
</span><span id="__span-15-49"><a id="__codelineno-15-49" name="__codelineno-15-49" href="#__codelineno-15-49"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bgp_setup</span>
</span><span id="__span-15-50"><a id="__codelineno-15-50" name="__codelineno-15-50" href="#__codelineno-15-50"></a>
</span><span id="__span-15-51"><a id="__codelineno-15-51" name="__codelineno-15-51" href="#__codelineno-15-51"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SUMMARY</span><span class="nv"> </span><span class="s">TASK:</span><span class="nv"> </span><span class="s">Debug</span><span class="nv"> </span><span class="s">output&quot;</span>
</span><span id="__span-15-52"><a id="__codelineno-15-52" name="__codelineno-15-52" href="#__codelineno-15-52"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-15-53"><a id="__codelineno-15-53" name="__codelineno-15-53" href="#__codelineno-15-53"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span>
</span><span id="__span-15-54"><a id="__codelineno-15-54" name="__codelineno-15-54" href="#__codelineno-15-54"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">bgp_setup</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-15-55"><a id="__codelineno-15-55" name="__codelineno-15-55" href="#__codelineno-15-55"></a><span class="nn">...</span>
</span></code></pre></div>
<h5 id="adding-second-neighbor-execution"><a class="toclink" href="../../ansible-ios-bgp-module/#adding-second-neighbor-execution">Adding Second Neighbor - Execution</a></h5>
<p>The execution of the playbook is straight forward again. As expected a second
neighbor statement is created with the <code>remote-as</code>, <code>timers</code>, and <code>description</code>.
The module also activates the neighbor.  </p>
<iframe width="853" height="480" src="https://www.youtube.com/embed/haevkbppxmI?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span>
<span class="normal"><a href="#__codelineno-16-24">24</a></span>
<span class="normal"><a href="#__codelineno-16-25">25</a></span>
<span class="normal"><a href="#__codelineno-16-26">26</a></span>
<span class="normal"><a href="#__codelineno-16-27">27</a></span>
<span class="normal"><a href="#__codelineno-16-28">28</a></span>
<span class="normal"><a href="#__codelineno-16-29">29</a></span>
<span class="normal"><a href="#__codelineno-16-30">30</a></span>
<span class="normal"><a href="#__codelineno-16-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [PLAY 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup iBGP Peer to R4] *******************************************</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Setup iBGP Peer] *************************************************</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r3</span><span class="p p-Indicator">]</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [SUMMARY TASK</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Debug output] **********************************************</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">r3</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="w">        </span><span class="p p-Indicator">{</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">            </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="w">            </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">                </span><span class="s">&quot;router</span><span class="nv"> </span><span class="s">bgp</span><span class="nv"> </span><span class="s">65500&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">                </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">192.0.2.1</span><span class="nv"> </span><span class="s">remote-as</span><span class="nv"> </span><span class="s">65510&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="w">                </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">192.0.2.1</span><span class="nv"> </span><span class="s">timers</span><span class="nv"> </span><span class="s">15</span><span class="nv"> </span><span class="s">45</span><span class="nv"> </span><span class="s">5&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">                </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">192.0.2.1</span><span class="nv"> </span><span class="s">description</span><span class="nv"> </span><span class="s">ISP</span><span class="nv"> </span><span class="s">Neighbor</span><span class="nv"> </span><span class="s">1&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="w">                </span><span class="s">&quot;network</span><span class="nv"> </span><span class="s">198.51.100.0</span><span class="nv"> </span><span class="s">mask</span><span class="nv"> </span><span class="s">255.255.255.0&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="w">                </span><span class="s">&quot;network</span><span class="nv"> </span><span class="s">203.0.113.128</span><span class="nv"> </span><span class="s">mask</span><span class="nv"> </span><span class="s">255.255.255.128&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="w">                </span><span class="s">&quot;address-family</span><span class="nv"> </span><span class="s">ipv4&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="w">                </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">auto-summary&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="w">                </span><span class="s">&quot;neighbor</span><span class="nv"> </span><span class="s">192.0.2.1</span><span class="nv"> </span><span class="s">activate&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21"></a><span class="w">                </span><span class="s">&quot;exit-address-family&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="w">                </span><span class="s">&quot;exit&quot;</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="w">            </span><span class="p p-Indicator">],</span>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24"></a><span class="w">            </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25"></a><span class="w">        </span><span class="p p-Indicator">}</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26"></a><span class="w">    </span><span class="p p-Indicator">]</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27"></a><span class="err">}</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28"></a>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30"></a><span class="nt">r3                         </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0    s</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31"></a><span class="l l-Scalar l-Scalar-Plain">kipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<p>Taking a look at the BGP table, we now have 2 neighbors formed instead of just
the one.  </p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="l l-Scalar l-Scalar-Plain">BGP router identifier 10.0.0.3, local AS number 65500</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="l l-Scalar l-Scalar-Plain">BGP table version is 58006, main routing table version 58006</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="l l-Scalar l-Scalar-Plain">11 network entries using 1584 bytes of memory</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="l l-Scalar l-Scalar-Plain">19 path entries using 1520 bytes of memory</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="l l-Scalar l-Scalar-Plain">9/6 BGP path/bestpath attribute entries using 1368 bytes of memory</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="l l-Scalar l-Scalar-Plain">1 BGP AS-PATH entries using 24 bytes of memory</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="l l-Scalar l-Scalar-Plain">0 BGP route-map cache entries using 0 bytes of memory</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="l l-Scalar l-Scalar-Plain">0 BGP filter-list cache entries using 0 bytes of memory</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="l l-Scalar l-Scalar-Plain">BGP using 4496 total bytes of memory</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="l l-Scalar l-Scalar-Plain">BGP activity 21/9 prefixes, 29013/28994 paths, scan interval 60 secs</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11"></a>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="l l-Scalar l-Scalar-Plain">Neighbor        V           AS MsgRcvd MsgSent   TblVer  InQ OutQ Up/Down  State/PfxRcd</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="l l-Scalar l-Scalar-Plain">192.0.2.1       4        65510      31      30    56929    0    0 00:03:26        6</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="l l-Scalar l-Scalar-Plain">198.51.100.2    4        65500   57996      99    58006    0    0 00:21:06       11</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="summary"><a class="toclink" href="../../ansible-ios-bgp-module/#summary">Summary</a></h3>
<p>The module library keeps expanding. Originally I was taken back on the number of
different modules being created that had a specialty to it. Take a look at the
number of modules available for Ansible 2.9 and
<a href="https://docs.ansible.com/ansible/2.9/modules/list_of_network_modules.html#nxos">NXOS</a>!
I now see the benefit, and this module is a great addition the IOS module
family. There are still areas that aren't covered that may be better suited to
be done with a Jinja template, but this is a great start on the BGP world for
IOS.  </p>
<p>Hope that this has helped someone along the way!</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-06-23 00:00:00">June 23, 2019</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/cisco/" class="md-meta__link">cisco</a>, 
              <a href="../../category/ansible/" class="md-meta__link">ansible</a>, 
              <a href="../../category/asa/" class="md-meta__link">asa</a>, 
              <a href="../../category/asa_og/" class="md-meta__link">asa_og</a></li>
        
        
          
          <li class="md-meta__item">
            
              16 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-asa-og-module"><a class="toclink" href="../../ansible-asa-og/">Ansible ASA OG Module</a></h2>
<p>Today we are taking a look at the newest module out for Cisco ASA Ansible
module - <a href="https://docs.ansible.com/ansible/latest/modules/asa_og_module.html">asa_og</a>.
This one is particularly exciting for the configurations that are being managed
heavily with Object Groups on firewalls. I'm particularly excited to review the
<strong>asa_og</strong> module, time to dig in.  </p>
<p><strong>New</strong> in this post is the finished playbooks being added to Github. I'm hoping
that this may be helpful and I am uploading the contents to Github for more to
be able to see and get access to if necessary. This will improve as I continue.  </p>
<p><a href="https://github.com/jvanderaa/ansible-asa_work">https://github.com/jvanderaa/ansible-asa_work</a></p>
<p><strong>Note</strong></p>
<blockquote>
<p>When working with this module there is not an option to save the configuration
available with it. Please remember this in your playbook logic. If needing
to save the configuration there are options. Take a look for samples on my
previous post <a href="https://josh-v.com/blog/2019/03/30/ansible-saving-cisco-configs-ios.html">Saving Configurations</a>
which does not include an example with ASAs yet. I will have to write a follow
up post on this at which point I will update hte link and content.</p>
</blockquote>
<h3 id="parameters"><a class="toclink" href="../../ansible-asa-og/#parameters">Parameters</a></h3>
<p>First we are going to take a look at the particular parameters to get started,
and what our options are for them. The items in bold are the ones that are
required by the module.</p>
<ul>
<li>description: Description for the object group, good for documenting the
purpose</li>
<li>group_object: This is a list for items within the group</li>
<li><strong>group_type</strong>: network-object, service-object, or port-object</li>
<li>host_ip: List of host addresses within the object group</li>
<li>ip_mask: List of IPs and masks for use in object groups</li>
<li><strong>name</strong>: Name of the object group</li>
<li>port_eq: Single port for port-object</li>
<li>port_range: Range for a port-object</li>
<li>protocol: UDP/TCP/TCP-UDP</li>
<li>service_cfg: Service object configuration protocol, direction, range or port</li>
<li>state: <strong>present</strong>/absent/replace to manage the state of the object</li>
</ul>
<p>For the straight forward parameters this seems like it is something that will be
very handy to use.  </p>
<h3 id="starting-lab-setup"><a class="toclink" href="../../ansible-asa-og/#starting-lab-setup">Starting Lab Setup</a></h3>
<p>For this module we are starting with an effectively blank configuration on the
firewalls. In future posts I will come back to this and show complete firewall
policy management using Ansible.</p>
<p>So the lab looks very much the same at the moment as some of the other posts,
which is below:  </p>
<p><img alt="LabDesign" src="/images/2019/01/lab_design.png" />  </p>
<p>Sample goals:<br />
- Create an object group for internal addresses (RFC1918)
- Create an object group for external DNS services (Google DNS, Cloudflare,
Quad9)
- Create a service group for DNS and NTP services
- Verify than a service group for just NTP_ONLY does not exist</p>
<h3 id="leveraging-ansible-og-for-creating-the-modules"><a class="toclink" href="../../ansible-asa-og/#leveraging-ansible-og-for-creating-the-modules">Leveraging Ansible OG for creating the modules</a></h3>
<h4 id="creating-rfc1918-group"><a class="toclink" href="../../ansible-asa-og/#creating-rfc1918-group">Creating RFC1918 Group</a></h4>
<p>Let's tackle the first item. First to show the configuration on the ASA
firewall for the object group:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1">1</a></span>
<span class="normal"><a href="#__codelineno-57-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show object-group</span><span class="w"> </span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show run | i RFC 1918</span>
</span></code></pre></div></td></tr></table></div>
<p>We see that there is not the object group that is desired to be there.  </p>
<p>We are going to modify the <em>Playbook</em> created in the last blog post for
<a href="https://josh-v.com/blog/2019/06/20/ansible-asa-command.html">asa_command</a> and
change it to managing our object groups. Starting out it will look like this:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="nn">---</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASA OG Working</span>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asa_firewalls</span>
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-58-10"><a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>
</span><span id="__span-58-11"><a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-58-12"><a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>
</span><span id="__span-58-13"><a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">RFC1918</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-58-14"><a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-58-15"><a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918_Networks</span>
</span><span id="__span-58-16"><a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object</span>
</span><span id="__span-58-17"><a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-58-18"><a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-58-19"><a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a><span class="w">        </span><span class="nt">ip_mask</span><span class="p">:</span>
</span><span id="__span-58-20"><a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0 255.0.0.0</span>
</span><span id="__span-58-21"><a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.0.0 255.240.0.0</span>
</span><span id="__span-58-22"><a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.0 255.255.0.0</span>
</span><span id="__span-58-23"><a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-58-24"><a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a>
</span><span id="__span-58-25"><a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">show</span><span class="nv"> </span><span class="s">interfaces&quot;</span>
</span><span id="__span-58-26"><a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-58-27"><a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>Now to run the playbook, the expect that the object group will be on the
firewall.  </p>
<h5 id="playbook-execution"><a class="toclink" href="../../ansible-asa-og/#playbook-execution">Playbook Execution</a></h5>
<p>The output from the playbook execution gives us exactly what we were looking
for. </p>
<ul>
<li>Task 1: Connects to the ASA and runs the commands, there is a change as the
ASA did not have the object group previously</li>
<li>Task 2: Output from the previous task shows the commands that were run and the
fact that the device was changed.</li>
</ul>
<h6 id="first-run"><a class="toclink" href="../../ansible-asa-og/#first-run">First Run</a></h6>
<iframe width="853" height="480" src="https://www.youtube.com/embed/PKTEWZG85G0?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>PLAY<span class="w"> </span><span class="o">[</span>ASA<span class="w"> </span>OG<span class="w"> </span>Working<span class="o">]</span><span class="w"> </span>**********************************************************
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Set<span class="w"> </span>RFC1918<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>****************************************
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a>changed:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>RFC1918<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>****************************
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a><span class="w">            </span><span class="s2">&quot;object-group network RFC1918_Networks&quot;</span>,
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a><span class="w">            </span><span class="s2">&quot;description RFC1918 Local Networks&quot;</span>,
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="w">            </span><span class="s2">&quot;network-object 10.0.0.0 255.0.0.0&quot;</span>,
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a><span class="w">            </span><span class="s2">&quot;network-object 172.16.0.0 255.240.0.0&quot;</span>,
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a><span class="w">            </span><span class="s2">&quot;network-object 192.168.0.0 255.255.0.0&quot;</span>
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-59-19"><a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a><span class="o">}</span>
</span><span id="__span-59-20"><a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a>
</span><span id="__span-59-21"><a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>*********************************************************************
</span><span id="__span-59-22"><a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a>asa1<span class="w">                       </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">2</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">1</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span>s
</span><span id="__span-59-23"><a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a><span class="nv">kipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span>
</span></code></pre></div>
<p>Re-running the playbook again, we see that the module is idempotent. Being that
we can safely run this continuously and not have any changes unless they are
necessary.</p>
<h6 id="second-run"><a class="toclink" href="../../ansible-asa-og/#second-run">Second Run</a></h6>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span>
<span class="normal"><a href="#__codelineno-60-15">15</a></span>
<span class="normal"><a href="#__codelineno-60-16">16</a></span>
<span class="normal"><a href="#__codelineno-60-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [ASA OG Working] **********************************************************</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2"></a>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set RFC1918 Object Group] ****************************************</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5"></a>
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of RFC1918 Object Group] ****************************</span>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[],</span>
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13"></a><span class="err">}</span>
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14"></a>
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16"></a><span class="nt">asa1                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=0    unreachable=0    failed=0    s</span>
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17"></a><span class="l l-Scalar l-Scalar-Plain">kipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="adding-onto-the-previous-playbook-to-add-the-second-group"><a class="toclink" href="../../ansible-asa-og/#adding-onto-the-previous-playbook-to-add-the-second-group">Adding onto the previous playbook to add the second group</a></h4>
<p>Continuing within this playbook we will create the second object group that will
be used, the external DNS providers will be added as host objects to a new group
for <code>EXTERNAL_DNS_NTP</code>. </p>
<p>Let's get straight to the play update. We will create a new task for this
second operation and then output the debug summary.</p>
<h5 id="playbook-setup-adding-host-ip-group"><a class="toclink" href="../../ansible-asa-og/#playbook-setup-adding-host-ip-group">Playbook Setup - Adding Host IP group</a></h5>
<p>We have added the second task to the playbook here, with another debug so we can
see when the changes are being made.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="nn">---</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASA OG Working</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asa_firewalls</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a>
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">RFC1918</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918_Networks</span>
</span><span id="__span-61-16"><a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object</span>
</span><span id="__span-61-17"><a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-61-18"><a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-61-19"><a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a><span class="w">        </span><span class="nt">ip_mask</span><span class="p">:</span>
</span><span id="__span-61-20"><a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0 255.0.0.0</span>
</span><span id="__span-61-21"><a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.0.0 255.240.0.0</span>
</span><span id="__span-61-22"><a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.0 255.255.0.0</span>
</span><span id="__span-61-23"><a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-61-24"><a id="__codelineno-61-24" name="__codelineno-61-24" href="#__codelineno-61-24"></a>
</span><span id="__span-61-25"><a id="__codelineno-61-25" name="__codelineno-61-25" href="#__codelineno-61-25"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">External</span><span class="nv"> </span><span class="s">DNS/NTP</span><span class="nv"> </span><span class="s">Providers</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-61-26"><a id="__codelineno-61-26" name="__codelineno-61-26" href="#__codelineno-61-26"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-61-27"><a id="__codelineno-61-27" name="__codelineno-61-27" href="#__codelineno-61-27"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EXTERNAL_DNS_NTP</span>
</span><span id="__span-61-28"><a id="__codelineno-61-28" name="__codelineno-61-28" href="#__codelineno-61-28"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object</span>
</span><span id="__span-61-29"><a id="__codelineno-61-29" name="__codelineno-61-29" href="#__codelineno-61-29"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-61-30"><a id="__codelineno-61-30" name="__codelineno-61-30" href="#__codelineno-61-30"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-61-31"><a id="__codelineno-61-31" name="__codelineno-61-31" href="#__codelineno-61-31"></a><span class="w">        </span><span class="nt">host_ip</span><span class="p">:</span>
</span><span id="__span-61-32"><a id="__codelineno-61-32" name="__codelineno-61-32" href="#__codelineno-61-32"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>
</span><span id="__span-61-33"><a id="__codelineno-61-33" name="__codelineno-61-33" href="#__codelineno-61-33"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span>
</span><span id="__span-61-34"><a id="__codelineno-61-34" name="__codelineno-61-34" href="#__codelineno-61-34"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9.9.9.9</span>
</span><span id="__span-61-35"><a id="__codelineno-61-35" name="__codelineno-61-35" href="#__codelineno-61-35"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">208.67.222.222</span>
</span><span id="__span-61-36"><a id="__codelineno-61-36" name="__codelineno-61-36" href="#__codelineno-61-36"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">208.67.220.220</span>
</span><span id="__span-61-37"><a id="__codelineno-61-37" name="__codelineno-61-37" href="#__codelineno-61-37"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output2</span><span class="w">     </span>
</span><span id="__span-61-38"><a id="__codelineno-61-38" name="__codelineno-61-38" href="#__codelineno-61-38"></a>
</span><span id="__span-61-39"><a id="__codelineno-61-39" name="__codelineno-61-39" href="#__codelineno-61-39"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">RFC1918</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-61-40"><a id="__codelineno-61-40" name="__codelineno-61-40" href="#__codelineno-61-40"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-61-41"><a id="__codelineno-61-41" name="__codelineno-61-41" href="#__codelineno-61-41"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-61-42"><a id="__codelineno-61-42" name="__codelineno-61-42" href="#__codelineno-61-42"></a>
</span><span id="__span-61-43"><a id="__codelineno-61-43" name="__codelineno-61-43" href="#__codelineno-61-43"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">External</span><span class="nv"> </span><span class="s">DNS</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-61-44"><a id="__codelineno-61-44" name="__codelineno-61-44" href="#__codelineno-61-44"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-61-45"><a id="__codelineno-61-45" name="__codelineno-61-45" href="#__codelineno-61-45"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output2</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h6 id="playbook-execution_1"><a class="toclink" href="../../ansible-asa-og/#playbook-execution_1">Playbook Execution</a></h6>
<ul>
<li>Task 1: Comes back OK, the object group is as defined and does not need to get
updated</li>
<li>Task 2: Adds the second object group that we were anticipating adding to the
firewall</li>
<li>Debug 1: Shows that there was no change by the <code>changed</code> output being set to
false</li>
<li>Debug 2: Once again shows the <code>changed</code> flag is set to <code>True</code> and the commands
executed on the device</li>
</ul>
<iframe width="853" height="480" src="https://www.youtube.com/embed/mOiixwviHFk?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>PLAY<span class="w"> </span><span class="o">[</span>ASA<span class="w"> </span>OG<span class="w"> </span>Working<span class="o">]</span><span class="w"> </span>**********************************************************
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Set<span class="w"> </span>RFC1918<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>****************************************
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>Set<span class="w"> </span>External<span class="w"> </span>DNS/NTP<span class="w"> </span>Providers<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>*********************
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>changed:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>RFC1918<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>***************************
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-62-15"><a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-62-16"><a id="__codelineno-62-16" name="__codelineno-62-16" href="#__codelineno-62-16"></a><span class="o">}</span>
</span><span id="__span-62-17"><a id="__codelineno-62-17" name="__codelineno-62-17" href="#__codelineno-62-17"></a>
</span><span id="__span-62-18"><a id="__codelineno-62-18" name="__codelineno-62-18" href="#__codelineno-62-18"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>External<span class="w"> </span>DNS<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>*****************************
</span><span id="__span-62-19"><a id="__codelineno-62-19" name="__codelineno-62-19" href="#__codelineno-62-19"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-62-20"><a id="__codelineno-62-20" name="__codelineno-62-20" href="#__codelineno-62-20"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-62-21"><a id="__codelineno-62-21" name="__codelineno-62-21" href="#__codelineno-62-21"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-62-22"><a id="__codelineno-62-22" name="__codelineno-62-22" href="#__codelineno-62-22"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-62-23"><a id="__codelineno-62-23" name="__codelineno-62-23" href="#__codelineno-62-23"></a><span class="w">            </span><span class="s2">&quot;object-group network EXTERNAL_DNS_NTP&quot;</span>,
</span><span id="__span-62-24"><a id="__codelineno-62-24" name="__codelineno-62-24" href="#__codelineno-62-24"></a><span class="w">            </span><span class="s2">&quot;network-object host 1.1.1.1&quot;</span>,
</span><span id="__span-62-25"><a id="__codelineno-62-25" name="__codelineno-62-25" href="#__codelineno-62-25"></a><span class="w">            </span><span class="s2">&quot;network-object host 8.8.8.8&quot;</span>,
</span><span id="__span-62-26"><a id="__codelineno-62-26" name="__codelineno-62-26" href="#__codelineno-62-26"></a><span class="w">            </span><span class="s2">&quot;network-object host 9.9.9.9&quot;</span>,
</span><span id="__span-62-27"><a id="__codelineno-62-27" name="__codelineno-62-27" href="#__codelineno-62-27"></a><span class="w">            </span><span class="s2">&quot;network-object host 208.67.222.222&quot;</span>,
</span><span id="__span-62-28"><a id="__codelineno-62-28" name="__codelineno-62-28" href="#__codelineno-62-28"></a><span class="w">            </span><span class="s2">&quot;network-object host 208.67.220.220&quot;</span>,
</span><span id="__span-62-29"><a id="__codelineno-62-29" name="__codelineno-62-29" href="#__codelineno-62-29"></a><span class="w">            </span><span class="s2">&quot;description External DNS Providers (CloudFlare, Google, Quad9, Umbr</span>
</span><span id="__span-62-30"><a id="__codelineno-62-30" name="__codelineno-62-30" href="#__codelineno-62-30"></a><span class="s2">            ella)&quot;</span>
</span><span id="__span-62-31"><a id="__codelineno-62-31" name="__codelineno-62-31" href="#__codelineno-62-31"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-62-32"><a id="__codelineno-62-32" name="__codelineno-62-32" href="#__codelineno-62-32"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-62-33"><a id="__codelineno-62-33" name="__codelineno-62-33" href="#__codelineno-62-33"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-62-34"><a id="__codelineno-62-34" name="__codelineno-62-34" href="#__codelineno-62-34"></a><span class="o">}</span>
</span><span id="__span-62-35"><a id="__codelineno-62-35" name="__codelineno-62-35" href="#__codelineno-62-35"></a>
</span><span id="__span-62-36"><a id="__codelineno-62-36" name="__codelineno-62-36" href="#__codelineno-62-36"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>**************************************************************************
</span><span id="__span-62-37"><a id="__codelineno-62-37" name="__codelineno-62-37" href="#__codelineno-62-37"></a>asa1<span class="w">                       </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">4</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">1</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span>
</span></code></pre></div>
<h6 id="playbook-results-on-asa"><a class="toclink" href="../../ansible-asa-og/#playbook-results-on-asa">Playbook Results on ASA</a></h6>
<p>As expected, we get the new items added to the configuration. When we look at
the before and after on the configuration of the ASA we now see that we have
the second object group, exactly as we expected.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-63-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-63-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-63-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-63-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-63-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-63-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-63-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-63-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-63-10">10</a></span>
<span class="normal"><a href="#__codelineno-63-11">11</a></span>
<span class="normal"><a href="#__codelineno-63-12">12</a></span>
<span class="normal"><a href="#__codelineno-63-13">13</a></span>
<span class="normal"><a href="#__codelineno-63-14">14</a></span>
<span class="normal"><a href="#__codelineno-63-15">15</a></span>
<span class="normal"><a href="#__codelineno-63-16">16</a></span>
<span class="normal"><a href="#__codelineno-63-17">17</a></span>
<span class="normal"><a href="#__codelineno-63-18">18</a></span>
<span class="normal"><a href="#__codelineno-63-19">19</a></span>
<span class="normal"><a href="#__codelineno-63-20">20</a></span>
<span class="normal"><a href="#__codelineno-63-21">21</a></span>
<span class="normal"><a href="#__codelineno-63-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show object-group</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2"></a><span class="l l-Scalar l-Scalar-Plain">object-group network RFC1918_Networks</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 10.0.0.0 255.0.0.0</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 172.16.0.0 255.240.0.0</span>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 192.168.0.0 255.255.0.0</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7"></a><span class="l l-Scalar l-Scalar-Plain">fw01#</span>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8"></a><span class="l l-Scalar l-Scalar-Plain">fw01#</span>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9"></a><span class="l l-Scalar l-Scalar-Plain">fw01#</span><span class="w"> </span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show object-group</span>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11"></a><span class="l l-Scalar l-Scalar-Plain">object-group network RFC1918_Networks</span>
</span><span id="__span-63-12"><a id="__codelineno-63-12" name="__codelineno-63-12"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-63-13"><a id="__codelineno-63-13" name="__codelineno-63-13"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 10.0.0.0 255.0.0.0</span>
</span><span id="__span-63-14"><a id="__codelineno-63-14" name="__codelineno-63-14"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 172.16.0.0 255.240.0.0</span>
</span><span id="__span-63-15"><a id="__codelineno-63-15" name="__codelineno-63-15"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 192.168.0.0 255.255.0.0</span>
</span><span id="__span-63-16"><a id="__codelineno-63-16" name="__codelineno-63-16"></a><span class="l l-Scalar l-Scalar-Plain">object-group network EXTERNAL_DNS_NTP</span>
</span><span id="__span-63-17"><a id="__codelineno-63-17" name="__codelineno-63-17"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-63-18"><a id="__codelineno-63-18" name="__codelineno-63-18"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 1.1.1.1</span>
</span><span id="__span-63-19"><a id="__codelineno-63-19" name="__codelineno-63-19"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 8.8.8.8</span>
</span><span id="__span-63-20"><a id="__codelineno-63-20" name="__codelineno-63-20"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 9.9.9.9</span>
</span><span id="__span-63-21"><a id="__codelineno-63-21" name="__codelineno-63-21"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.222.222</span>
</span><span id="__span-63-22"><a id="__codelineno-63-22" name="__codelineno-63-22"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.220.220</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="adding-on-the-port-group"><a class="toclink" href="../../ansible-asa-og/#adding-on-the-port-group">Adding on the Port Group</a></h4>
<p>Now we need to complete the setup by adding a port group to the playbook so
when a policy is built that the hosts can communicate on the specific ports. To
start off the policy will use only UDP ports 53 (DNS) and 123 (NTP).</p>
<blockquote>
<p>Yes DNS is also on TCP/53, but for this we will stick to only the UDP side for
non large requests.</p>
<p>Issue: When working on this I came across an issue with the asa_og module and
my particular setup (Python3.7.2) with respects to Ansible 2.8. The
concatenation engine would error out combining strings (the actual commands)
and integers. The work around on this that you see in the playbook is that
the ports are surrounded by quotes. This makes them strings instead of
integers and the module works. I have opened an issue on github for this.
<a href="https://github.com/ansible/ansible/issues/58258">https://github.com/ansible/ansible/issues/58258</a>
if you wish to check on the status.</p>
</blockquote>
<h5 id="playbook-adding-in-port-object-group-creation"><a class="toclink" href="../../ansible-asa-og/#playbook-adding-in-port-object-group-creation">Playbook - Adding in port-object group creation</a></h5>
<p>As expected there is a third task now that will be for creating the port object.
From the module parameters we are now using parameters of <code>protocol</code> and
<code>port_eq</code>. These are expected parameters for creating a port group.</p>
<h6 id="playbook-task-design-port-group"><a class="toclink" href="../../ansible-asa-og/#playbook-task-design-port-group">Playbook Task Design - Port Group</a></h6>
<p>Here is the task that is added with the group-type set to <code>port-object</code>:  </p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">3:</span><span class="nv"> </span><span class="s">Add</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SVC_OBJ_DNS_NTP</span>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53</span>
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">123</span>
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output3</span>
</span></code></pre></div>
<p>This brings the full playbook to looking like this:  </p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="nn">---</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASA OG Working</span>
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asa_firewalls</span>
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-65-9"><a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-65-10"><a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a>
</span><span id="__span-65-11"><a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-65-12"><a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a>
</span><span id="__span-65-13"><a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">RFC1918</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-65-14"><a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-65-15"><a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918_Networks</span>
</span><span id="__span-65-16"><a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object</span>
</span><span id="__span-65-17"><a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-65-18"><a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-65-19"><a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a><span class="w">        </span><span class="nt">ip_mask</span><span class="p">:</span>
</span><span id="__span-65-20"><a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0 255.0.0.0</span>
</span><span id="__span-65-21"><a id="__codelineno-65-21" name="__codelineno-65-21" href="#__codelineno-65-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.0.0 255.240.0.0</span>
</span><span id="__span-65-22"><a id="__codelineno-65-22" name="__codelineno-65-22" href="#__codelineno-65-22"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.0 255.255.0.0</span>
</span><span id="__span-65-23"><a id="__codelineno-65-23" name="__codelineno-65-23" href="#__codelineno-65-23"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-65-24"><a id="__codelineno-65-24" name="__codelineno-65-24" href="#__codelineno-65-24"></a>
</span><span id="__span-65-25"><a id="__codelineno-65-25" name="__codelineno-65-25" href="#__codelineno-65-25"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">External</span><span class="nv"> </span><span class="s">DNS/NTP</span><span class="nv"> </span><span class="s">Providers</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-65-26"><a id="__codelineno-65-26" name="__codelineno-65-26" href="#__codelineno-65-26"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-65-27"><a id="__codelineno-65-27" name="__codelineno-65-27" href="#__codelineno-65-27"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EXTERNAL_DNS_NTP</span>
</span><span id="__span-65-28"><a id="__codelineno-65-28" name="__codelineno-65-28" href="#__codelineno-65-28"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object</span>
</span><span id="__span-65-29"><a id="__codelineno-65-29" name="__codelineno-65-29" href="#__codelineno-65-29"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-65-30"><a id="__codelineno-65-30" name="__codelineno-65-30" href="#__codelineno-65-30"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-65-31"><a id="__codelineno-65-31" name="__codelineno-65-31" href="#__codelineno-65-31"></a><span class="w">        </span><span class="nt">host_ip</span><span class="p">:</span>
</span><span id="__span-65-32"><a id="__codelineno-65-32" name="__codelineno-65-32" href="#__codelineno-65-32"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>
</span><span id="__span-65-33"><a id="__codelineno-65-33" name="__codelineno-65-33" href="#__codelineno-65-33"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span>
</span><span id="__span-65-34"><a id="__codelineno-65-34" name="__codelineno-65-34" href="#__codelineno-65-34"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9.9.9.9</span>
</span><span id="__span-65-35"><a id="__codelineno-65-35" name="__codelineno-65-35" href="#__codelineno-65-35"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">208.67.222.222</span>
</span><span id="__span-65-36"><a id="__codelineno-65-36" name="__codelineno-65-36" href="#__codelineno-65-36"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">208.67.220.220</span>
</span><span id="__span-65-37"><a id="__codelineno-65-37" name="__codelineno-65-37" href="#__codelineno-65-37"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output2</span>
</span><span id="__span-65-38"><a id="__codelineno-65-38" name="__codelineno-65-38" href="#__codelineno-65-38"></a>
</span><span id="__span-65-39"><a id="__codelineno-65-39" name="__codelineno-65-39" href="#__codelineno-65-39"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">3:</span><span class="nv"> </span><span class="s">Add</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-65-40"><a id="__codelineno-65-40" name="__codelineno-65-40" href="#__codelineno-65-40"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-65-41"><a id="__codelineno-65-41" name="__codelineno-65-41" href="#__codelineno-65-41"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SVC_OBJ_DNS_NTP</span>
</span><span id="__span-65-42"><a id="__codelineno-65-42" name="__codelineno-65-42" href="#__codelineno-65-42"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-65-43"><a id="__codelineno-65-43" name="__codelineno-65-43" href="#__codelineno-65-43"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-65-44"><a id="__codelineno-65-44" name="__codelineno-65-44" href="#__codelineno-65-44"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-65-45"><a id="__codelineno-65-45" name="__codelineno-65-45" href="#__codelineno-65-45"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-65-46"><a id="__codelineno-65-46" name="__codelineno-65-46" href="#__codelineno-65-46"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-65-47"><a id="__codelineno-65-47" name="__codelineno-65-47" href="#__codelineno-65-47"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53</span>
</span><span id="__span-65-48"><a id="__codelineno-65-48" name="__codelineno-65-48" href="#__codelineno-65-48"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">123</span>
</span><span id="__span-65-49"><a id="__codelineno-65-49" name="__codelineno-65-49" href="#__codelineno-65-49"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output3</span>
</span><span id="__span-65-50"><a id="__codelineno-65-50" name="__codelineno-65-50" href="#__codelineno-65-50"></a>
</span><span id="__span-65-51"><a id="__codelineno-65-51" name="__codelineno-65-51" href="#__codelineno-65-51"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">RFC1918</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-65-52"><a id="__codelineno-65-52" name="__codelineno-65-52" href="#__codelineno-65-52"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-65-53"><a id="__codelineno-65-53" name="__codelineno-65-53" href="#__codelineno-65-53"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-65-54"><a id="__codelineno-65-54" name="__codelineno-65-54" href="#__codelineno-65-54"></a>
</span><span id="__span-65-55"><a id="__codelineno-65-55" name="__codelineno-65-55" href="#__codelineno-65-55"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">External</span><span class="nv"> </span><span class="s">DNS</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-65-56"><a id="__codelineno-65-56" name="__codelineno-65-56" href="#__codelineno-65-56"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-65-57"><a id="__codelineno-65-57" name="__codelineno-65-57" href="#__codelineno-65-57"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output2</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-65-58"><a id="__codelineno-65-58" name="__codelineno-65-58" href="#__codelineno-65-58"></a>
</span><span id="__span-65-59"><a id="__codelineno-65-59" name="__codelineno-65-59" href="#__codelineno-65-59"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">3:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">adding</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-65-60"><a id="__codelineno-65-60" name="__codelineno-65-60" href="#__codelineno-65-60"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-65-61"><a id="__codelineno-65-61" name="__codelineno-65-61" href="#__codelineno-65-61"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output3</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-65-62"><a id="__codelineno-65-62" name="__codelineno-65-62" href="#__codelineno-65-62"></a>
</span><span id="__span-65-63"><a id="__codelineno-65-63" name="__codelineno-65-63" href="#__codelineno-65-63"></a><span class="nn">...</span>
</span></code></pre></div>
<h6 id="playbook-execution_2"><a class="toclink" href="../../ansible-asa-og/#playbook-execution_2">Playbook Execution</a></h6>
<p>Task 1: Reports OK, as there are no changes here - as expected
Task 2: Also reports OK, as there should be no changes - as expected
Task 3: Creates the port-object to be used
Debug 1: Shows no changes
Debug 2: Shows no changes
Debug 3: Shows that the changed flag is set to <code>True</code> and that the changes sent
to the device creates the port object</p>
<iframe width="853" height="480" src="https://www.youtube.com/embed/X7mH-x9ui28?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-66-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-66-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-66-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-66-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-66-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-66-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-66-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-66-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-66-10">10</a></span>
<span class="normal"><a href="#__codelineno-66-11">11</a></span>
<span class="normal"><a href="#__codelineno-66-12">12</a></span>
<span class="normal"><a href="#__codelineno-66-13">13</a></span>
<span class="normal"><a href="#__codelineno-66-14">14</a></span>
<span class="normal"><a href="#__codelineno-66-15">15</a></span>
<span class="normal"><a href="#__codelineno-66-16">16</a></span>
<span class="normal"><a href="#__codelineno-66-17">17</a></span>
<span class="normal"><a href="#__codelineno-66-18">18</a></span>
<span class="normal"><a href="#__codelineno-66-19">19</a></span>
<span class="normal"><a href="#__codelineno-66-20">20</a></span>
<span class="normal"><a href="#__codelineno-66-21">21</a></span>
<span class="normal"><a href="#__codelineno-66-22">22</a></span>
<span class="normal"><a href="#__codelineno-66-23">23</a></span>
<span class="normal"><a href="#__codelineno-66-24">24</a></span>
<span class="normal"><a href="#__codelineno-66-25">25</a></span>
<span class="normal"><a href="#__codelineno-66-26">26</a></span>
<span class="normal"><a href="#__codelineno-66-27">27</a></span>
<span class="normal"><a href="#__codelineno-66-28">28</a></span>
<span class="normal"><a href="#__codelineno-66-29">29</a></span>
<span class="normal"><a href="#__codelineno-66-30">30</a></span>
<span class="normal"><a href="#__codelineno-66-31">31</a></span>
<span class="normal"><a href="#__codelineno-66-32">32</a></span>
<span class="normal"><a href="#__codelineno-66-33">33</a></span>
<span class="normal"><a href="#__codelineno-66-34">34</a></span>
<span class="normal"><a href="#__codelineno-66-35">35</a></span>
<span class="normal"><a href="#__codelineno-66-36">36</a></span>
<span class="normal"><a href="#__codelineno-66-37">37</a></span>
<span class="normal"><a href="#__codelineno-66-38">38</a></span>
<span class="normal"><a href="#__codelineno-66-39">39</a></span>
<span class="normal"><a href="#__codelineno-66-40">40</a></span>
<span class="normal"><a href="#__codelineno-66-41">41</a></span>
<span class="normal"><a href="#__codelineno-66-42">42</a></span>
<span class="normal"><a href="#__codelineno-66-43">43</a></span>
<span class="normal"><a href="#__codelineno-66-44">44</a></span>
<span class="normal"><a href="#__codelineno-66-45">45</a></span>
<span class="normal"><a href="#__codelineno-66-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [ASA OG Working] **********************************************************</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2"></a>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set RFC1918 Object Group] ****************************************</span>
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5"></a>
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set External DNS/NTP Providers Object Group] *********************</span>
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8"></a>
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 3</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add Port Group] **************************************************</span>
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11"></a>
</span><span id="__span-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of RFC1918 Object Group] ***************************</span>
</span><span id="__span-66-13"><a id="__codelineno-66-13" name="__codelineno-66-13"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-66-14"><a id="__codelineno-66-14" name="__codelineno-66-14"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-66-15"><a id="__codelineno-66-15" name="__codelineno-66-15"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-66-16"><a id="__codelineno-66-16" name="__codelineno-66-16"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[],</span>
</span><span id="__span-66-17"><a id="__codelineno-66-17" name="__codelineno-66-17"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-66-18"><a id="__codelineno-66-18" name="__codelineno-66-18"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-66-19"><a id="__codelineno-66-19" name="__codelineno-66-19"></a><span class="err">}</span>
</span><span id="__span-66-20"><a id="__codelineno-66-20" name="__codelineno-66-20"></a>
</span><span id="__span-66-21"><a id="__codelineno-66-21" name="__codelineno-66-21"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of External DNS Group] *****************************</span>
</span><span id="__span-66-22"><a id="__codelineno-66-22" name="__codelineno-66-22"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-66-23"><a id="__codelineno-66-23" name="__codelineno-66-23"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-66-24"><a id="__codelineno-66-24" name="__codelineno-66-24"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-66-25"><a id="__codelineno-66-25" name="__codelineno-66-25"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[],</span>
</span><span id="__span-66-26"><a id="__codelineno-66-26" name="__codelineno-66-26"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-66-27"><a id="__codelineno-66-27" name="__codelineno-66-27"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-66-28"><a id="__codelineno-66-28" name="__codelineno-66-28"></a><span class="err">}</span>
</span><span id="__span-66-29"><a id="__codelineno-66-29" name="__codelineno-66-29"></a>
</span><span id="__span-66-30"><a id="__codelineno-66-30" name="__codelineno-66-30"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG 3</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of adding Port Group] ******************************</span>
</span><span id="__span-66-31"><a id="__codelineno-66-31" name="__codelineno-66-31"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-66-32"><a id="__codelineno-66-32" name="__codelineno-66-32"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-66-33"><a id="__codelineno-66-33" name="__codelineno-66-33"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-66-34"><a id="__codelineno-66-34" name="__codelineno-66-34"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-66-35"><a id="__codelineno-66-35" name="__codelineno-66-35"></a><span class="w">            </span><span class="s">&quot;object-group</span><span class="nv"> </span><span class="s">service</span><span class="nv"> </span><span class="s">SVC_OBJ_DNS_NTP</span><span class="nv"> </span><span class="s">udp&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-66-36"><a id="__codelineno-66-36" name="__codelineno-66-36"></a><span class="w">            </span><span class="s">&quot;port-object</span><span class="nv"> </span><span class="s">eq</span><span class="nv"> </span><span class="s">53&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-66-37"><a id="__codelineno-66-37" name="__codelineno-66-37"></a><span class="w">            </span><span class="s">&quot;port-object</span><span class="nv"> </span><span class="s">eq</span><span class="nv"> </span><span class="s">123&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-66-38"><a id="__codelineno-66-38" name="__codelineno-66-38"></a><span class="w">            </span><span class="s">&quot;description</span><span class="nv"> </span><span class="s">DNS</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">NTP</span><span class="nv"> </span><span class="s">ports&quot;</span>
</span><span id="__span-66-39"><a id="__codelineno-66-39" name="__codelineno-66-39"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-66-40"><a id="__codelineno-66-40" name="__codelineno-66-40"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-66-41"><a id="__codelineno-66-41" name="__codelineno-66-41"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-66-42"><a id="__codelineno-66-42" name="__codelineno-66-42"></a><span class="err">}</span>
</span><span id="__span-66-43"><a id="__codelineno-66-43" name="__codelineno-66-43"></a>
</span><span id="__span-66-44"><a id="__codelineno-66-44" name="__codelineno-66-44"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-66-45"><a id="__codelineno-66-45" name="__codelineno-66-45"></a><span class="nt">asa1                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=6    changed=1    unreachable=0    failed=0    s</span>
</span><span id="__span-66-46"><a id="__codelineno-66-46" name="__codelineno-66-46"></a><span class="l l-Scalar l-Scalar-Plain">kipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<h6 id="changes-on-the-asa"><a class="toclink" href="../../ansible-asa-og/#changes-on-the-asa">Changes on the ASA</a></h6>
<p>And as we are use to seeing, we see the update on the ASA itself:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-67-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-67-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-67-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-67-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-67-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-67-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-67-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-67-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-67-10">10</a></span>
<span class="normal"><a href="#__codelineno-67-11">11</a></span>
<span class="normal"><a href="#__codelineno-67-12">12</a></span>
<span class="normal"><a href="#__codelineno-67-13">13</a></span>
<span class="normal"><a href="#__codelineno-67-14">14</a></span>
<span class="normal"><a href="#__codelineno-67-15">15</a></span>
<span class="normal"><a href="#__codelineno-67-16">16</a></span>
<span class="normal"><a href="#__codelineno-67-17">17</a></span>
<span class="normal"><a href="#__codelineno-67-18">18</a></span>
<span class="normal"><a href="#__codelineno-67-19">19</a></span>
<span class="normal"><a href="#__codelineno-67-20">20</a></span>
<span class="normal"><a href="#__codelineno-67-21">21</a></span>
<span class="normal"><a href="#__codelineno-67-22">22</a></span>
<span class="normal"><a href="#__codelineno-67-23">23</a></span>
<span class="normal"><a href="#__codelineno-67-24">24</a></span>
<span class="normal"><a href="#__codelineno-67-25">25</a></span>
<span class="normal"><a href="#__codelineno-67-26">26</a></span>
<span class="normal"><a href="#__codelineno-67-27">27</a></span>
<span class="normal"><a href="#__codelineno-67-28">28</a></span>
<span class="normal"><a href="#__codelineno-67-29">29</a></span>
<span class="normal"><a href="#__codelineno-67-30">30</a></span>
<span class="normal"><a href="#__codelineno-67-31">31</a></span>
<span class="normal"><a href="#__codelineno-67-32">32</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show object-group</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2"></a><span class="l l-Scalar l-Scalar-Plain">object-group network RFC1918_Networks</span>
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 10.0.0.0 255.0.0.0</span>
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 172.16.0.0 255.240.0.0</span>
</span><span id="__span-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 192.168.0.0 255.255.0.0</span>
</span><span id="__span-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7"></a><span class="l l-Scalar l-Scalar-Plain">object-group network EXTERNAL_DNS_NTP</span>
</span><span id="__span-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 1.1.1.1</span>
</span><span id="__span-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 8.8.8.8</span>
</span><span id="__span-67-11"><a id="__codelineno-67-11" name="__codelineno-67-11"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 9.9.9.9</span>
</span><span id="__span-67-12"><a id="__codelineno-67-12" name="__codelineno-67-12"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.222.222</span>
</span><span id="__span-67-13"><a id="__codelineno-67-13" name="__codelineno-67-13"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.220.220</span>
</span><span id="__span-67-14"><a id="__codelineno-67-14" name="__codelineno-67-14"></a><span class="l l-Scalar l-Scalar-Plain">fw01#</span>
</span><span id="__span-67-15"><a id="__codelineno-67-15" name="__codelineno-67-15"></a><span class="l l-Scalar l-Scalar-Plain">fw01#</span>
</span><span id="__span-67-16"><a id="__codelineno-67-16" name="__codelineno-67-16"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show object-group</span>
</span><span id="__span-67-17"><a id="__codelineno-67-17" name="__codelineno-67-17"></a><span class="l l-Scalar l-Scalar-Plain">object-group network RFC1918_Networks</span>
</span><span id="__span-67-18"><a id="__codelineno-67-18" name="__codelineno-67-18"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-67-19"><a id="__codelineno-67-19" name="__codelineno-67-19"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 10.0.0.0 255.0.0.0</span>
</span><span id="__span-67-20"><a id="__codelineno-67-20" name="__codelineno-67-20"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 172.16.0.0 255.240.0.0</span>
</span><span id="__span-67-21"><a id="__codelineno-67-21" name="__codelineno-67-21"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 192.168.0.0 255.255.0.0</span>
</span><span id="__span-67-22"><a id="__codelineno-67-22" name="__codelineno-67-22"></a><span class="l l-Scalar l-Scalar-Plain">object-group network EXTERNAL_DNS_NTP</span>
</span><span id="__span-67-23"><a id="__codelineno-67-23" name="__codelineno-67-23"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-67-24"><a id="__codelineno-67-24" name="__codelineno-67-24"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 1.1.1.1</span>
</span><span id="__span-67-25"><a id="__codelineno-67-25" name="__codelineno-67-25"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 8.8.8.8</span>
</span><span id="__span-67-26"><a id="__codelineno-67-26" name="__codelineno-67-26"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 9.9.9.9</span>
</span><span id="__span-67-27"><a id="__codelineno-67-27" name="__codelineno-67-27"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.222.222</span>
</span><span id="__span-67-28"><a id="__codelineno-67-28" name="__codelineno-67-28"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.220.220</span>
</span><span id="__span-67-29"><a id="__codelineno-67-29" name="__codelineno-67-29"></a><span class="l l-Scalar l-Scalar-Plain">object-group service SVC_OBJ_DNS_NTP udp</span>
</span><span id="__span-67-30"><a id="__codelineno-67-30" name="__codelineno-67-30"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-67-31"><a id="__codelineno-67-31" name="__codelineno-67-31"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq domain</span>
</span><span id="__span-67-32"><a id="__codelineno-67-32" name="__codelineno-67-32"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq ntp</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="removing-groups"><a class="toclink" href="../../ansible-asa-og/#removing-groups">Removing groups</a></h4>
<p>The last thing to demo is the <code>state: absent</code> of the module. What I have seen in
testing at the moment is that the module does not delete the group all together,
but removes the object members. Let's take a look at this in action.</p>
<h5 id="setup-deletion"><a class="toclink" href="../../ansible-asa-og/#setup-deletion">Setup - Deletion</a></h5>
<p>First I went ahead and created a new group (using Ansible of course). This is
the old group for DNS that is no longer being used. So we should clean that up
of course. <strong>This module only deletes items from within the object-group, it
will NOT remove an entire object-group</strong>.  </p>
<p>The firewall configuration has the following for object groups:  </p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-68-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-68-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-68-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-68-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-68-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-68-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-68-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-68-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-68-10">10</a></span>
<span class="normal"><a href="#__codelineno-68-11">11</a></span>
<span class="normal"><a href="#__codelineno-68-12">12</a></span>
<span class="normal"><a href="#__codelineno-68-13">13</a></span>
<span class="normal"><a href="#__codelineno-68-14">14</a></span>
<span class="normal"><a href="#__codelineno-68-15">15</a></span>
<span class="normal"><a href="#__codelineno-68-16">16</a></span>
<span class="normal"><a href="#__codelineno-68-17">17</a></span>
<span class="normal"><a href="#__codelineno-68-18">18</a></span>
<span class="normal"><a href="#__codelineno-68-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1"></a><span class="l l-Scalar l-Scalar-Plain">object-group network RFC1918_Networks</span>
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 10.0.0.0 255.0.0.0</span>
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 172.16.0.0 255.240.0.0</span>
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 192.168.0.0 255.255.0.0</span>
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6"></a><span class="l l-Scalar l-Scalar-Plain">object-group network EXTERNAL_DNS_NTP</span>
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 1.1.1.1</span>
</span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 8.8.8.8</span>
</span><span id="__span-68-10"><a id="__codelineno-68-10" name="__codelineno-68-10"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 9.9.9.9</span>
</span><span id="__span-68-11"><a id="__codelineno-68-11" name="__codelineno-68-11"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.222.222</span>
</span><span id="__span-68-12"><a id="__codelineno-68-12" name="__codelineno-68-12"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.220.220</span>
</span><span id="__span-68-13"><a id="__codelineno-68-13" name="__codelineno-68-13"></a><span class="l l-Scalar l-Scalar-Plain">object-group service SVC_OBJ_DNS_NTP udp</span>
</span><span id="__span-68-14"><a id="__codelineno-68-14" name="__codelineno-68-14"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-68-15"><a id="__codelineno-68-15" name="__codelineno-68-15"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq domain</span>
</span><span id="__span-68-16"><a id="__codelineno-68-16" name="__codelineno-68-16"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq ntp</span>
</span><span id="__span-68-17"><a id="__codelineno-68-17" name="__codelineno-68-17"></a><span class="l l-Scalar l-Scalar-Plain">object-group service DNS_ONLY udp</span>
</span><span id="__span-68-18"><a id="__codelineno-68-18" name="__codelineno-68-18"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS ports</span>
</span><span id="__span-68-19"><a id="__codelineno-68-19" name="__codelineno-68-19"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq domain</span>
</span></code></pre></div></td></tr></table></div>
<h5 id="task-created-absent-state"><a class="toclink" href="../../ansible-asa-og/#task-created-absent-state">Task Created - Absent state</a></h5>
<p>Here is the task with the state changed from <code>present</code> to <code>absent</code>:  </p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">4:</span><span class="nv"> </span><span class="s">Remove</span><span class="nv"> </span><span class="s">Extra</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS_ONLY</span>
</span><span id="__span-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
</span><span id="__span-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">domain</span>
</span><span id="__span-69-9"><a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output4</span>
</span></code></pre></div>
<h5 id="playbook-execution-absent-state-for-an-object-group"><a class="toclink" href="../../ansible-asa-og/#playbook-execution-absent-state-for-an-object-group">Playbook Execution - Absent state for an object group</a></h5>
<p>Task 1 - 3: These are the idempotent adds. There is not any changes being made,
so these remain OK.
Task 4: Removes the particular item from within a group. So you will need to
call out all of the objects that you want to have missing from here. The next
task will take a look at another helpful state of <strong>replace</strong>.  </p>
<iframe width="853" height="480" src="https://www.youtube.com/embed/ucKFWlirHjE?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-70-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-70-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-70-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-70-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-70-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-70-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-70-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-70-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-70-10">10</a></span>
<span class="normal"><a href="#__codelineno-70-11">11</a></span>
<span class="normal"><a href="#__codelineno-70-12">12</a></span>
<span class="normal"><a href="#__codelineno-70-13">13</a></span>
<span class="normal"><a href="#__codelineno-70-14">14</a></span>
<span class="normal"><a href="#__codelineno-70-15">15</a></span>
<span class="normal"><a href="#__codelineno-70-16">16</a></span>
<span class="normal"><a href="#__codelineno-70-17">17</a></span>
<span class="normal"><a href="#__codelineno-70-18">18</a></span>
<span class="normal"><a href="#__codelineno-70-19">19</a></span>
<span class="normal"><a href="#__codelineno-70-20">20</a></span>
<span class="normal"><a href="#__codelineno-70-21">21</a></span>
<span class="normal"><a href="#__codelineno-70-22">22</a></span>
<span class="normal"><a href="#__codelineno-70-23">23</a></span>
<span class="normal"><a href="#__codelineno-70-24">24</a></span>
<span class="normal"><a href="#__codelineno-70-25">25</a></span>
<span class="normal"><a href="#__codelineno-70-26">26</a></span>
<span class="normal"><a href="#__codelineno-70-27">27</a></span>
<span class="normal"><a href="#__codelineno-70-28">28</a></span>
<span class="normal"><a href="#__codelineno-70-29">29</a></span>
<span class="normal"><a href="#__codelineno-70-30">30</a></span>
<span class="normal"><a href="#__codelineno-70-31">31</a></span>
<span class="normal"><a href="#__codelineno-70-32">32</a></span>
<span class="normal"><a href="#__codelineno-70-33">33</a></span>
<span class="normal"><a href="#__codelineno-70-34">34</a></span>
<span class="normal"><a href="#__codelineno-70-35">35</a></span>
<span class="normal"><a href="#__codelineno-70-36">36</a></span>
<span class="normal"><a href="#__codelineno-70-37">37</a></span>
<span class="normal"><a href="#__codelineno-70-38">38</a></span>
<span class="normal"><a href="#__codelineno-70-39">39</a></span>
<span class="normal"><a href="#__codelineno-70-40">40</a></span>
<span class="normal"><a href="#__codelineno-70-41">41</a></span>
<span class="normal"><a href="#__codelineno-70-42">42</a></span>
<span class="normal"><a href="#__codelineno-70-43">43</a></span>
<span class="normal"><a href="#__codelineno-70-44">44</a></span>
<span class="normal"><a href="#__codelineno-70-45">45</a></span>
<span class="normal"><a href="#__codelineno-70-46">46</a></span>
<span class="normal"><a href="#__codelineno-70-47">47</a></span>
<span class="normal"><a href="#__codelineno-70-48">48</a></span>
<span class="normal"><a href="#__codelineno-70-49">49</a></span>
<span class="normal"><a href="#__codelineno-70-50">50</a></span>
<span class="normal"><a href="#__codelineno-70-51">51</a></span>
<span class="normal"><a href="#__codelineno-70-52">52</a></span>
<span class="normal"><a href="#__codelineno-70-53">53</a></span>
<span class="normal"><a href="#__codelineno-70-54">54</a></span>
<span class="normal"><a href="#__codelineno-70-55">55</a></span>
<span class="normal"><a href="#__codelineno-70-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [ASA OG Working] **********************************************************</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2"></a>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set RFC1918 Object Group] ****************************************</span>
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5"></a>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set External DNS/NTP Providers Object Group] *********************</span>
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8"></a>
</span><span id="__span-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 3</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Add Port Group] **************************************************</span>
</span><span id="__span-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11"></a>
</span><span id="__span-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12"></a><span class="l l-Scalar l-Scalar-Plain">TASK [TASK 4</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Remove Extra Group] **********************************************</span>
</span><span id="__span-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13"></a><span class="nt">changed</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span>
</span><span id="__span-70-14"><a id="__codelineno-70-14" name="__codelineno-70-14"></a>
</span><span id="__span-70-15"><a id="__codelineno-70-15" name="__codelineno-70-15"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG 1</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of RFC1918 Object Group] ***************************</span>
</span><span id="__span-70-16"><a id="__codelineno-70-16" name="__codelineno-70-16"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-70-17"><a id="__codelineno-70-17" name="__codelineno-70-17"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-70-18"><a id="__codelineno-70-18" name="__codelineno-70-18"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-70-19"><a id="__codelineno-70-19" name="__codelineno-70-19"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[],</span>
</span><span id="__span-70-20"><a id="__codelineno-70-20" name="__codelineno-70-20"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-70-21"><a id="__codelineno-70-21" name="__codelineno-70-21"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-70-22"><a id="__codelineno-70-22" name="__codelineno-70-22"></a><span class="err">}</span>
</span><span id="__span-70-23"><a id="__codelineno-70-23" name="__codelineno-70-23"></a>
</span><span id="__span-70-24"><a id="__codelineno-70-24" name="__codelineno-70-24"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG 2</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of External DNS Group] *****************************</span>
</span><span id="__span-70-25"><a id="__codelineno-70-25" name="__codelineno-70-25"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-70-26"><a id="__codelineno-70-26" name="__codelineno-70-26"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-70-27"><a id="__codelineno-70-27" name="__codelineno-70-27"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-70-28"><a id="__codelineno-70-28" name="__codelineno-70-28"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[],</span>
</span><span id="__span-70-29"><a id="__codelineno-70-29" name="__codelineno-70-29"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-70-30"><a id="__codelineno-70-30" name="__codelineno-70-30"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-70-31"><a id="__codelineno-70-31" name="__codelineno-70-31"></a><span class="err">}</span>
</span><span id="__span-70-32"><a id="__codelineno-70-32" name="__codelineno-70-32"></a>
</span><span id="__span-70-33"><a id="__codelineno-70-33" name="__codelineno-70-33"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG 3</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of adding Port Group] ******************************</span>
</span><span id="__span-70-34"><a id="__codelineno-70-34" name="__codelineno-70-34"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-70-35"><a id="__codelineno-70-35" name="__codelineno-70-35"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-70-36"><a id="__codelineno-70-36" name="__codelineno-70-36"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
</span><span id="__span-70-37"><a id="__codelineno-70-37" name="__codelineno-70-37"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[],</span>
</span><span id="__span-70-38"><a id="__codelineno-70-38" name="__codelineno-70-38"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-70-39"><a id="__codelineno-70-39" name="__codelineno-70-39"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-70-40"><a id="__codelineno-70-40" name="__codelineno-70-40"></a><span class="err">}</span>
</span><span id="__span-70-41"><a id="__codelineno-70-41" name="__codelineno-70-41"></a>
</span><span id="__span-70-42"><a id="__codelineno-70-42" name="__codelineno-70-42"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG 4</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Print output of removing extra Port Group] **********************</span>
</span><span id="__span-70-43"><a id="__codelineno-70-43" name="__codelineno-70-43"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">asa1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-70-44"><a id="__codelineno-70-44" name="__codelineno-70-44"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-70-45"><a id="__codelineno-70-45" name="__codelineno-70-45"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
</span><span id="__span-70-46"><a id="__codelineno-70-46" name="__codelineno-70-46"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-70-47"><a id="__codelineno-70-47" name="__codelineno-70-47"></a><span class="w">            </span><span class="s">&quot;object-group</span><span class="nv"> </span><span class="s">service</span><span class="nv"> </span><span class="s">DNS_ONLY</span><span class="nv"> </span><span class="s">udp&quot;</span><span class="p p-Indicator">,</span>
</span><span id="__span-70-48"><a id="__codelineno-70-48" name="__codelineno-70-48"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">port-object</span><span class="nv"> </span><span class="s">eq</span><span class="nv"> </span><span class="s">domain&quot;</span>
</span><span id="__span-70-49"><a id="__codelineno-70-49" name="__codelineno-70-49"></a><span class="w">        </span><span class="p p-Indicator">],</span>
</span><span id="__span-70-50"><a id="__codelineno-70-50" name="__codelineno-70-50"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-70-51"><a id="__codelineno-70-51" name="__codelineno-70-51"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-70-52"><a id="__codelineno-70-52" name="__codelineno-70-52"></a><span class="err">}</span>
</span><span id="__span-70-53"><a id="__codelineno-70-53" name="__codelineno-70-53"></a>
</span><span id="__span-70-54"><a id="__codelineno-70-54" name="__codelineno-70-54"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-70-55"><a id="__codelineno-70-55" name="__codelineno-70-55"></a><span class="nt">asa1                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=8    changed=1    unreachable=0    failed=0    s</span>
</span><span id="__span-70-56"><a id="__codelineno-70-56" name="__codelineno-70-56"></a><span class="l l-Scalar l-Scalar-Plain">kipped=0    rescued=0    ignored=0</span>
</span></code></pre></div></td></tr></table></div>
<h6 id="firewall-after"><a class="toclink" href="../../ansible-asa-og/#firewall-after">Firewall After</a></h6>
<p>Here we see that the port object that we asked to remove is gone. If there were
other object items in the object-group they would still remain.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-71-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-71-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-71-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-71-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-71-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-71-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-71-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-71-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-71-10">10</a></span>
<span class="normal"><a href="#__codelineno-71-11">11</a></span>
<span class="normal"><a href="#__codelineno-71-12">12</a></span>
<span class="normal"><a href="#__codelineno-71-13">13</a></span>
<span class="normal"><a href="#__codelineno-71-14">14</a></span>
<span class="normal"><a href="#__codelineno-71-15">15</a></span>
<span class="normal"><a href="#__codelineno-71-16">16</a></span>
<span class="normal"><a href="#__codelineno-71-17">17</a></span>
<span class="normal"><a href="#__codelineno-71-18">18</a></span>
<span class="normal"><a href="#__codelineno-71-19">19</a></span>
<span class="normal"><a href="#__codelineno-71-20">20</a></span>
<span class="normal"><a href="#__codelineno-71-21">21</a></span>
<span class="normal"><a href="#__codelineno-71-22">22</a></span>
<span class="normal"><a href="#__codelineno-71-23">23</a></span>
<span class="normal"><a href="#__codelineno-71-24">24</a></span>
<span class="normal"><a href="#__codelineno-71-25">25</a></span>
<span class="normal"><a href="#__codelineno-71-26">26</a></span>
<span class="normal"><a href="#__codelineno-71-27">27</a></span>
<span class="normal"><a href="#__codelineno-71-28">28</a></span>
<span class="normal"><a href="#__codelineno-71-29">29</a></span>
<span class="normal"><a href="#__codelineno-71-30">30</a></span>
<span class="normal"><a href="#__codelineno-71-31">31</a></span>
<span class="normal"><a href="#__codelineno-71-32">32</a></span>
<span class="normal"><a href="#__codelineno-71-33">33</a></span>
<span class="normal"><a href="#__codelineno-71-34">34</a></span>
<span class="normal"><a href="#__codelineno-71-35">35</a></span>
<span class="normal"><a href="#__codelineno-71-36">36</a></span>
<span class="normal"><a href="#__codelineno-71-37">37</a></span>
<span class="normal"><a href="#__codelineno-71-38">38</a></span>
<span class="normal"><a href="#__codelineno-71-39">39</a></span>
<span class="normal"><a href="#__codelineno-71-40">40</a></span>
<span class="normal"><a href="#__codelineno-71-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show object-group</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2"></a><span class="l l-Scalar l-Scalar-Plain">object-group network RFC1918_Networks</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 10.0.0.0 255.0.0.0</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 172.16.0.0 255.240.0.0</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 192.168.0.0 255.255.0.0</span>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7"></a><span class="l l-Scalar l-Scalar-Plain">object-group network EXTERNAL_DNS_NTP</span>
</span><span id="__span-71-8"><a id="__codelineno-71-8" name="__codelineno-71-8"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-71-9"><a id="__codelineno-71-9" name="__codelineno-71-9"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 1.1.1.1</span>
</span><span id="__span-71-10"><a id="__codelineno-71-10" name="__codelineno-71-10"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 8.8.8.8</span>
</span><span id="__span-71-11"><a id="__codelineno-71-11" name="__codelineno-71-11"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 9.9.9.9</span>
</span><span id="__span-71-12"><a id="__codelineno-71-12" name="__codelineno-71-12"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.222.222</span>
</span><span id="__span-71-13"><a id="__codelineno-71-13" name="__codelineno-71-13"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.220.220</span>
</span><span id="__span-71-14"><a id="__codelineno-71-14" name="__codelineno-71-14"></a><span class="l l-Scalar l-Scalar-Plain">object-group service SVC_OBJ_DNS_NTP udp</span>
</span><span id="__span-71-15"><a id="__codelineno-71-15" name="__codelineno-71-15"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-71-16"><a id="__codelineno-71-16" name="__codelineno-71-16"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq domain</span>
</span><span id="__span-71-17"><a id="__codelineno-71-17" name="__codelineno-71-17"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq ntp</span>
</span><span id="__span-71-18"><a id="__codelineno-71-18" name="__codelineno-71-18"></a><span class="l l-Scalar l-Scalar-Plain">object-group service DNS_ONLY udp</span>
</span><span id="__span-71-19"><a id="__codelineno-71-19" name="__codelineno-71-19"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS ports</span>
</span><span id="__span-71-20"><a id="__codelineno-71-20" name="__codelineno-71-20"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq domain</span>
</span><span id="__span-71-21"><a id="__codelineno-71-21" name="__codelineno-71-21"></a><span class="l l-Scalar l-Scalar-Plain">fw01#</span>
</span><span id="__span-71-22"><a id="__codelineno-71-22" name="__codelineno-71-22"></a><span class="l l-Scalar l-Scalar-Plain">fw01# ! AFTER THE CHANGE</span>
</span><span id="__span-71-23"><a id="__codelineno-71-23" name="__codelineno-71-23"></a><span class="l l-Scalar l-Scalar-Plain">fw01# show object-group</span>
</span><span id="__span-71-24"><a id="__codelineno-71-24" name="__codelineno-71-24"></a><span class="l l-Scalar l-Scalar-Plain">object-group network RFC1918_Networks</span>
</span><span id="__span-71-25"><a id="__codelineno-71-25" name="__codelineno-71-25"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-71-26"><a id="__codelineno-71-26" name="__codelineno-71-26"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 10.0.0.0 255.0.0.0</span>
</span><span id="__span-71-27"><a id="__codelineno-71-27" name="__codelineno-71-27"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 172.16.0.0 255.240.0.0</span>
</span><span id="__span-71-28"><a id="__codelineno-71-28" name="__codelineno-71-28"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object 192.168.0.0 255.255.0.0</span>
</span><span id="__span-71-29"><a id="__codelineno-71-29" name="__codelineno-71-29"></a><span class="l l-Scalar l-Scalar-Plain">object-group network EXTERNAL_DNS_NTP</span>
</span><span id="__span-71-30"><a id="__codelineno-71-30" name="__codelineno-71-30"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-71-31"><a id="__codelineno-71-31" name="__codelineno-71-31"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 1.1.1.1</span>
</span><span id="__span-71-32"><a id="__codelineno-71-32" name="__codelineno-71-32"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 8.8.8.8</span>
</span><span id="__span-71-33"><a id="__codelineno-71-33" name="__codelineno-71-33"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 9.9.9.9</span>
</span><span id="__span-71-34"><a id="__codelineno-71-34" name="__codelineno-71-34"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.222.222</span>
</span><span id="__span-71-35"><a id="__codelineno-71-35" name="__codelineno-71-35"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object host 208.67.220.220</span>
</span><span id="__span-71-36"><a id="__codelineno-71-36" name="__codelineno-71-36"></a><span class="l l-Scalar l-Scalar-Plain">object-group service SVC_OBJ_DNS_NTP udp</span>
</span><span id="__span-71-37"><a id="__codelineno-71-37" name="__codelineno-71-37"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-71-38"><a id="__codelineno-71-38" name="__codelineno-71-38"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq domain</span>
</span><span id="__span-71-39"><a id="__codelineno-71-39" name="__codelineno-71-39"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object eq ntp</span>
</span><span id="__span-71-40"><a id="__codelineno-71-40" name="__codelineno-71-40"></a><span class="l l-Scalar l-Scalar-Plain">object-group service DNS_ONLY udp</span>
</span><span id="__span-71-41"><a id="__codelineno-71-41" name="__codelineno-71-41"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS ports</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="state-replace"><a class="toclink" href="../../ansible-asa-og/#state-replace">State: Replace</a></h4>
<p>Originally this was not on the radar to include in this post, but I have found
it very helpful. What <code>replace</code> will do for you is allow you to set this as the
"standard". So if there are extraneous items in the object group <code>replace</code> will
remove anything extra. If there are any items missing from the object group it
will add them in.  </p>
<h5 id="tasks-replace"><a class="toclink" href="../../ansible-asa-og/#tasks-replace">Tasks - Replace</a></h5>
<p>I'm going to modify <em>Task 3</em> from earlier to add some extra ports to the
port-group and change <em>domain</em> to <em>dns</em> even though <em>domain</em> is the proper ASA
shorthand for port 53.  The two tasks are now this:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">3:</span><span class="nv"> </span><span class="s">Add</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SVC_OBJ_DNS_NTP</span>
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;ntp&quot;</span>
</span><span id="__span-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
</span><span id="__span-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5353&quot;</span>
</span><span id="__span-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;553&quot;</span>
</span><span id="__span-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;353&quot;</span>
</span><span id="__span-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14" href="#__codelineno-72-14"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output3</span>
</span><span id="__span-72-15"><a id="__codelineno-72-15" name="__codelineno-72-15" href="#__codelineno-72-15"></a>
</span><span id="__span-72-16"><a id="__codelineno-72-16" name="__codelineno-72-16" href="#__codelineno-72-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">5:</span><span class="nv"> </span><span class="s">Fix</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">DNS</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-72-17"><a id="__codelineno-72-17" name="__codelineno-72-17" href="#__codelineno-72-17"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-72-18"><a id="__codelineno-72-18" name="__codelineno-72-18" href="#__codelineno-72-18"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SVC_OBJ_DNS_NTP</span>
</span><span id="__span-72-19"><a id="__codelineno-72-19" name="__codelineno-72-19" href="#__codelineno-72-19"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-72-20"><a id="__codelineno-72-20" name="__codelineno-72-20" href="#__codelineno-72-20"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replace</span>
</span><span id="__span-72-21"><a id="__codelineno-72-21" name="__codelineno-72-21" href="#__codelineno-72-21"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-72-22"><a id="__codelineno-72-22" name="__codelineno-72-22" href="#__codelineno-72-22"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-72-23"><a id="__codelineno-72-23" name="__codelineno-72-23" href="#__codelineno-72-23"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-72-24"><a id="__codelineno-72-24" name="__codelineno-72-24" href="#__codelineno-72-24"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;domain&quot;</span>
</span><span id="__span-72-25"><a id="__codelineno-72-25" name="__codelineno-72-25" href="#__codelineno-72-25"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;ntp&quot;</span>
</span><span id="__span-72-26"><a id="__codelineno-72-26" name="__codelineno-72-26" href="#__codelineno-72-26"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output5</span>
</span></code></pre></div>
<h5 id="replace-task-execution"><a class="toclink" href="../../ansible-asa-og/#replace-task-execution">Replace Task Execution</a></h5>
<p>Let's get right to looking at the execution based on the summary above.  </p>
<h6 id="firewall-before"><a class="toclink" href="../../ansible-asa-og/#firewall-before">Firewall Before</a></h6>
<p>Here we see that the object group <strong>SVC_OBJ_DNS_NTP</strong> has a lot more entries
than one should expect.  </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>fw01#<span class="w"> </span>show<span class="w"> </span>object-group
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>object-group<span class="w"> </span>network<span class="w"> </span>RFC1918_Networks
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="w"> </span>description:<span class="w"> </span>RFC1918<span class="w"> </span>Local<span class="w"> </span>Networks
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="w"> </span>network-object<span class="w"> </span><span class="m">10</span>.0.0.0<span class="w"> </span><span class="m">255</span>.0.0.0
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="w"> </span>network-object<span class="w"> </span><span class="m">172</span>.16.0.0<span class="w"> </span><span class="m">255</span>.240.0.0
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a><span class="w"> </span>network-object<span class="w"> </span><span class="m">192</span>.168.0.0<span class="w"> </span><span class="m">255</span>.255.0.0
</span><span id="__span-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a>object-group<span class="w"> </span>network<span class="w"> </span>EXTERNAL_DNS_NTP
</span><span id="__span-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a><span class="w"> </span>description:<span class="w"> </span>External<span class="w"> </span>DNS<span class="w"> </span>Providers<span class="w"> </span><span class="o">(</span>CloudFlare,<span class="w"> </span>Google,<span class="w"> </span>Quad9,<span class="w"> </span>Umbrella<span class="o">)</span>
</span><span id="__span-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a><span class="w"> </span>network-object<span class="w"> </span>host<span class="w"> </span><span class="m">1</span>.1.1.1
</span><span id="__span-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a><span class="w"> </span>network-object<span class="w"> </span>host<span class="w"> </span><span class="m">8</span>.8.8.8
</span><span id="__span-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a><span class="w"> </span>network-object<span class="w"> </span>host<span class="w"> </span><span class="m">9</span>.9.9.9
</span><span id="__span-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a><span class="w"> </span>network-object<span class="w"> </span>host<span class="w"> </span><span class="m">208</span>.67.222.222
</span><span id="__span-73-13"><a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a><span class="w"> </span>network-object<span class="w"> </span>host<span class="w"> </span><span class="m">208</span>.67.220.220
</span><span id="__span-73-14"><a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a>object-group<span class="w"> </span>service<span class="w"> </span>SVC_OBJ_DNS_NTP<span class="w"> </span>udp
</span><span id="__span-73-15"><a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a><span class="w"> </span>description:<span class="w"> </span>DNS<span class="w"> </span>and<span class="w"> </span>NTP<span class="w"> </span>ports
</span><span id="__span-73-16"><a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a><span class="w"> </span>port-object<span class="w"> </span>eq<span class="w"> </span>domain
</span><span id="__span-73-17"><a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a><span class="w"> </span>port-object<span class="w"> </span>eq<span class="w"> </span>ntp
</span><span id="__span-73-18"><a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a><span class="w"> </span>port-object<span class="w"> </span>eq<span class="w"> </span>dnsix
</span><span id="__span-73-19"><a id="__codelineno-73-19" name="__codelineno-73-19" href="#__codelineno-73-19"></a><span class="w"> </span>port-object<span class="w"> </span>eq<span class="w"> </span><span class="m">5353</span>
</span><span id="__span-73-20"><a id="__codelineno-73-20" name="__codelineno-73-20" href="#__codelineno-73-20"></a><span class="w"> </span>port-object<span class="w"> </span>eq<span class="w"> </span><span class="m">553</span>
</span><span id="__span-73-21"><a id="__codelineno-73-21" name="__codelineno-73-21" href="#__codelineno-73-21"></a><span class="w"> </span>port-object<span class="w"> </span>eq<span class="w"> </span><span class="m">353</span>
</span></code></pre></div>
<h6 id="replace-full-playbook"><a class="toclink" href="../../ansible-asa-og/#replace-full-playbook">Replace - Full Playbook</a></h6>
<p>The full playbook with all of the debugs and the tasks.  </p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="nn">---</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASA OG Working</span>
</span><span id="__span-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asa_firewalls</span>
</span><span id="__span-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-74-8"><a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-74-9"><a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-74-10"><a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a>
</span><span id="__span-74-11"><a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-74-12"><a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a>
</span><span id="__span-74-13"><a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">RFC1918</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-14"><a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-74-15"><a id="__codelineno-74-15" name="__codelineno-74-15" href="#__codelineno-74-15"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918_Networks</span>
</span><span id="__span-74-16"><a id="__codelineno-74-16" name="__codelineno-74-16" href="#__codelineno-74-16"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object</span>
</span><span id="__span-74-17"><a id="__codelineno-74-17" name="__codelineno-74-17" href="#__codelineno-74-17"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-74-18"><a id="__codelineno-74-18" name="__codelineno-74-18" href="#__codelineno-74-18"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RFC1918 Local Networks</span>
</span><span id="__span-74-19"><a id="__codelineno-74-19" name="__codelineno-74-19" href="#__codelineno-74-19"></a><span class="w">        </span><span class="nt">ip_mask</span><span class="p">:</span>
</span><span id="__span-74-20"><a id="__codelineno-74-20" name="__codelineno-74-20" href="#__codelineno-74-20"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0 255.0.0.0</span>
</span><span id="__span-74-21"><a id="__codelineno-74-21" name="__codelineno-74-21" href="#__codelineno-74-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">172.16.0.0 255.240.0.0</span>
</span><span id="__span-74-22"><a id="__codelineno-74-22" name="__codelineno-74-22" href="#__codelineno-74-22"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.0 255.255.0.0</span>
</span><span id="__span-74-23"><a id="__codelineno-74-23" name="__codelineno-74-23" href="#__codelineno-74-23"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-74-24"><a id="__codelineno-74-24" name="__codelineno-74-24" href="#__codelineno-74-24"></a>
</span><span id="__span-74-25"><a id="__codelineno-74-25" name="__codelineno-74-25" href="#__codelineno-74-25"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Set</span><span class="nv"> </span><span class="s">External</span><span class="nv"> </span><span class="s">DNS/NTP</span><span class="nv"> </span><span class="s">Providers</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-26"><a id="__codelineno-74-26" name="__codelineno-74-26" href="#__codelineno-74-26"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-74-27"><a id="__codelineno-74-27" name="__codelineno-74-27" href="#__codelineno-74-27"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EXTERNAL_DNS_NTP</span>
</span><span id="__span-74-28"><a id="__codelineno-74-28" name="__codelineno-74-28" href="#__codelineno-74-28"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-object</span>
</span><span id="__span-74-29"><a id="__codelineno-74-29" name="__codelineno-74-29" href="#__codelineno-74-29"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-74-30"><a id="__codelineno-74-30" name="__codelineno-74-30" href="#__codelineno-74-30"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External DNS Providers (CloudFlare, Google, Quad9, Umbrella)</span>
</span><span id="__span-74-31"><a id="__codelineno-74-31" name="__codelineno-74-31" href="#__codelineno-74-31"></a><span class="w">        </span><span class="nt">host_ip</span><span class="p">:</span>
</span><span id="__span-74-32"><a id="__codelineno-74-32" name="__codelineno-74-32" href="#__codelineno-74-32"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.1.1.1</span>
</span><span id="__span-74-33"><a id="__codelineno-74-33" name="__codelineno-74-33" href="#__codelineno-74-33"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.8.8.8</span>
</span><span id="__span-74-34"><a id="__codelineno-74-34" name="__codelineno-74-34" href="#__codelineno-74-34"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9.9.9.9</span>
</span><span id="__span-74-35"><a id="__codelineno-74-35" name="__codelineno-74-35" href="#__codelineno-74-35"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">208.67.222.222</span>
</span><span id="__span-74-36"><a id="__codelineno-74-36" name="__codelineno-74-36" href="#__codelineno-74-36"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">208.67.220.220</span>
</span><span id="__span-74-37"><a id="__codelineno-74-37" name="__codelineno-74-37" href="#__codelineno-74-37"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output2</span>
</span><span id="__span-74-38"><a id="__codelineno-74-38" name="__codelineno-74-38" href="#__codelineno-74-38"></a>
</span><span id="__span-74-39"><a id="__codelineno-74-39" name="__codelineno-74-39" href="#__codelineno-74-39"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">3:</span><span class="nv"> </span><span class="s">Add</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-40"><a id="__codelineno-74-40" name="__codelineno-74-40" href="#__codelineno-74-40"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-74-41"><a id="__codelineno-74-41" name="__codelineno-74-41" href="#__codelineno-74-41"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SVC_OBJ_DNS_NTP</span>
</span><span id="__span-74-42"><a id="__codelineno-74-42" name="__codelineno-74-42" href="#__codelineno-74-42"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-74-43"><a id="__codelineno-74-43" name="__codelineno-74-43" href="#__codelineno-74-43"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-74-44"><a id="__codelineno-74-44" name="__codelineno-74-44" href="#__codelineno-74-44"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-74-45"><a id="__codelineno-74-45" name="__codelineno-74-45" href="#__codelineno-74-45"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-74-46"><a id="__codelineno-74-46" name="__codelineno-74-46" href="#__codelineno-74-46"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-74-47"><a id="__codelineno-74-47" name="__codelineno-74-47" href="#__codelineno-74-47"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;ntp&quot;</span>
</span><span id="__span-74-48"><a id="__codelineno-74-48" name="__codelineno-74-48" href="#__codelineno-74-48"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;dnsix&quot;</span>
</span><span id="__span-74-49"><a id="__codelineno-74-49" name="__codelineno-74-49" href="#__codelineno-74-49"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5353&quot;</span>
</span><span id="__span-74-50"><a id="__codelineno-74-50" name="__codelineno-74-50" href="#__codelineno-74-50"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;553&quot;</span>
</span><span id="__span-74-51"><a id="__codelineno-74-51" name="__codelineno-74-51" href="#__codelineno-74-51"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;353&quot;</span>
</span><span id="__span-74-52"><a id="__codelineno-74-52" name="__codelineno-74-52" href="#__codelineno-74-52"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output3</span>
</span><span id="__span-74-53"><a id="__codelineno-74-53" name="__codelineno-74-53" href="#__codelineno-74-53"></a>
</span><span id="__span-74-54"><a id="__codelineno-74-54" name="__codelineno-74-54" href="#__codelineno-74-54"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">4:</span><span class="nv"> </span><span class="s">Remove</span><span class="nv"> </span><span class="s">Extra</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-55"><a id="__codelineno-74-55" name="__codelineno-74-55" href="#__codelineno-74-55"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-74-56"><a id="__codelineno-74-56" name="__codelineno-74-56" href="#__codelineno-74-56"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS_ONLY</span>
</span><span id="__span-74-57"><a id="__codelineno-74-57" name="__codelineno-74-57" href="#__codelineno-74-57"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-74-58"><a id="__codelineno-74-58" name="__codelineno-74-58" href="#__codelineno-74-58"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absent</span>
</span><span id="__span-74-59"><a id="__codelineno-74-59" name="__codelineno-74-59" href="#__codelineno-74-59"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-74-60"><a id="__codelineno-74-60" name="__codelineno-74-60" href="#__codelineno-74-60"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-74-61"><a id="__codelineno-74-61" name="__codelineno-74-61" href="#__codelineno-74-61"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">domain</span>
</span><span id="__span-74-62"><a id="__codelineno-74-62" name="__codelineno-74-62" href="#__codelineno-74-62"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output4</span>
</span><span id="__span-74-63"><a id="__codelineno-74-63" name="__codelineno-74-63" href="#__codelineno-74-63"></a>
</span><span id="__span-74-64"><a id="__codelineno-74-64" name="__codelineno-74-64" href="#__codelineno-74-64"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">5:</span><span class="nv"> </span><span class="s">Fix</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">DNS</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-65"><a id="__codelineno-74-65" name="__codelineno-74-65" href="#__codelineno-74-65"></a><span class="w">      </span><span class="nt">asa_og</span><span class="p">:</span>
</span><span id="__span-74-66"><a id="__codelineno-74-66" name="__codelineno-74-66" href="#__codelineno-74-66"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SVC_OBJ_DNS_NTP</span>
</span><span id="__span-74-67"><a id="__codelineno-74-67" name="__codelineno-74-67" href="#__codelineno-74-67"></a><span class="w">        </span><span class="nt">group_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">port-object</span>
</span><span id="__span-74-68"><a id="__codelineno-74-68" name="__codelineno-74-68" href="#__codelineno-74-68"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replace</span>
</span><span id="__span-74-69"><a id="__codelineno-74-69" name="__codelineno-74-69" href="#__codelineno-74-69"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DNS and NTP ports</span>
</span><span id="__span-74-70"><a id="__codelineno-74-70" name="__codelineno-74-70" href="#__codelineno-74-70"></a><span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-74-71"><a id="__codelineno-74-71" name="__codelineno-74-71" href="#__codelineno-74-71"></a><span class="w">        </span><span class="nt">port_eq</span><span class="p">:</span>
</span><span id="__span-74-72"><a id="__codelineno-74-72" name="__codelineno-74-72" href="#__codelineno-74-72"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;domain&quot;</span>
</span><span id="__span-74-73"><a id="__codelineno-74-73" name="__codelineno-74-73" href="#__codelineno-74-73"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;ntp&quot;</span>
</span><span id="__span-74-74"><a id="__codelineno-74-74" name="__codelineno-74-74" href="#__codelineno-74-74"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output5</span>
</span><span id="__span-74-75"><a id="__codelineno-74-75" name="__codelineno-74-75" href="#__codelineno-74-75"></a>
</span><span id="__span-74-76"><a id="__codelineno-74-76" name="__codelineno-74-76" href="#__codelineno-74-76"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">RFC1918</span><span class="nv"> </span><span class="s">Object</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-77"><a id="__codelineno-74-77" name="__codelineno-74-77" href="#__codelineno-74-77"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-74-78"><a id="__codelineno-74-78" name="__codelineno-74-78" href="#__codelineno-74-78"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-74-79"><a id="__codelineno-74-79" name="__codelineno-74-79" href="#__codelineno-74-79"></a>
</span><span id="__span-74-80"><a id="__codelineno-74-80" name="__codelineno-74-80" href="#__codelineno-74-80"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">External</span><span class="nv"> </span><span class="s">DNS</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-81"><a id="__codelineno-74-81" name="__codelineno-74-81" href="#__codelineno-74-81"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-74-82"><a id="__codelineno-74-82" name="__codelineno-74-82" href="#__codelineno-74-82"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output2</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-74-83"><a id="__codelineno-74-83" name="__codelineno-74-83" href="#__codelineno-74-83"></a>
</span><span id="__span-74-84"><a id="__codelineno-74-84" name="__codelineno-74-84" href="#__codelineno-74-84"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">3:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">adding</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-85"><a id="__codelineno-74-85" name="__codelineno-74-85" href="#__codelineno-74-85"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-74-86"><a id="__codelineno-74-86" name="__codelineno-74-86" href="#__codelineno-74-86"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output3</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-74-87"><a id="__codelineno-74-87" name="__codelineno-74-87" href="#__codelineno-74-87"></a>
</span><span id="__span-74-88"><a id="__codelineno-74-88" name="__codelineno-74-88" href="#__codelineno-74-88"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">4:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">removing</span><span class="nv"> </span><span class="s">extra</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group&quot;</span>
</span><span id="__span-74-89"><a id="__codelineno-74-89" name="__codelineno-74-89" href="#__codelineno-74-89"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-74-90"><a id="__codelineno-74-90" name="__codelineno-74-90" href="#__codelineno-74-90"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output4</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-74-91"><a id="__codelineno-74-91" name="__codelineno-74-91" href="#__codelineno-74-91"></a>
</span><span id="__span-74-92"><a id="__codelineno-74-92" name="__codelineno-74-92" href="#__codelineno-74-92"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DEBUG</span><span class="nv"> </span><span class="s">5:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">Port</span><span class="nv"> </span><span class="s">Group</span><span class="nv"> </span><span class="s">Replace&quot;</span>
</span><span id="__span-74-93"><a id="__codelineno-74-93" name="__codelineno-74-93" href="#__codelineno-74-93"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-74-94"><a id="__codelineno-74-94" name="__codelineno-74-94" href="#__codelineno-74-94"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output5</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-74-95"><a id="__codelineno-74-95" name="__codelineno-74-95" href="#__codelineno-74-95"></a><span class="nn">...</span>
</span></code></pre></div>
<h6 id="execution"><a class="toclink" href="../../ansible-asa-og/#execution">Execution</a></h6>
<p>Task 1-4: All check out OK, there are no changes being made<br />
Task 5: This is that additional task to fix the item properly<br />
Debug 1-4: All show no changes<br />
Debug 5: Shows that the changes were made, including add <code>domain</code> and removing a
bunch of extra items  </p>
<iframe width="853" height="480" src="https://www.youtube.com/embed/HARqtDKc0MM?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<div class="language-bash highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>PLAY<span class="w"> </span><span class="o">[</span>ASA<span class="w"> </span>OG<span class="w"> </span>Working<span class="o">]</span><span class="w"> </span>**********************************************************
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Set<span class="w"> </span>RFC1918<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>****************************************
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-75-5"><a id="__codelineno-75-5" name="__codelineno-75-5" href="#__codelineno-75-5"></a>
</span><span id="__span-75-6"><a id="__codelineno-75-6" name="__codelineno-75-6" href="#__codelineno-75-6"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>Set<span class="w"> </span>External<span class="w"> </span>DNS/NTP<span class="w"> </span>Providers<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>*********************
</span><span id="__span-75-7"><a id="__codelineno-75-7" name="__codelineno-75-7" href="#__codelineno-75-7"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-75-8"><a id="__codelineno-75-8" name="__codelineno-75-8" href="#__codelineno-75-8"></a>
</span><span id="__span-75-9"><a id="__codelineno-75-9" name="__codelineno-75-9" href="#__codelineno-75-9"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">3</span>:<span class="w"> </span>Add<span class="w"> </span>Port<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>**************************************************
</span><span id="__span-75-10"><a id="__codelineno-75-10" name="__codelineno-75-10" href="#__codelineno-75-10"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-75-11"><a id="__codelineno-75-11" name="__codelineno-75-11" href="#__codelineno-75-11"></a>
</span><span id="__span-75-12"><a id="__codelineno-75-12" name="__codelineno-75-12" href="#__codelineno-75-12"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">4</span>:<span class="w"> </span>Remove<span class="w"> </span>Extra<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>**********************************************
</span><span id="__span-75-13"><a id="__codelineno-75-13" name="__codelineno-75-13" href="#__codelineno-75-13"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-75-14"><a id="__codelineno-75-14" name="__codelineno-75-14" href="#__codelineno-75-14"></a>
</span><span id="__span-75-15"><a id="__codelineno-75-15" name="__codelineno-75-15" href="#__codelineno-75-15"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">5</span>:<span class="w"> </span>Fix<span class="w"> </span>the<span class="w"> </span>DNS<span class="w"> </span>Port<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>******************************************
</span><span id="__span-75-16"><a id="__codelineno-75-16" name="__codelineno-75-16" href="#__codelineno-75-16"></a>changed:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-75-17"><a id="__codelineno-75-17" name="__codelineno-75-17" href="#__codelineno-75-17"></a>
</span><span id="__span-75-18"><a id="__codelineno-75-18" name="__codelineno-75-18" href="#__codelineno-75-18"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>RFC1918<span class="w"> </span>Object<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>***************************
</span><span id="__span-75-19"><a id="__codelineno-75-19" name="__codelineno-75-19" href="#__codelineno-75-19"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-20"><a id="__codelineno-75-20" name="__codelineno-75-20" href="#__codelineno-75-20"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-21"><a id="__codelineno-75-21" name="__codelineno-75-21" href="#__codelineno-75-21"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-75-22"><a id="__codelineno-75-22" name="__codelineno-75-22" href="#__codelineno-75-22"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-75-23"><a id="__codelineno-75-23" name="__codelineno-75-23" href="#__codelineno-75-23"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-75-24"><a id="__codelineno-75-24" name="__codelineno-75-24" href="#__codelineno-75-24"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-75-25"><a id="__codelineno-75-25" name="__codelineno-75-25" href="#__codelineno-75-25"></a><span class="o">}</span>
</span><span id="__span-75-26"><a id="__codelineno-75-26" name="__codelineno-75-26" href="#__codelineno-75-26"></a>
</span><span id="__span-75-27"><a id="__codelineno-75-27" name="__codelineno-75-27" href="#__codelineno-75-27"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>External<span class="w"> </span>DNS<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>*****************************
</span><span id="__span-75-28"><a id="__codelineno-75-28" name="__codelineno-75-28" href="#__codelineno-75-28"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-29"><a id="__codelineno-75-29" name="__codelineno-75-29" href="#__codelineno-75-29"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-30"><a id="__codelineno-75-30" name="__codelineno-75-30" href="#__codelineno-75-30"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-75-31"><a id="__codelineno-75-31" name="__codelineno-75-31" href="#__codelineno-75-31"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-75-32"><a id="__codelineno-75-32" name="__codelineno-75-32" href="#__codelineno-75-32"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-75-33"><a id="__codelineno-75-33" name="__codelineno-75-33" href="#__codelineno-75-33"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-75-34"><a id="__codelineno-75-34" name="__codelineno-75-34" href="#__codelineno-75-34"></a><span class="o">}</span>
</span><span id="__span-75-35"><a id="__codelineno-75-35" name="__codelineno-75-35" href="#__codelineno-75-35"></a>
</span><span id="__span-75-36"><a id="__codelineno-75-36" name="__codelineno-75-36" href="#__codelineno-75-36"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span><span class="m">3</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>adding<span class="w"> </span>Port<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>******************************
</span><span id="__span-75-37"><a id="__codelineno-75-37" name="__codelineno-75-37" href="#__codelineno-75-37"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-38"><a id="__codelineno-75-38" name="__codelineno-75-38" href="#__codelineno-75-38"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-39"><a id="__codelineno-75-39" name="__codelineno-75-39" href="#__codelineno-75-39"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-75-40"><a id="__codelineno-75-40" name="__codelineno-75-40" href="#__codelineno-75-40"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-75-41"><a id="__codelineno-75-41" name="__codelineno-75-41" href="#__codelineno-75-41"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-75-42"><a id="__codelineno-75-42" name="__codelineno-75-42" href="#__codelineno-75-42"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-75-43"><a id="__codelineno-75-43" name="__codelineno-75-43" href="#__codelineno-75-43"></a><span class="o">}</span>
</span><span id="__span-75-44"><a id="__codelineno-75-44" name="__codelineno-75-44" href="#__codelineno-75-44"></a>
</span><span id="__span-75-45"><a id="__codelineno-75-45" name="__codelineno-75-45" href="#__codelineno-75-45"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span><span class="m">4</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>removing<span class="w"> </span>extra<span class="w"> </span>Port<span class="w"> </span>Group<span class="o">]</span><span class="w"> </span>**********************
</span><span id="__span-75-46"><a id="__codelineno-75-46" name="__codelineno-75-46" href="#__codelineno-75-46"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-47"><a id="__codelineno-75-47" name="__codelineno-75-47" href="#__codelineno-75-47"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-48"><a id="__codelineno-75-48" name="__codelineno-75-48" href="#__codelineno-75-48"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-75-49"><a id="__codelineno-75-49" name="__codelineno-75-49" href="#__codelineno-75-49"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-75-50"><a id="__codelineno-75-50" name="__codelineno-75-50" href="#__codelineno-75-50"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-75-51"><a id="__codelineno-75-51" name="__codelineno-75-51" href="#__codelineno-75-51"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-75-52"><a id="__codelineno-75-52" name="__codelineno-75-52" href="#__codelineno-75-52"></a><span class="o">}</span>
</span><span id="__span-75-53"><a id="__codelineno-75-53" name="__codelineno-75-53" href="#__codelineno-75-53"></a>
</span><span id="__span-75-54"><a id="__codelineno-75-54" name="__codelineno-75-54" href="#__codelineno-75-54"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span><span class="m">5</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>Port<span class="w"> </span>Group<span class="w"> </span>Replace<span class="o">]</span><span class="w"> </span>*****************************
</span><span id="__span-75-55"><a id="__codelineno-75-55" name="__codelineno-75-55" href="#__codelineno-75-55"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-56"><a id="__codelineno-75-56" name="__codelineno-75-56" href="#__codelineno-75-56"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-75-57"><a id="__codelineno-75-57" name="__codelineno-75-57" href="#__codelineno-75-57"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-75-58"><a id="__codelineno-75-58" name="__codelineno-75-58" href="#__codelineno-75-58"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-75-59"><a id="__codelineno-75-59" name="__codelineno-75-59" href="#__codelineno-75-59"></a><span class="w">            </span><span class="s2">&quot;object-group service SVC_OBJ_DNS_NTP udp&quot;</span>,
</span><span id="__span-75-60"><a id="__codelineno-75-60" name="__codelineno-75-60" href="#__codelineno-75-60"></a><span class="w">            </span><span class="s2">&quot;port-object eq domain&quot;</span>,
</span><span id="__span-75-61"><a id="__codelineno-75-61" name="__codelineno-75-61" href="#__codelineno-75-61"></a><span class="w">            </span><span class="s2">&quot;no port-object eq 553&quot;</span>,
</span><span id="__span-75-62"><a id="__codelineno-75-62" name="__codelineno-75-62" href="#__codelineno-75-62"></a><span class="w">            </span><span class="s2">&quot;no port-object eq 353&quot;</span>,
</span><span id="__span-75-63"><a id="__codelineno-75-63" name="__codelineno-75-63" href="#__codelineno-75-63"></a><span class="w">            </span><span class="s2">&quot;no port-object eq 5353&quot;</span>,
</span><span id="__span-75-64"><a id="__codelineno-75-64" name="__codelineno-75-64" href="#__codelineno-75-64"></a><span class="w">            </span><span class="s2">&quot;no port-object eq dnsix&quot;</span>
</span><span id="__span-75-65"><a id="__codelineno-75-65" name="__codelineno-75-65" href="#__codelineno-75-65"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-75-66"><a id="__codelineno-75-66" name="__codelineno-75-66" href="#__codelineno-75-66"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-75-67"><a id="__codelineno-75-67" name="__codelineno-75-67" href="#__codelineno-75-67"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-75-68"><a id="__codelineno-75-68" name="__codelineno-75-68" href="#__codelineno-75-68"></a><span class="o">}</span>
</span><span id="__span-75-69"><a id="__codelineno-75-69" name="__codelineno-75-69" href="#__codelineno-75-69"></a>
</span><span id="__span-75-70"><a id="__codelineno-75-70" name="__codelineno-75-70" href="#__codelineno-75-70"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>*********************************************************************
</span><span id="__span-75-71"><a id="__codelineno-75-71" name="__codelineno-75-71" href="#__codelineno-75-71"></a>asa1<span class="w">                       </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">10</span><span class="w">   </span><span class="nv">changed</span><span class="o">=</span><span class="m">1</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span>s
</span><span id="__span-75-72"><a id="__codelineno-75-72" name="__codelineno-75-72" href="#__codelineno-75-72"></a><span class="nv">kipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span>
</span></code></pre></div>
<h3 id="summary"><a class="toclink" href="../../ansible-asa-og/#summary">Summary</a></h3>
<p>This module is a terrific module if you are asked to manage ASA policy. This is
very complete and should be part of your toolset for managing ASA devices. I do
foresee a significant amount of use out of the <code>state: replace</code> setup in getting
object groups to a declared state.  </p>
<p>Again, very important as well, <strong>do not forget</strong> to save your configurations at
the end if making changes.  </p>
<p>I hope that this has been informative!  </p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-06-20 00:00:00">June 20, 2019</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/ansible/" class="md-meta__link">ansible</a>, 
              <a href="../../category/cisco/" class="md-meta__link">cisco</a>, 
              <a href="../../category/asa/" class="md-meta__link">asa</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-asa-command-module"><a class="toclink" href="../../ansible-asa-command/">Ansible ASA Command Module</a></h2>
<p>Today will be a touch shorter post, but it is good to be back at it. In this
post I will be taking a quick look around at the asa_command module, as we start
down the path with looking at the ASA modules in Ansible. This is spurned on a
little bit by Ansible 2.8 coming out with an Object Group specific module. I
will be looking into that further in a future post.</p>
<p>For the set of posts regarding the ASA, we will be starting with a pretty bare
configuration on the device. We will have just a management IP address and the
ability to SSH to the device.</p>
<h3 id="module-documentation"><a class="toclink" href="../../ansible-asa-command/#module-documentation">Module Documentation</a></h3>
<p>Module documentation page can be found
<a href="https://docs.ansible.com/ansible/latest/modules/asa_command_module.html">here</a>.</p>
<h3 id="lab-configuration"><a class="toclink" href="../../ansible-asa-command/#lab-configuration">Lab Configuration</a></h3>
<p>The device has bare basic configuration on it. Here we see that it has just a
management IP address on it.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>fw01# show int ip brie
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Interface                  IP-Address      OK? Method Status                Protocol
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>GigabitEthernet0/0         unassigned      YES unset  administratively down up  
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>GigabitEthernet0/1         unassigned      YES unset  administratively down up  
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>GigabitEthernet0/2         unassigned      YES unset  administratively down up  
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>Management0/0              172.16.0.254    YES CONFIG up                    up 
</span></code></pre></div>
<h3 id="using-the-playbook"><a class="toclink" href="../../ansible-asa-command/#using-the-playbook">Using the playbook</a></h3>
<h4 id="parameters"><a class="toclink" href="../../ansible-asa-command/#parameters">Parameters</a></h4>
<p>There are a couple of key parameters on this module for getting started are:</p>
<ul>
<li>commands: A list of commands to send to the device; this can be one, or 
several commands within a list</li>
<li>context: used for firewalls in multi-context mode, which context do you want
to run the command(s) in</li>
</ul>
<h4 id="simple-first-playbook"><a class="toclink" href="../../ansible-asa-command/#simple-first-playbook">Simple first Playbook</a></h4>
<p>This is a simple playbook that will issue two commands. We will access both of
them in different tasks within the play. Taking a look at the play we are
executing the task with two commands, a <code>show int ip brie</code> and a ping to Google
DNS. </p>
<h5 id="playbook"><a class="toclink" href="../../ansible-asa-command/#playbook">Playbook</a></h5>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nn">---</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ASA Command Output</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">asa_firewalls</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">1:</span><span class="nv"> </span><span class="s">Read</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">ASA&quot;</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">      </span><span class="nt">asa_command</span><span class="p">:</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">        </span><span class="nt">commands</span><span class="p">:</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">show int ip brief</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ping 8.8.8.8</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">2:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">show</span><span class="nv"> </span><span class="s">interfaces&quot;</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output.stdout_lines.0</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TASK</span><span class="nv"> </span><span class="s">3:</span><span class="nv"> </span><span class="s">Print</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">pinging</span><span class="nv"> </span><span class="s">Google</span><span class="nv"> </span><span class="s">DNS&quot;</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output.stdout_lines.1</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h5 id="tasks-high-level"><a class="toclink" href="../../ansible-asa-command/#tasks-high-level">Tasks High Level</a></h5>
<p>TASK 1 is when Ansible logs into the device and issues the two commands.<br />
TASK 2 we get the expected output of the <code>show int ip brie</code> and the commands
TASK 3 we see that the device is able to successfully ping Google DNS</p>
<p>These are the tasks that are to be run via the playbook broken out:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>cat<span class="w"> </span>asa_command_demo.yml<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>TASK
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 1: Read output from ASA&quot;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 2: Print output of show interfaces&quot;</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span>-<span class="w"> </span>name:<span class="w"> </span><span class="s2">&quot;TASK 3: Print output of pinging Google DNS&quot;</span>
</span></code></pre></div>
<h5 id="playbook-run"><a class="toclink" href="../../ansible-asa-command/#playbook-run">Playbook Run</a></h5>
<p>Execution of the playbook:</p>
<p>To see a video of this on Youtube - <a href="https://youtu.be/Wk-3Zg08oSw">https://youtu.be/Wk-3Zg08oSw</a></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>PLAY<span class="w"> </span><span class="o">[</span>ASA<span class="w"> </span>Command<span class="w"> </span>Output<span class="o">]</span><span class="w"> </span>*********************************************************************
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">1</span>:<span class="w"> </span>Read<span class="w"> </span>output<span class="w"> </span>from<span class="w"> </span>ASA<span class="o">]</span><span class="w"> </span>***********************************************************
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">2</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>show<span class="w"> </span>interfaces<span class="o">]</span><span class="w"> </span>************************************************
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">        </span><span class="s2">&quot;Interface                  IP-Address      OK? Method Status                Protocol&quot;</span>,
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">        </span><span class="s2">&quot;GigabitEthernet0/0         unassigned      YES unset  administratively down up  &quot;</span>,
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">        </span><span class="s2">&quot;GigabitEthernet0/1         unassigned      YES unset  administratively down up  &quot;</span>,
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">        </span><span class="s2">&quot;GigabitEthernet0/2         unassigned      YES unset  administratively down up  &quot;</span>,
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">        </span><span class="s2">&quot;Management0/0              172.16.0.254    YES CONFIG up                    up&quot;</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">    </span><span class="o">]</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="o">}</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>TASK<span class="w"> </span><span class="o">[</span>TASK<span class="w"> </span><span class="m">3</span>:<span class="w"> </span>Print<span class="w"> </span>output<span class="w"> </span>of<span class="w"> </span>pinging<span class="w"> </span>Google<span class="w"> </span>DNS<span class="o">]</span><span class="w"> </span>*********************************************
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>ok:<span class="w"> </span><span class="o">[</span>asa1<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">        </span><span class="s2">&quot;Type escape sequence to abort.&quot;</span>,
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">        </span><span class="s2">&quot;Sending 5, 100-byte ICMP Echos to 8.8.8.8, timeout is 2 seconds:&quot;</span>,
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">        </span><span class="s2">&quot;!!!!!&quot;</span>,
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">        </span><span class="s2">&quot;Success rate is 100 percent (5/5), round-trip min/avg/max = 20/104/190 ms&quot;</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">    </span><span class="o">]</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="o">}</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>************************************************************************************
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>asa1<span class="w">                       </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">3</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span>
</span></code></pre></div>
<h5 id="access-multiple-commands"><a class="toclink" href="../../ansible-asa-command/#access-multiple-commands">Access Multiple Commands</a></h5>
<p>This is another example of how to issue multiple commands against a device
within a single task. For a deeper dive on that you can see an earlier post
<a href="https://josh-v.com/blog/2019/01/05/ansible-output-work.html">here</a>.</p>
<h3 id="summary"><a class="toclink" href="../../ansible-asa-command/#summary">Summary</a></h3>
<p>This is a solid starting out module for working with ASA firewalls. It does
come in very handy with dealing and gathering information from the ASA
firewall platform. I have used this for several things within a production
environment, primarily for data gathering. Hopefully coming up I will be able
to expand on this further in building out an ASA firewall.</p>
<p>Hope this was helpful! </p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-03-30 00:00:00">March 30, 2019</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/ansible/" class="md-meta__link">ansible</a>, 
              <a href="../../category/cisco/" class="md-meta__link">cisco</a>, 
              <a href="../../category/cisco_ios/" class="md-meta__link">cisco_ios</a>, 
              <a href="../../category/cisco_wlc/" class="md-meta__link">cisco_wlc</a>, 
              <a href="../../category/cisco_nxos/" class="md-meta__link">cisco_nxos</a></li>
        
        
          
          <li class="md-meta__item">
            
              7 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-saving-cisco-configs-to-nvram-with-cisco-specific-modules"><a class="toclink" href="../../ansible-saving-cisco-configs-ios/">Ansible Saving Cisco Configs to NVRAM with Cisco Specific Modules</a></h2>
<p>Today I'm going to take a look at a method to be able to save the configuration of a Cisco device to
NVRAM (copy run start). I will be taking a look at multiple Cisco platforms to save changes done
during an Ansible Playbook to NVRAM. There are options to save the configuration on every change
within the modules such as <strong>ios_config</strong> or <strong>cli_config</strong>, however, this can slow down the
execution of your playbook.</p>
<p>First I will take a look at saving the configuration within its own task just for saving
configuration. This is how I have many of my playbooks as I'm executing several tasks, breaking them
out. I then have a dedicated task that will save the configuration. I do this for speed of the
playbook execution. If there are multiple changes on tasks and each one of the tasks is saving the
configuration, then there will be some significant time spent saving the configuration multiple
times. In this I will take a look at the copy command execution, but also, the trick I like to use
of the config module and just <strong>save_when</strong> parameter.</p>

    
      <nav class="md-post__action">
        <a href="../../ansible-saving-cisco-configs-ios/">
          Continue reading
        </a>
      </nav>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-03-17 00:00:00">March 17, 2019</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/ansible/" class="md-meta__link">ansible</a>, 
              <a href="../../category/cisco/" class="md-meta__link">cisco</a>, 
              <a href="../../category/ios_interface/" class="md-meta__link">ios_interface</a></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-cisco-ios-interface-module"><a class="toclink" href="../../ansible-cisco-ios-interface/">Ansible Cisco IOS Interface Module</a></h2>
<p>Update: <code>ios_interface</code> is to be deprecated as of Ansible 2.13  </p>
<p>In this post I will be taking a deeper look at the <strong>ios_interface</strong> module. This module is used to
configure individual interfaces on a Cisco IOS device. The documentation for the module is located
<a href="https://docs.ansible.com/ansible/latest/modules/ios_interface_module.html">here</a>.
In this module I did have to dig into the actual Python file, and that is located
<a href="https://github.com/ansible/ansible/blob/stable-2.9/lib/ansible/modules/network/ios/ios_interfaces.py">here</a>.  </p>
<blockquote>
<p>Edit: Had to update the link due to the change in Ansible coming in 2.10. I have hard linked to
the IOS Interfaces module.</p>
<p>This module <strong>does not</strong> configure the layer 2 or layer 3 information on an interface. There are
other modules that are used for configuring these particular pieces.</p>
</blockquote>
<h3 id="a-look-at-the-parameters"><a class="toclink" href="../../ansible-cisco-ios-interface/#a-look-at-the-parameters">A look at the Parameters</a></h3>
<h4 id="required-parameters"><a class="toclink" href="../../ansible-cisco-ios-interface/#required-parameters">Required Parameters</a></h4>
<p>This module only has a single required module. </p>
<ul>
<li>name: Name of the interface that is being configured, such as <em>GigabitEthernet0/0/0</em>  </li>
</ul>
<p>Using the module with just the one required item of <em>name</em> is pretty uneventful. If you wish to see
the output I'm going to put that at the very bottom as an Appendix type item if you wish to see that
output.</p>
<h4 id="optional-parameters"><a class="toclink" href="../../ansible-cisco-ios-interface/#optional-parameters">Optional Parameters</a></h4>
<ul>
<li>aggregate: This is what you will need to use if you want to configure multiple interfaces within
the same task execution (or a loop of course)  </li>
<li>delay: Time to wait before checking the state of an interface, defaults to 10 seconds</li>
<li>description: Interface description, follows the Cisco command <strong>description</strong> under the
interface configuration  </li>
<li>duplex: (full/half/auto) duplex settings in the interface configuration  </li>
<li>enabled: (yes/no) interface link status, should it be enabled/disabled  </li>
<li>mtu: MTU setting, follows the <strong>mtu</strong> configuration under the interface configuration</li>
<li>neighbors: Checking for the operational state, using LLDP information, either with the
sub-parameter <em>host</em> or <em>port</em>  </li>
<li>rx_rate: Stated as Receiver rate in bits per second, not sure what this does  </li>
<li>speed: Interface speed in Mbps, corresponds to the Cisco command <strong>speed</strong> under interface
configuration</li>
<li>tx_rate: Stated as Transmit rate in bits per second, not sure what it does  </li>
</ul>
<p><strong>Note - Operational State</strong>  </p>
<p>As I'm writing (and not having tested yet) the operational state if you are configuring an interface
and looking to validate the neighbors, you may want to up the delay time based on the LLDP neighbor
timers. These timers may be longer than the default 10 seconds.  </p>
<h5 id="rx_rate-and-tx_rate"><a class="toclink" href="../../ansible-cisco-ios-interface/#rx_rate-and-tx_rate">rx_rate and tx_rate</a></h5>
<p>From the documentation on the module this appears to perhaps to be related to the actual
interface transmit and receive rates that is being reported by the device. The documentation has
some references to <strong>ge</strong> and <strong>le</strong> which would be comparisons. Based on the Python file and the
variables named <strong>want_tx_rate</strong> and <strong>want_rx_rate</strong> within the Python file, this does in fact
appear to be related to the interface traffic amount.</p>
<h4 id="parameter-details-aggregate"><a class="toclink" href="../../ansible-cisco-ios-interface/#parameter-details-aggregate">Parameter Details: Aggregate</a></h4>
<p>This is what I will say is a <em>group</em> of interfaces to configure within a single task. This is where
you will configure multiples of the <strong>ios_interface</strong> task. To leverage this you will need to create
a dictionary (Array) with the required parameters for the module.</p>
<h3 id="a-look-at-the-module-in-action"><a class="toclink" href="../../ansible-cisco-ios-interface/#a-look-at-the-module-in-action">A look at the module in action</a></h3>
<p>First, jumping deep in. Going to take a look at what it looks like to configure interfaces using
the aggregate parameter. This is going to configure specific details about two interfaces on the
switch itself.</p>
<h5 id="pre-change-config"><a class="toclink" href="../../ansible-cisco-ios-interface/#pre-change-config">Pre-Change Config</a></h5>
<p>Before the change there is just the <code>media-type</code> and the <code>negotiation</code> set to auto. These are
default out of the box.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span>
<span class="normal"><a href="#__codelineno-26-14">14</a></span>
<span class="normal"><a href="#__codelineno-26-15">15</a></span>
<span class="normal"><a href="#__codelineno-26-16">16</a></span>
<span class="normal"><a href="#__codelineno-26-17">17</a></span>
<span class="normal"><a href="#__codelineno-26-18">18</a></span>
<span class="normal"><a href="#__codelineno-26-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="l l-Scalar l-Scalar-Plain">sw19#show run int gig0/1</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="l l-Scalar l-Scalar-Plain">Building configuration...</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="l l-Scalar l-Scalar-Plain">Current configuration</span><span class="w"> </span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">71 bytes</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="kt">!</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="l l-Scalar l-Scalar-Plain">interface GigabitEthernet0/1</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">media-type rj45</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">negotiation auto</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="l l-Scalar l-Scalar-Plain">end</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10"></a>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="l l-Scalar l-Scalar-Plain">sw19#show run int gig0/2</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="l l-Scalar l-Scalar-Plain">Building configuration...</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13"></a>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="nt">Current configuration </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">71 bytes</span>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="kt">!</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="l l-Scalar l-Scalar-Plain">interface GigabitEthernet0/2</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">media-type rj45</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">negotiation auto</span>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="l l-Scalar l-Scalar-Plain">end</span>
</span></code></pre></div></td></tr></table></div>
<h5 id="playbook"><a class="toclink" href="../../ansible-cisco-ios-interface/#playbook">Playbook</a></h5>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nn">---</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-27-10"><a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-27-11"><a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; VLAN Updates</span>
</span><span id="__span-27-12"><a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="w">      </span><span class="nt">ios_interface</span><span class="p">:</span>
</span><span id="__span-27-13"><a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">        </span><span class="nt">aggregate</span><span class="p">:</span>
</span><span id="__span-27-14"><a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="nv">GigabitEthernet0/1</span><span class="p p-Indicator">,</span><span class="nt"> description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;First</span><span class="nv"> </span><span class="s">Ansible</span><span class="nv"> </span><span class="s">Configured</span><span class="nv"> </span><span class="s">Interface&quot;</span><span class="p p-Indicator">,</span><span class="nt"> enabled</span><span class="p">:</span><span class="w"> </span><span class="nv">no</span><span class="p p-Indicator">}</span>
</span><span id="__span-27-15"><a id="__codelineno-27-15" name="__codelineno-27-15" href="#__codelineno-27-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="nv">GigabitEthernet0/2</span><span class="p p-Indicator">,</span><span class="nt"> description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Second</span><span class="nv"> </span><span class="s">Ansible</span><span class="nv"> </span><span class="s">Configured</span><span class="nv"> </span><span class="s">Interface&quot;</span><span class="p p-Indicator">,</span><span class="nt"> enabled</span><span class="p">:</span><span class="w"> </span><span class="nv">yes</span><span class="p p-Indicator">}</span>
</span><span id="__span-27-16"><a id="__codelineno-27-16" name="__codelineno-27-16" href="#__codelineno-27-16"></a><span class="w">        </span><span class="nt">speed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</span><span id="__span-27-17"><a id="__codelineno-27-17" name="__codelineno-27-17" href="#__codelineno-27-17"></a><span class="w">        </span><span class="nt">duplex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">full</span>
</span><span id="__span-27-18"><a id="__codelineno-27-18" name="__codelineno-27-18" href="#__codelineno-27-18"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-27-19"><a id="__codelineno-27-19" name="__codelineno-27-19" href="#__codelineno-27-19"></a>
</span><span id="__span-27-20"><a id="__codelineno-27-20" name="__codelineno-27-20" href="#__codelineno-27-20"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; output</span>
</span><span id="__span-27-21"><a id="__codelineno-27-21" name="__codelineno-27-21" href="#__codelineno-27-21"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-27-22"><a id="__codelineno-27-22" name="__codelineno-27-22" href="#__codelineno-27-22"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h5 id="ansible-output"><a class="toclink" href="../../ansible-cisco-ios-interface/#ansible-output">Ansible Output</a></h5>
<p>Here we see that the commands being sent to the device are to set the speed, duplex to full,
interface description, and then shutting down the interface that was set to disabled.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span>
<span class="normal"><a href="#__codelineno-28-25">25</a></span>
<span class="normal"><a href="#__codelineno-28-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="l l-Scalar l-Scalar-Plain">changed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5"></a>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG &gt;&gt; output] *********************************************************</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="w">            </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">GigabitEthernet0/1&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12"></a><span class="w">            </span><span class="s">&quot;speed</span><span class="nv"> </span><span class="s">100&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13"></a><span class="w">            </span><span class="s">&quot;description</span><span class="nv"> </span><span class="s">First</span><span class="nv"> </span><span class="s">Ansible</span><span class="nv"> </span><span class="s">Configured</span><span class="nv"> </span><span class="s">Interface&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14"></a><span class="w">            </span><span class="s">&quot;duplex</span><span class="nv"> </span><span class="s">full&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15"></a><span class="w">            </span><span class="s">&quot;shutdown&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16"></a><span class="w">            </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">GigabitEthernet0/2&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17"></a><span class="w">            </span><span class="s">&quot;speed</span><span class="nv"> </span><span class="s">100&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18"></a><span class="w">            </span><span class="s">&quot;description</span><span class="nv"> </span><span class="s">Second</span><span class="nv"> </span><span class="s">Ansible</span><span class="nv"> </span><span class="s">Configured</span><span class="nv"> </span><span class="s">Interface&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19"></a><span class="w">            </span><span class="s">&quot;duplex</span><span class="nv"> </span><span class="s">full&quot;</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="w">        </span><span class="p p-Indicator">],</span><span class="w"> </span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23"></a><span class="err">}</span>
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24"></a>
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
<h5 id="post-execution-configuration"><a class="toclink" href="../../ansible-cisco-ios-interface/#post-execution-configuration">Post Execution Configuration</a></h5>
<p>Working through this, it looks like the speed cannot be configured as autonegotation is set on the
interface. I believe that this is something that is primarily set because of using a virtualized
switch platform. I plan to open up a bug report on this soon. We see exactly what we expect in the
configuration after the Ansible output. We see interface description configured on each interface,
the interface shutdown or enabled. </p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span>
<span class="normal"><a href="#__codelineno-29-16">16</a></span>
<span class="normal"><a href="#__codelineno-29-17">17</a></span>
<span class="normal"><a href="#__codelineno-29-18">18</a></span>
<span class="normal"><a href="#__codelineno-29-19">19</a></span>
<span class="normal"><a href="#__codelineno-29-20">20</a></span>
<span class="normal"><a href="#__codelineno-29-21">21</a></span>
<span class="normal"><a href="#__codelineno-29-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="l l-Scalar l-Scalar-Plain">sw19#show run int gig0/1</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="l l-Scalar l-Scalar-Plain">Building configuration...</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="l l-Scalar l-Scalar-Plain">Current configuration</span><span class="w"> </span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">129 bytes</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="kt">!</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="l l-Scalar l-Scalar-Plain">interface GigabitEthernet0/1</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description First Ansible Configured Interface</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shutdown</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">media-type rj45</span>
</span><span id="__span-29-10"><a id="__codelineno-29-10" name="__codelineno-29-10"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">negotiation auto</span>
</span><span id="__span-29-11"><a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="l l-Scalar l-Scalar-Plain">end</span>
</span><span id="__span-29-12"><a id="__codelineno-29-12" name="__codelineno-29-12"></a>
</span><span id="__span-29-13"><a id="__codelineno-29-13" name="__codelineno-29-13"></a><span class="l l-Scalar l-Scalar-Plain">sw19#show run int gig0/2</span>
</span><span id="__span-29-14"><a id="__codelineno-29-14" name="__codelineno-29-14"></a><span class="l l-Scalar l-Scalar-Plain">Building configuration...</span>
</span><span id="__span-29-15"><a id="__codelineno-29-15" name="__codelineno-29-15"></a>
</span><span id="__span-29-16"><a id="__codelineno-29-16" name="__codelineno-29-16"></a><span class="nt">Current configuration </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">120 bytes</span>
</span><span id="__span-29-17"><a id="__codelineno-29-17" name="__codelineno-29-17"></a><span class="kt">!</span>
</span><span id="__span-29-18"><a id="__codelineno-29-18" name="__codelineno-29-18"></a><span class="l l-Scalar l-Scalar-Plain">interface GigabitEthernet0/2</span>
</span><span id="__span-29-19"><a id="__codelineno-29-19" name="__codelineno-29-19"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description Second Ansible Configured Interface</span>
</span><span id="__span-29-20"><a id="__codelineno-29-20" name="__codelineno-29-20"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">media-type rj45</span>
</span><span id="__span-29-21"><a id="__codelineno-29-21" name="__codelineno-29-21"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">negotiation auto</span>
</span><span id="__span-29-22"><a id="__codelineno-29-22" name="__codelineno-29-22"></a><span class="l l-Scalar l-Scalar-Plain">end</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="creating-a-loopback-interface"><a class="toclink" href="../../ansible-cisco-ios-interface/#creating-a-loopback-interface">Creating a Loopback Interface</a></h3>
<p>In the second example of the playbook we will create additional Loopback addresses. </p>
<h4 id="pre-change-configuration"><a class="toclink" href="../../ansible-cisco-ios-interface/#pre-change-configuration">Pre-Change Configuration</a></h4>
<p>Here is the output of the <code>show ip int breif</code> of the switch before adding loopbacks.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="l l-Scalar l-Scalar-Plain">Interface              IP-Address      OK? Method Status                Protocol</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/0     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/1     unassigned      YES unset  administratively down down</span><span class="w">    </span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/2     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/3     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/0     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/1     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/2     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/3     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="l l-Scalar l-Scalar-Plain">Loopback0              10.100.100.100  YES manual up                    up</span><span class="w">      </span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="l l-Scalar l-Scalar-Plain">Port-channel5          unassigned      YES unset  down                  down</span><span class="w">    </span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12"></a><span class="l l-Scalar l-Scalar-Plain">Port-channel6          unassigned      YES unset  down                  down</span><span class="w">    </span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13"></a><span class="l l-Scalar l-Scalar-Plain">Vlan2                  172.16.1.2      YES manual up                    up</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
<p>Here we only see one loopback address, Loopback0.</p>
<h4 id="playbook_1"><a class="toclink" href="../../ansible-cisco-ios-interface/#playbook_1">Playbook</a></h4>
<p>The playbook I'm going to add a loopback interface, but there will not be an address configured on
it, you will need to use <code>ios_l3_interface</code> in conjunction with this if using <code>ios_interface</code> for
loopbacks. </p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="nn">---</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; VLAN Updates</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">      </span><span class="nt">ios_interface</span><span class="p">:</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Loopback5</span>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; output</span>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h4 id="ansible-output_1"><a class="toclink" href="../../ansible-cisco-ios-interface/#ansible-output_1">Ansible Output</a></h4>
<p>I expect to see the configuration of just creating a loopback address. This is in fact what is seen
upon executing the command.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-32-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-32-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-32-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-32-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-32-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-32-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-32-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-32-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-32-10">10</a></span>
<span class="normal"><a href="#__codelineno-32-11">11</a></span>
<span class="normal"><a href="#__codelineno-32-12">12</a></span>
<span class="normal"><a href="#__codelineno-32-13">13</a></span>
<span class="normal"><a href="#__codelineno-32-14">14</a></span>
<span class="normal"><a href="#__codelineno-32-15">15</a></span>
<span class="normal"><a href="#__codelineno-32-16">16</a></span>
<span class="normal"><a href="#__codelineno-32-17">17</a></span>
<span class="normal"><a href="#__codelineno-32-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="l l-Scalar l-Scalar-Plain">changed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG &gt;&gt; output] *********************************************************</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11"></a><span class="w">            </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">Loopback5&quot;</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12"></a><span class="w">        </span><span class="p p-Indicator">],</span><span class="w"> </span>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15"></a><span class="err">}</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16"></a>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0</span><span class="w">  </span>
</span></code></pre></div></td></tr></table></div>
<h4 id="switch-post-run"><a class="toclink" href="../../ansible-cisco-ios-interface/#switch-post-run">Switch Post Run</a></h4>
<p>Now on the switch as expected we see another Loopback address added.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="l l-Scalar l-Scalar-Plain">sw19#show ip int brie</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="l l-Scalar l-Scalar-Plain">Interface              IP-Address      OK? Method Status                Protocol</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/0     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/1     unassigned      YES unset  administratively down down</span><span class="w">    </span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/2     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/3     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/0     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/1     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/2     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10"></a><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/3     unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="l l-Scalar l-Scalar-Plain">Loopback0              10.100.100.100  YES manual up                    up</span><span class="w">      </span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12"></a><span class="l l-Scalar l-Scalar-Plain">Loopback5              unassigned      YES unset  up                    up</span><span class="w">      </span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="l l-Scalar l-Scalar-Plain">Port-channel5          unassigned      YES unset  down                  down</span><span class="w">    </span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14"></a><span class="l l-Scalar l-Scalar-Plain">Port-channel6          unassigned      YES unset  down                  down</span><span class="w">    </span>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15"></a><span class="l l-Scalar l-Scalar-Plain">Vlan2                  172.16.1.2      YES manual up                    up</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
<h3 id="summary"><a class="toclink" href="../../ansible-cisco-ios-interface/#summary">Summary</a></h3>
<p>Earlier in the week I started using this module in a production environment. I had been using just
<strong>ios_config</strong> and moving down into the interface and issuing the <code>shutdown</code> or <code>no shutdown</code> of an
interface. After coming across a couple of errors I decided to try the <strong>ios_interface</strong> module for
the playbook. This worked out much better. Digging through this module further with this post I am
finding that <strong>ios_interface</strong> is really good for interface state of up/down and the description of
the interface. So you will want to use this in conjunction with the <strong>ios_l3_interface</strong> and
<strong>ios_l2_interface</strong> to get the complete interface configuration with the modules.</p>
<h3 id="appendix"><a class="toclink" href="../../ansible-cisco-ios-interface/#appendix">Appendix</a></h3>
<h4 id="task-with-only-the-required-parameters-loopback10"><a class="toclink" href="../../ansible-cisco-ios-interface/#task-with-only-the-required-parameters-loopback10">Task with only the required Parameters (Loopback10)</a></h4>
<p>First taking a look at the play with using a <em>Loopback10</em> interface. There was previously no
<em>Loopback10</em> interface configured. The play looks like the following:</p>
<h5 id="play"><a class="toclink" href="../../ansible-cisco-ios-interface/#play">Play</a></h5>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="nn">---</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS Interface &gt;&gt; Configure Loopback10</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w">      </span><span class="nt">ios_interface</span><span class="p">:</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Loopback10</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; output</span>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h5 id="play-output"><a class="toclink" href="../../ansible-cisco-ios-interface/#play-output">Play Output</a></h5>
<p>On the output front, nothing surprising. </p>
<p>The commands sent to the device essentially are:</p>
<p><code>config t</code>
<code>interface Loopback10</code></p>
<p>This creates the interface that was not there previously and does not provide any other
configuration.  </p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span>
<span class="normal"><a href="#__codelineno-35-13">13</a></span>
<span class="normal"><a href="#__codelineno-35-14">14</a></span>
<span class="normal"><a href="#__codelineno-35-15">15</a></span>
<span class="normal"><a href="#__codelineno-35-16">16</a></span>
<span class="normal"><a href="#__codelineno-35-17">17</a></span>
<span class="normal"><a href="#__codelineno-35-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="l l-Scalar l-Scalar-Plain">changed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5"></a>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG &gt;&gt; output] *********************************************************</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="w">            </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">Loopback10&quot;</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="w">        </span><span class="p p-Indicator">],</span><span class="w"> </span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15"></a><span class="err">}</span>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16"></a>
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
<h4 id="task-with-only-the-required-parameters-gigabitethernet01"><a class="toclink" href="../../ansible-cisco-ios-interface/#task-with-only-the-required-parameters-gigabitethernet01">Task with only the required Parameters (GigabitEthernet0/1)</a></h4>
<p>In this play the interface being configured will be moved from a Loopback interface to one of the
physical interfaces on the device. There will once again be no parameters.</p>
<h5 id="play_1"><a class="toclink" href="../../ansible-cisco-ios-interface/#play_1">Play</a></h5>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nn">---</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS Interface &gt;&gt; Configure Gig0/1</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="w">      </span><span class="nt">ios_interface</span><span class="p">:</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet0/1</span>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>
</span><span id="__span-36-16"><a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; output</span>
</span><span id="__span-36-17"><a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-36-18"><a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h5 id="output"><a class="toclink" href="../../ansible-cisco-ios-interface/#output">Output</a></h5>
<p>The Ansible module appears to check the running configuration as expected before stepping through.
The output shows no commands being applied as the configuration on the interface already has the
desired configuration (blank).</p>
<p><strong>Pre-Configuration</strong></p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span>
<span class="normal"><a href="#__codelineno-37-5">5</a></span>
<span class="normal"><a href="#__codelineno-37-6">6</a></span>
<span class="normal"><a href="#__codelineno-37-7">7</a></span>
<span class="normal"><a href="#__codelineno-37-8">8</a></span>
<span class="normal"><a href="#__codelineno-37-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="c1">#show run int gig0/1</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="l l-Scalar l-Scalar-Plain">Building configuration...</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="l l-Scalar l-Scalar-Plain">Current configuration</span><span class="w"> </span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">71 bytes</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="kt">!</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6"></a><span class="l l-Scalar l-Scalar-Plain">interface GigabitEthernet0/1</span>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">media-type rj45</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">negotiation auto</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9"></a><span class="l l-Scalar l-Scalar-Plain">end</span>
</span></code></pre></div></td></tr></table></div>
<p>There are no pieces that need to be configured, so the output from the playbook execution is below.
With no other parameters defined the module does nothing.</p>
<p><strong>Play Execution</strong></p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-38-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-38-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-38-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-38-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-38-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-38-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-38-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-38-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-38-10">10</a></span>
<span class="normal"><a href="#__codelineno-38-11">11</a></span>
<span class="normal"><a href="#__codelineno-38-12">12</a></span>
<span class="normal"><a href="#__codelineno-38-13">13</a></span>
<span class="normal"><a href="#__codelineno-38-14">14</a></span>
<span class="normal"><a href="#__codelineno-38-15">15</a></span>
<span class="normal"><a href="#__codelineno-38-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="l l-Scalar l-Scalar-Plain">ok</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5"></a>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG &gt;&gt; output] *********************************************************</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[],</span><span class="w"> </span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13"></a><span class="err">}</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14"></a>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=0    unreachable=0    failed=0</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-03-09 00:00:00">March 9, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              8 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-ios-vlan"><a class="toclink" href="../../ansible-ios-vlan/">Ansible IOS VLAN</a></h2>
<p>Back to it finally. Going to take a look at the Ansible module <strong>ios_vlan</strong>. The purpose of this is
to provide a declarative module for managing VLANs on IOS devices. In this I will be using IOSv-L2
images. There are a few interesting quirks (as I will call it) within the parameters for the module.</p>
<h3 id="module-documentation"><a class="toclink" href="../../ansible-ios-vlan/#module-documentation">Module Documentation</a></h3>
<p>First, the module documentation page is
<a href="https://docs.ansible.com/ansible/latest/modules/ios_vlan_module.html">here</a>.</p>
<h3 id="getting-started-with-the-module"><a class="toclink" href="../../ansible-ios-vlan/#getting-started-with-the-module">Getting Started with the module</a></h3>
<h4 id="vlans-pre-module-work"><a class="toclink" href="../../ansible-ios-vlan/#vlans-pre-module-work">VLANs pre-module work</a></h4>
<p>Starting out the switch is pretty bare as it relates to the number of VLANs. There is VLAN2 defined
on the switch that has an uplink to the edge (of the lab) router. The base VLANs are the only other
ones on the device:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1">#show vlan</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Name                             Status    Ports</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="l l-Scalar l-Scalar-Plain">---- -------------------------------- --------- -------------------------------</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="l l-Scalar l-Scalar-Plain">1    default                          active    Gi0/1, Gi0/3, Gi1/0, Gi1/2</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">                                                </span><span class="l l-Scalar l-Scalar-Plain">Gi1/3</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="l l-Scalar l-Scalar-Plain">2    TRANSIT                          active    Gi0/0, Gi1/1</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi-default                     act/unsup</span><span class="w"> </span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="l l-Scalar l-Scalar-Plain">1003 token-ring-default               act/unsup</span><span class="w"> </span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="l l-Scalar l-Scalar-Plain">1004 fddinet-default                  act/unsup</span><span class="w"> </span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet-default                    act/unsup</span><span class="w"> </span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="l l-Scalar l-Scalar-Plain">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="l l-Scalar l-Scalar-Plain">1    enet  100001     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="l l-Scalar l-Scalar-Plain">2    enet  100002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi  101002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="l l-Scalar l-Scalar-Plain">1003 tr    101003     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="l l-Scalar l-Scalar-Plain">1004 fdnet 101004     1500  -      -      -        ieee -        0      0</span><span class="w">   </span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet 101005     1500  -      -      -        ibm  -        0      0</span><span class="w">   </span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="l l-Scalar l-Scalar-Plain">Remote SPAN VLANs</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="l l-Scalar l-Scalar-Plain">------------------------------------------------------------------------------</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24"></a>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="l l-Scalar l-Scalar-Plain">Primary Secondary Type              Ports</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="l l-Scalar l-Scalar-Plain">------- --------- ----------------- ------------------------------------------</span>
</span></code></pre></div></td></tr></table></div>
<h4 id="building-the-play"><a class="toclink" href="../../ansible-ios-vlan/#building-the-play">Building the Play</a></h4>
<p>The module has the following parameters, required ones in bold. This skips over the deprecated
parameters:</p>
<ul>
<li>aggregate: List of VLANs definitions</li>
<li>associated_interfaces: Checks for the operational state of the interface</li>
<li>delay: default to 10 seconds, how long to wait for the declarative state to be seen</li>
<li>interfaces: a <strong>list</strong> of interfaces that should have the VLAN assigned to it</li>
<li>name: Name of the VLAN</li>
<li>purge: Purge VLANs not defined in the aggregate parameter</li>
<li>state: present/absent/active/suspend - the state that it should be in</li>
<li>vlan_id: ID of the VLAN</li>
</ul>
<p>So what does aggregate mean? It sounds like that if you wanted to have a large list of VLANs, this
is the way to go with a task. First attempt at seeing what it does, the following playbook was setup</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nn">---</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; VLAN Updates</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">      </span><span class="nt">ios_vlan</span><span class="p">:</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">        </span><span class="nt">aggregate</span><span class="p">:</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">        </span><span class="nt">vlan_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TEST VLAN 5</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; VLAN Update</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>When executing it came across an error that gave some more insight that was not portrayed on the
module definition page.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="l l-Scalar l-Scalar-Plain">ansible-playbook output_test.yml -i ./lab_hosts</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="l l-Scalar l-Scalar-Plain">fatal</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FAILED! =&gt; {&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false, &quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;parameters</span><span class="nv"> </span><span class="s">are</span><span class="nv"> </span><span class="s">mutually</span><span class="nv"> </span><span class="s">exclusive:</span><span class="nv"> </span><span class="s">vlan_id,</span><span class="nv"> </span><span class="s">aggregate&quot;</span><span class="err">}</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">to retry, use</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--limit @/Users/joshv/Documents/Ansible/output_test.retry</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=0    changed=0    unreachable=0    failed=1</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
<p>Modifying the playbook with the fatal error message out. It now looks like this:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nn">---</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; VLAN Updates</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">      </span><span class="nt">ios_vlan</span><span class="p">:</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">        </span><span class="nt">aggregate</span><span class="p">:</span><span class="w"> </span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="s">&#39;vlan_id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;TRANSIT&#39;</span><span class="w"> </span><span class="p p-Indicator">}</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="s">&#39;vlan_id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Test</span><span class="nv"> </span><span class="s">VLAN&#39;</span><span class="w"> </span><span class="p p-Indicator">}</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; VLAN Update</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>This will now deploy in aggregate all of the VLANs that are being defined in the list of
dictionaries. Looking at the output this is what is now on the switch:</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1">#show vlan</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Name                             Status    Ports</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="l l-Scalar l-Scalar-Plain">---- -------------------------------- --------- -------------------------------</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="l l-Scalar l-Scalar-Plain">1    default                          active    Gi0/1, Gi0/3, Gi1/0, Gi1/2</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">                                                </span><span class="l l-Scalar l-Scalar-Plain">Gi1/3</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="l l-Scalar l-Scalar-Plain">2    TRANSIT                          active    Gi0/0, Gi1/1</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="l l-Scalar l-Scalar-Plain">5    Test VLAN                        active    Gi0/2</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi-default                     act/unsup</span><span class="w"> </span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="l l-Scalar l-Scalar-Plain">1003 token-ring-default               act/unsup</span><span class="w"> </span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="l l-Scalar l-Scalar-Plain">1004 fddinet-default                  act/unsup</span><span class="w"> </span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet-default                    act/unsup</span><span class="w"> </span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="l l-Scalar l-Scalar-Plain">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="l l-Scalar l-Scalar-Plain">1    enet  100001     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="l l-Scalar l-Scalar-Plain">2    enet  100002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="l l-Scalar l-Scalar-Plain">5    enet  100005     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi  101002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="l l-Scalar l-Scalar-Plain">1003 tr    101003     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="l l-Scalar l-Scalar-Plain">1004 fdnet 101004     1500  -      -      -        ieee -        0      0</span><span class="w">   </span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet 101005     1500  -      -      -        ibm  -        0      0</span><span class="w">   </span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="l l-Scalar l-Scalar-Plain">Remote SPAN VLANs</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="l l-Scalar l-Scalar-Plain">------------------------------------------------------------------------------</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26"></a>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27"></a>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="l l-Scalar l-Scalar-Plain">Primary Secondary Type              Ports</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="l l-Scalar l-Scalar-Plain">------- --------- ----------------- ------------------------------------------</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="changing-the-vlans-on-the-device"><a class="toclink" href="../../ansible-ios-vlan/#changing-the-vlans-on-the-device">Changing the VLANs on the device</a></h3>
<p>Removing a VLAN that is not supposed to be on the device is incredibly simple with this
<strong>aggregate</strong> feature as well. If we change the play to looking like this</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nn">---</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; VLAN Updates</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">      </span><span class="nt">ios_vlan</span><span class="p">:</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">        </span><span class="nt">aggregate</span><span class="p">:</span><span class="w"> </span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="s">&#39;vlan_id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;TRANSIT&#39;</span><span class="p p-Indicator">,</span><span class="nt"> state</span><span class="p">:</span><span class="w"> </span><span class="nv">present</span><span class="w"> </span><span class="p p-Indicator">}</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="s">&#39;vlan_id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Test</span><span class="nv"> </span><span class="s">VLAN&#39;</span><span class="p p-Indicator">,</span><span class="nt"> state</span><span class="p">:</span><span class="w"> </span><span class="nv">absent</span><span class="w"> </span><span class="p p-Indicator">}</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; VLAN Update</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>The resulting play execution shows that the VLAN is removed from the command output.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="l l-Scalar l-Scalar-Plain">changed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG &gt;&gt; VLAN Update] ****************************************************</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">5&quot;</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">        </span><span class="p p-Indicator">],</span><span class="w"> </span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="err">}</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
<h4 id="adding-a-vlan-and-assigning-to-interface"><a class="toclink" href="../../ansible-ios-vlan/#adding-a-vlan-and-assigning-to-interface">Adding a VLAN and assigning to Interface</a></h4>
<p>Want to create an interface and assign it to a VLAN quickly? Here is where the <strong>ios_vlan</strong> module
may be able to help very quickly. In the lab it is very simple as there are only a few interfaces
on the layer 2 switch that we have.</p>
<h5 id="play-definition"><a class="toclink" href="../../ansible-ios-vlan/#play-definition">Play Definition</a></h5>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nn">---</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; VLAN Updates</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">      </span><span class="nt">ios_vlan</span><span class="p">:</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">        </span><span class="nt">vlan_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-vlan</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">        </span><span class="nt">interfaces</span><span class="p">:</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GigabitEthernet1/2</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; VLAN Update</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h5 id="playbook-execution-adding-a-vlan"><a class="toclink" href="../../ansible-ios-vlan/#playbook-execution-adding-a-vlan">Playbook Execution - Adding a VLAN</a></h5>
<p>This play execution will both add a VLAN to the switch, and assign the interfaces to the VLAN as an
access port. With the output from the execution the module registers each of the commands that are
being issued to the switch. This shows the VLAN is first created, then goes into the interface
assigned as a parameter. Lastly it sets that interface to being an access interface in the VLAN.</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="l l-Scalar l-Scalar-Plain">changed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG &gt;&gt; VLAN Update] ****************************************************</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="w">            </span><span class="s">&quot;vlan</span><span class="nv"> </span><span class="s">12&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">            </span><span class="s">&quot;name</span><span class="nv"> </span><span class="s">test-vlan&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">            </span><span class="s">&quot;interface</span><span class="nv"> </span><span class="s">GigabitEthernet1/2&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">            </span><span class="s">&quot;switchport</span><span class="nv"> </span><span class="s">mode</span><span class="nv"> </span><span class="s">access&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="w">            </span><span class="s">&quot;switchport</span><span class="nv"> </span><span class="s">access</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">12&quot;</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="w">        </span><span class="p p-Indicator">],</span><span class="w"> </span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="err">}</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20"></a>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0</span><span class="w">   </span>
</span></code></pre></div></td></tr></table></div>
<h4 id="ios_vlan-purge-parameter"><a class="toclink" href="../../ansible-ios-vlan/#ios_vlan-purge-parameter">IOS_VLAN - Purge Parameter</a></h4>
<p>Originally when looking at this module I kind of passed over <strong>purge</strong> parameter. It was mentioned
that this is used with conjunction of the <strong>aggregrate</strong> parameter. My original thinking when I read
<em>aggregate</em> was that this was somehow related to Link Aggregation Control Protocol. Now with looking
at the module much more in depth, I see that was a wrong assumption (in case it was for others).
This adds significant power, to make sure that a switch is configured the way that you define within
a play/task and stays configured that way. If some rogue actor has added a VLAN, how will you ever
know. So for this next test, I went and created three manual VLANs on the switch for VLANs 10, 13,
and 100. </p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span>
<span class="normal"><a href="#__codelineno-9-18">18</a></span>
<span class="normal"><a href="#__codelineno-9-19">19</a></span>
<span class="normal"><a href="#__codelineno-9-20">20</a></span>
<span class="normal"><a href="#__codelineno-9-21">21</a></span>
<span class="normal"><a href="#__codelineno-9-22">22</a></span>
<span class="normal"><a href="#__codelineno-9-23">23</a></span>
<span class="normal"><a href="#__codelineno-9-24">24</a></span>
<span class="normal"><a href="#__codelineno-9-25">25</a></span>
<span class="normal"><a href="#__codelineno-9-26">26</a></span>
<span class="normal"><a href="#__codelineno-9-27">27</a></span>
<span class="normal"><a href="#__codelineno-9-28">28</a></span>
<span class="normal"><a href="#__codelineno-9-29">29</a></span>
<span class="normal"><a href="#__codelineno-9-30">30</a></span>
<span class="normal"><a href="#__codelineno-9-31">31</a></span>
<span class="normal"><a href="#__codelineno-9-32">32</a></span>
<span class="normal"><a href="#__codelineno-9-33">33</a></span>
<span class="normal"><a href="#__codelineno-9-34">34</a></span>
<span class="normal"><a href="#__codelineno-9-35">35</a></span>
<span class="normal"><a href="#__codelineno-9-36">36</a></span>
<span class="normal"><a href="#__codelineno-9-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Name                             Status    Ports</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="l l-Scalar l-Scalar-Plain">---- -------------------------------- --------- -------------------------------</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="l l-Scalar l-Scalar-Plain">1    default                          active    Gi0/1, Gi0/3, Gi1/0, Gi1/3</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="l l-Scalar l-Scalar-Plain">2    TRANSIT                          active    Gi0/0, Gi1/1</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="l l-Scalar l-Scalar-Plain">5    Test VLAN                        active    Gi0/2</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="l l-Scalar l-Scalar-Plain">10   MANUAL                           active</span><span class="w">    </span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="l l-Scalar l-Scalar-Plain">12   QB VLAN                          active    Gi1/2</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="l l-Scalar l-Scalar-Plain">13   MANUAL13                         active</span><span class="w">    </span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="l l-Scalar l-Scalar-Plain">100  MANUAL100                        active</span><span class="w">    </span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi-default                     act/unsup</span><span class="w"> </span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="l l-Scalar l-Scalar-Plain">1003 token-ring-default               act/unsup</span><span class="w"> </span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="l l-Scalar l-Scalar-Plain">1004 fddinet-default                  act/unsup</span><span class="w"> </span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet-default                    act/unsup</span><span class="w"> </span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14"></a>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="l l-Scalar l-Scalar-Plain">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="l l-Scalar l-Scalar-Plain">1    enet  100001     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="l l-Scalar l-Scalar-Plain">2    enet  100002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="l l-Scalar l-Scalar-Plain">5    enet  100005     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="l l-Scalar l-Scalar-Plain">10   enet  100010     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="l l-Scalar l-Scalar-Plain">12   enet  100012     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="l l-Scalar l-Scalar-Plain">13   enet  100013     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23"></a>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25"></a><span class="l l-Scalar l-Scalar-Plain">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26"></a><span class="l l-Scalar l-Scalar-Plain">100  enet  100100     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi  101002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28"></a><span class="l l-Scalar l-Scalar-Plain">1003 tr    101003     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29"></a><span class="l l-Scalar l-Scalar-Plain">1004 fdnet 101004     1500  -      -      -        ieee -        0      0</span><span class="w">   </span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet 101005     1500  -      -      -        ibm  -        0      0</span><span class="w">   </span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31"></a>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32"></a><span class="l l-Scalar l-Scalar-Plain">Remote SPAN VLANs</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33"></a><span class="l l-Scalar l-Scalar-Plain">------------------------------------------------------------------------------</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34"></a>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35"></a>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36"></a><span class="l l-Scalar l-Scalar-Plain">Primary Secondary Type              Ports</span>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37"></a><span class="l l-Scalar l-Scalar-Plain">------- --------- ----------------- ------------------------------------------</span>
</span></code></pre></div></td></tr></table></div>
<h5 id="play-setup-purge-vlans"><a class="toclink" href="../../ansible-ios-vlan/#play-setup-purge-vlans">Play Setup - Purge VLANs</a></h5>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nn">---</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sw19</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; VLAN Updates</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">      </span><span class="nt">ios_vlan</span><span class="p">:</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">        </span><span class="nt">aggregate</span><span class="p">:</span><span class="w"> </span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="s">&#39;vlan_id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;TRANSIT&#39;</span><span class="p p-Indicator">,</span><span class="nt"> state</span><span class="p">:</span><span class="w"> </span><span class="nv">present</span><span class="w"> </span><span class="p p-Indicator">}</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="s">&#39;vlan_id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Test</span><span class="nv"> </span><span class="s">VLAN&#39;</span><span class="p p-Indicator">,</span><span class="nt"> state</span><span class="p">:</span><span class="w"> </span><span class="nv">present</span><span class="w"> </span><span class="p p-Indicator">}</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="w"> </span><span class="s">&#39;vlan_id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;THE</span><span class="nv"> </span><span class="s">TEST</span><span class="nv"> </span><span class="s">VLAN&#39;</span><span class="p p-Indicator">,</span><span class="nt"> state</span><span class="p">:</span><span class="w"> </span><span class="nv">present</span><span class="w"> </span><span class="p p-Indicator">}</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">        </span><span class="nt">purge</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; VLAN Update</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h5 id="play-execution"><a class="toclink" href="../../ansible-ios-vlan/#play-execution">PLAY EXECUTION</a></h5>
<p>Below you will find the play execution and the resulting commands sent to the switch. To show this
I did have to run the playbook twice as the bug that I found did not run properly the first time.</p>
<blockquote>
<p>One <strong>important</strong> note that I did find when testing this playbook, at least within Ansible version
2.7.5 to use the <em>purge</em> function, you <strong>must</strong> use the keyword <strong>yes</strong> instead of <em>true</em>. If you
use <em>true</em> the purge function will not work.</p>
</blockquote>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span>
<span class="normal"><a href="#__codelineno-11-12">12</a></span>
<span class="normal"><a href="#__codelineno-11-13">13</a></span>
<span class="normal"><a href="#__codelineno-11-14">14</a></span>
<span class="normal"><a href="#__codelineno-11-15">15</a></span>
<span class="normal"><a href="#__codelineno-11-16">16</a></span>
<span class="normal"><a href="#__codelineno-11-17">17</a></span>
<span class="normal"><a href="#__codelineno-11-18">18</a></span>
<span class="normal"><a href="#__codelineno-11-19">19</a></span>
<span class="normal"><a href="#__codelineno-11-20">20</a></span>
<span class="normal"><a href="#__codelineno-11-21">21</a></span>
<span class="normal"><a href="#__codelineno-11-22">22</a></span>
<span class="normal"><a href="#__codelineno-11-23">23</a></span>
<span class="normal"><a href="#__codelineno-11-24">24</a></span>
<span class="normal"><a href="#__codelineno-11-25">25</a></span>
<span class="normal"><a href="#__codelineno-11-26">26</a></span>
<span class="normal"><a href="#__codelineno-11-27">27</a></span>
<span class="normal"><a href="#__codelineno-11-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="l l-Scalar l-Scalar-Plain">PLAY [Switch config] ***********************************************************</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="l l-Scalar l-Scalar-Plain">TASK [IOS &gt;&gt; VLAN Updates] *****************************************************</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="l l-Scalar l-Scalar-Plain">changed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="l l-Scalar l-Scalar-Plain">TASK [DEBUG &gt;&gt; VLAN Update] ****************************************************</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="nt">ok</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">sw19</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">=&gt; {</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&quot;msg&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">        </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">        </span><span class="s">&quot;commands&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="w">            </span><span class="s">&quot;vlan</span><span class="nv"> </span><span class="s">5&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12"></a><span class="w">            </span><span class="s">&quot;name</span><span class="nv"> </span><span class="s">Test</span><span class="nv"> </span><span class="s">VLAN&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13"></a><span class="w">            </span><span class="s">&quot;vlan</span><span class="nv"> </span><span class="s">12&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14"></a><span class="w">            </span><span class="s">&quot;name</span><span class="nv"> </span><span class="s">THE</span><span class="nv"> </span><span class="s">TEST</span><span class="nv"> </span><span class="s">VLAN&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">10&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">13&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">100&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">1002&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">1003&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">1004&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21"></a><span class="w">            </span><span class="s">&quot;no</span><span class="nv"> </span><span class="s">vlan</span><span class="nv"> </span><span class="s">1005&quot;</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22"></a><span class="w">        </span><span class="p p-Indicator">],</span><span class="w"> </span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23"></a><span class="w">        </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24"></a><span class="w">    </span><span class="p p-Indicator">}</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25"></a><span class="err">}</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26"></a>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27"></a><span class="l l-Scalar l-Scalar-Plain">PLAY RECAP *********************************************************************</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28"></a><span class="nt">sw19                       </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ok=2    changed=1    unreachable=0    failed=0</span><span class="w">  </span>
</span></code></pre></div></td></tr></table></div>
<h5 id="resulting-vlan-configuration"><a class="toclink" href="../../ansible-ios-vlan/#resulting-vlan-configuration">Resulting VLAN Configuration</a></h5>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-12-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-12-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-12-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-12-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-12-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-12-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-12-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-12-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-12-10">10</a></span>
<span class="normal"><a href="#__codelineno-12-11">11</a></span>
<span class="normal"><a href="#__codelineno-12-12">12</a></span>
<span class="normal"><a href="#__codelineno-12-13">13</a></span>
<span class="normal"><a href="#__codelineno-12-14">14</a></span>
<span class="normal"><a href="#__codelineno-12-15">15</a></span>
<span class="normal"><a href="#__codelineno-12-16">16</a></span>
<span class="normal"><a href="#__codelineno-12-17">17</a></span>
<span class="normal"><a href="#__codelineno-12-18">18</a></span>
<span class="normal"><a href="#__codelineno-12-19">19</a></span>
<span class="normal"><a href="#__codelineno-12-20">20</a></span>
<span class="normal"><a href="#__codelineno-12-21">21</a></span>
<span class="normal"><a href="#__codelineno-12-22">22</a></span>
<span class="normal"><a href="#__codelineno-12-23">23</a></span>
<span class="normal"><a href="#__codelineno-12-24">24</a></span>
<span class="normal"><a href="#__codelineno-12-25">25</a></span>
<span class="normal"><a href="#__codelineno-12-26">26</a></span>
<span class="normal"><a href="#__codelineno-12-27">27</a></span>
<span class="normal"><a href="#__codelineno-12-28">28</a></span>
<span class="normal"><a href="#__codelineno-12-29">29</a></span>
<span class="normal"><a href="#__codelineno-12-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="c1">#show vlan</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Name                             Status    Ports</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="l l-Scalar l-Scalar-Plain">---- -------------------------------- --------- -------------------------------</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="l l-Scalar l-Scalar-Plain">1    default                          active    Gi0/1, Gi0/3, Gi1/0, Gi1/3</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="l l-Scalar l-Scalar-Plain">2    TRANSIT                          active    Gi0/0, Gi1/1</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="l l-Scalar l-Scalar-Plain">5    Test VLAN                        active    Gi0/2</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="l l-Scalar l-Scalar-Plain">12   THE TEST VLAN                    active    Gi1/2</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi-default                     act/unsup</span><span class="w"> </span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="l l-Scalar l-Scalar-Plain">1003 token-ring-default               act/unsup</span><span class="w"> </span>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="l l-Scalar l-Scalar-Plain">1004 fddinet-default                  act/unsup</span><span class="w"> </span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet-default                    act/unsup</span><span class="w"> </span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13"></a>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="l l-Scalar l-Scalar-Plain">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span>
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="l l-Scalar l-Scalar-Plain">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span>
</span><span id="__span-12-16"><a id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="l l-Scalar l-Scalar-Plain">1    enet  100001     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-12-17"><a id="__codelineno-12-17" name="__codelineno-12-17"></a><span class="l l-Scalar l-Scalar-Plain">2    enet  100002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-12-18"><a id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="l l-Scalar l-Scalar-Plain">5    enet  100005     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-12-19"><a id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="l l-Scalar l-Scalar-Plain">12   enet  100012     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-12-20"><a id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="l l-Scalar l-Scalar-Plain">1002 fddi  101002     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-12-21"><a id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="l l-Scalar l-Scalar-Plain">1003 tr    101003     1500  -      -      -        -    -        0      0</span><span class="w">   </span>
</span><span id="__span-12-22"><a id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="l l-Scalar l-Scalar-Plain">1004 fdnet 101004     1500  -      -      -        ieee -        0      0</span><span class="w">   </span>
</span><span id="__span-12-23"><a id="__codelineno-12-23" name="__codelineno-12-23"></a><span class="l l-Scalar l-Scalar-Plain">1005 trnet 101005     1500  -      -      -        ibm  -        0      0</span><span class="w">   </span>
</span><span id="__span-12-24"><a id="__codelineno-12-24" name="__codelineno-12-24"></a>
</span><span id="__span-12-25"><a id="__codelineno-12-25" name="__codelineno-12-25"></a><span class="l l-Scalar l-Scalar-Plain">Remote SPAN VLANs</span>
</span><span id="__span-12-26"><a id="__codelineno-12-26" name="__codelineno-12-26"></a><span class="l l-Scalar l-Scalar-Plain">------------------------------------------------------------------------------</span>
</span><span id="__span-12-27"><a id="__codelineno-12-27" name="__codelineno-12-27"></a>
</span><span id="__span-12-28"><a id="__codelineno-12-28" name="__codelineno-12-28"></a>
</span><span id="__span-12-29"><a id="__codelineno-12-29" name="__codelineno-12-29"></a><span class="l l-Scalar l-Scalar-Plain">Primary Secondary Type              Ports</span>
</span><span id="__span-12-30"><a id="__codelineno-12-30" name="__codelineno-12-30"></a><span class="l l-Scalar l-Scalar-Plain">------- --------- ----------------- ------------------------------------------</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="summary"><a class="toclink" href="../../ansible-ios-vlan/#summary">Summary</a></h3>
<p>In summary there are some pieces that need to get worked out. This was the first time that I had
taken a look at the module. For the work that I've done previously I was just using Jinja2 templates
to assign VLAN configuration to an interface. Looking closer at this module there is a lot of power
to make sure that the proper VLANs are configured everywhere that you need, and be able to eliminate
others. This module is definitely something that you should keep in your pocket.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-02-10 00:00:00">February 10, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              4 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-ios-banner"><a class="toclink" href="../../ansible-ios-banner/">Ansible IOS Banner</a></h2>
<p>Today's post is going to be a short and sweet one (unless I get to writing two). I'm going to take a
look at <code>ios_banner</code> module. This one is pretty much straight to the point, what it states,
modifying the banner on an IOS device. There are multiple reasons to want to manipulate the banner
on a Cisco device. We will leave those reasons to you and the organization that you are a part of
for that. For now, we will take a real quick look at the module.</p>
<h3 id="module-documentation"><a class="toclink" href="../../ansible-ios-banner/#module-documentation">Module Documentation</a></h3>
<p>First, the module documentation page is
<a href="https://docs.ansible.com/ansible/latest/collections/cisco/ios/ios_banner_module.html">here</a>.</p>
<h3 id="getting-started-with-the-lab"><a class="toclink" href="../../ansible-ios-banner/#getting-started-with-the-lab">Getting Started with the Lab</a></h3>
<p>I'm starting out with no banner on the page of my system as evident from this login:</p>
<p><strong>Cisco Router Login</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>Escape<span class="w"> </span>character<span class="w"> </span>is<span class="w"> </span><span class="s1">&#39;^]&#39;</span>.
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a>Username:<span class="w"> </span>
</span></code></pre></div></td></tr></table></div>
<h4 id="ios-banner-play-tasks"><a class="toclink" href="../../ansible-ios-banner/#ios-banner-play-tasks">IOS Banner Play / tasks</a></h4>
<p>Let's go ahead and apply a banner to the login with the following tasks:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; Set banner to single login</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">      </span><span class="nt">ios_banner</span><span class="p">:</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">        </span><span class="nt">banner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">login</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">        </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Quick</span><span class="nv"> </span><span class="s">banner,</span><span class="nv"> </span><span class="s">this</span><span class="nv"> </span><span class="s">device</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">being</span><span class="nv"> </span><span class="s">managed</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">Ansible.&quot;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; Output</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>I now have the following banner showing up on the login to the Cisco device over SSH.</p>
<p><strong>Banner on Router</strong></p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>Quick<span class="w"> </span>banner,<span class="w"> </span>this<span class="w"> </span>device<span class="w"> </span>is<span class="w"> </span>being<span class="w"> </span>managed<span class="w"> </span>by<span class="w"> </span>Ansible.
</span></code></pre></div></td></tr></table></div>
<h4 id="output-of-ios_banner"><a class="toclink" href="../../ansible-ios-banner/#output-of-ios_banner">Output of ios_banner</a></h4>
<p>Let's take a look at the output of the <code>ios_banner</code> module when saved to a variable. We get the
following output to the screen:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span>&gt;&gt;<span class="w"> </span>Output<span class="o">]</span><span class="w"> </span>*********************************************************
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>ok:<span class="w"> </span><span class="o">[</span>rtr01<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">            </span><span class="s2">&quot;banner login @\nQuick banner, this device is being managed by Ansible.\n@&quot;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="o">}</span>
</span></code></pre></div></td></tr></table></div>
<p>There are three "outputs" to the variable. Changed, commands, and failed. </p>
<p><strong>Changed</strong> looks to be the true/false of was the device changed as part of the play execution.<br />
<strong>comamnds</strong> are what actually was run on the Cisco device from config mode.<br />
<strong>failed</strong> is the state of the task, true/false</p>
<h3 id="multiline-banner"><a class="toclink" href="../../ansible-ios-banner/#multiline-banner">Multiline banner</a></h3>
<p>To set a multi-line banner on something, it is as simple as using the <code>|</code> or <code>&gt;</code> keys that are part
of YAML. These again are functions known within YAML and not something specific to Ansible, so this
is something that would carry over between languages/tools that are using YAML as the formatting.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; Set banner to single login</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">      </span><span class="nt">ios_banner</span><span class="p">:</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">        </span><span class="nt">banner</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">login</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">          </span><span class="no">===This device is being managed by Ansible===</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">          </span><span class="no">Making changes at your own risk!</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; Output</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p>This has successfully added a multiple line banner to the configuration:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a>TASK<span class="w"> </span><span class="o">[</span>IOS<span class="w"> </span>&gt;&gt;<span class="w"> </span>Set<span class="w"> </span>banner<span class="w"> </span>to<span class="w"> </span>single<span class="w"> </span>login<span class="o">]</span><span class="w"> </span>***************************************
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>changed:<span class="w"> </span><span class="o">[</span>rtr01<span class="o">]</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span>&gt;&gt;<span class="w"> </span>Output<span class="o">]</span><span class="w"> </span>*********************************************************
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a>ok:<span class="w"> </span><span class="o">[</span>rtr01<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">        </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">            </span><span class="s2">&quot;banner login @\n===This device is being managed by Ansible===\nMaki</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="s2">ng changes at your own risk!\n@&quot;</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">        </span><span class="o">]</span>,
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w">        </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="o">}</span>
</span></code></pre></div></td></tr></table></div>
<p>A quick look at the configuration itself in IOS:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a>!
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>banner<span class="w"> </span>login<span class="w"> </span>^C
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="o">===</span>This<span class="w"> </span>device<span class="w"> </span>is<span class="w"> </span>being<span class="w"> </span>managed<span class="w"> </span>by<span class="w"> </span><span class="nv">Ansible</span><span class="o">===</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>Making<span class="w"> </span>changes<span class="w"> </span>at<span class="w"> </span>your<span class="w"> </span>own<span class="w"> </span>risk!
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>^C
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a>!
</span></code></pre></div></td></tr></table></div>
<p>This automatically puts the <code>^C</code> as the character delineation for you, as that was not something
that was specified within the module itself.</p>
<h3 id="setting-multiple-banners"><a class="toclink" href="../../ansible-ios-banner/#setting-multiple-banners">Setting Multiple Banners</a></h3>
<p>If you want to set multiple banners, say <code>exec</code>, <code>login</code>, and <code>motd</code>, you will want to change this
to leveraging <code>with_items</code>. This way Ansible will iterate and set all of these. Here is the Play.</p>
<p>Notice the changes on line 3 below has been changed from the banner <code>login</code> to the variable
<code>{{ item }}</code>. <code>with_items</code> has been added on line 8. And we have set this to change the banner for
<code>motd</code> (Message of the Day), <code>login</code>, and <code>exec</code>. </p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IOS &gt;&gt; Set banner to single login</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">      </span><span class="nt">ios_banner</span><span class="p">:</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">        </span><span class="nt">banner</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">item</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">        </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">present</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">        </span><span class="nt">text</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">          </span><span class="no">===This device is being managed by Ansible===</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">          </span><span class="no">Making changes at your own risk!</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">      </span><span class="nt">with_items</span><span class="p">:</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">motd</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">login</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">exec</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; Output</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">output</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<p><strong>Output</strong>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span>
<span class="normal"><a href="#__codelineno-8-29">29</a></span>
<span class="normal"><a href="#__codelineno-8-30">30</a></span>
<span class="normal"><a href="#__codelineno-8-31">31</a></span>
<span class="normal"><a href="#__codelineno-8-32">32</a></span>
<span class="normal"><a href="#__codelineno-8-33">33</a></span>
<span class="normal"><a href="#__codelineno-8-34">34</a></span>
<span class="normal"><a href="#__codelineno-8-35">35</a></span>
<span class="normal"><a href="#__codelineno-8-36">36</a></span>
<span class="normal"><a href="#__codelineno-8-37">37</a></span>
<span class="normal"><a href="#__codelineno-8-38">38</a></span>
<span class="normal"><a href="#__codelineno-8-39">39</a></span>
<span class="normal"><a href="#__codelineno-8-40">40</a></span>
<span class="normal"><a href="#__codelineno-8-41">41</a></span>
<span class="normal"><a href="#__codelineno-8-42">42</a></span>
<span class="normal"><a href="#__codelineno-8-43">43</a></span>
<span class="normal"><a href="#__codelineno-8-44">44</a></span>
<span class="normal"><a href="#__codelineno-8-45">45</a></span>
<span class="normal"><a href="#__codelineno-8-46">46</a></span>
<span class="normal"><a href="#__codelineno-8-47">47</a></span>
<span class="normal"><a href="#__codelineno-8-48">48</a></span>
<span class="normal"><a href="#__codelineno-8-49">49</a></span>
<span class="normal"><a href="#__codelineno-8-50">50</a></span>
<span class="normal"><a href="#__codelineno-8-51">51</a></span>
<span class="normal"><a href="#__codelineno-8-52">52</a></span>
<span class="normal"><a href="#__codelineno-8-53">53</a></span>
<span class="normal"><a href="#__codelineno-8-54">54</a></span>
<span class="normal"><a href="#__codelineno-8-55">55</a></span>
<span class="normal"><a href="#__codelineno-8-56">56</a></span>
<span class="normal"><a href="#__codelineno-8-57">57</a></span>
<span class="normal"><a href="#__codelineno-8-58">58</a></span>
<span class="normal"><a href="#__codelineno-8-59">59</a></span>
<span class="normal"><a href="#__codelineno-8-60">60</a></span>
<span class="normal"><a href="#__codelineno-8-61">61</a></span>
<span class="normal"><a href="#__codelineno-8-62">62</a></span>
<span class="normal"><a href="#__codelineno-8-63">63</a></span>
<span class="normal"><a href="#__codelineno-8-64">64</a></span>
<span class="normal"><a href="#__codelineno-8-65">65</a></span>
<span class="normal"><a href="#__codelineno-8-66">66</a></span>
<span class="normal"><a href="#__codelineno-8-67">67</a></span>
<span class="normal"><a href="#__codelineno-8-68">68</a></span>
<span class="normal"><a href="#__codelineno-8-69">69</a></span>
<span class="normal"><a href="#__codelineno-8-70">70</a></span>
<span class="normal"><a href="#__codelineno-8-71">71</a></span>
<span class="normal"><a href="#__codelineno-8-72">72</a></span>
<span class="normal"><a href="#__codelineno-8-73">73</a></span>
<span class="normal"><a href="#__codelineno-8-74">74</a></span>
<span class="normal"><a href="#__codelineno-8-75">75</a></span>
<span class="normal"><a href="#__codelineno-8-76">76</a></span>
<span class="normal"><a href="#__codelineno-8-77">77</a></span>
<span class="normal"><a href="#__codelineno-8-78">78</a></span>
<span class="normal"><a href="#__codelineno-8-79">79</a></span>
<span class="normal"><a href="#__codelineno-8-80">80</a></span>
<span class="normal"><a href="#__codelineno-8-81">81</a></span>
<span class="normal"><a href="#__codelineno-8-82">82</a></span>
<span class="normal"><a href="#__codelineno-8-83">83</a></span>
<span class="normal"><a href="#__codelineno-8-84">84</a></span>
<span class="normal"><a href="#__codelineno-8-85">85</a></span>
<span class="normal"><a href="#__codelineno-8-86">86</a></span>
<span class="normal"><a href="#__codelineno-8-87">87</a></span>
<span class="normal"><a href="#__codelineno-8-88">88</a></span>
<span class="normal"><a href="#__codelineno-8-89">89</a></span>
<span class="normal"><a href="#__codelineno-8-90">90</a></span>
<span class="normal"><a href="#__codelineno-8-91">91</a></span>
<span class="normal"><a href="#__codelineno-8-92">92</a></span>
<span class="normal"><a href="#__codelineno-8-93">93</a></span>
<span class="normal"><a href="#__codelineno-8-94">94</a></span>
<span class="normal"><a href="#__codelineno-8-95">95</a></span>
<span class="normal"><a href="#__codelineno-8-96">96</a></span>
<span class="normal"><a href="#__codelineno-8-97">97</a></span>
<span class="normal"><a href="#__codelineno-8-98">98</a></span>
<span class="normal"><a href="#__codelineno-8-99">99</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>TASK<span class="w"> </span><span class="o">[</span>IOS<span class="w"> </span>&gt;&gt;<span class="w"> </span>Set<span class="w"> </span>banner<span class="w"> </span>to<span class="w"> </span>single<span class="w"> </span>login<span class="o">]</span><span class="w"> </span>***************************************
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>changed:<span class="w"> </span><span class="o">[</span>rtr01<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">(</span><span class="nv">item</span><span class="o">=</span>motd<span class="o">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>ok:<span class="w"> </span><span class="o">[</span>rtr01<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">(</span><span class="nv">item</span><span class="o">=</span>login<span class="o">)</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>changed:<span class="w"> </span><span class="o">[</span>rtr01<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">(</span><span class="nv">item</span><span class="o">=</span><span class="nb">exec</span><span class="o">)</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span>&gt;&gt;<span class="w"> </span>Output<span class="o">]</span><span class="w"> </span>*********************************************************
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a>ok:<span class="w"> </span><span class="o">[</span>rtr01<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="w">        </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="w">        </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="s2">&quot;All items completed&quot;</span>,
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="w">        </span><span class="s2">&quot;results&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">                </span><span class="s2">&quot;_ansible_ignore_errors&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">                </span><span class="s2">&quot;_ansible_item_label&quot;</span>:<span class="w"> </span><span class="s2">&quot;motd&quot;</span>,
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="w">                </span><span class="s2">&quot;_ansible_item_result&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="w">                </span><span class="s2">&quot;_ansible_no_log&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17"></a><span class="w">                </span><span class="s2">&quot;_ansible_parsed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="w">                </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="w">                </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="w">                    </span><span class="s2">&quot;banner motd @\n===This device is being managed by Ansible===\nMaking changes at your own risk!\n@&quot;</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="w">                </span><span class="o">]</span>,
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="w">                </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="w">                </span><span class="s2">&quot;invocation&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24"></a><span class="w">                    </span><span class="s2">&quot;module_args&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25"></a><span class="w">                        </span><span class="s2">&quot;auth_pass&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="w">                        </span><span class="s2">&quot;authorize&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="w">                        </span><span class="s2">&quot;banner&quot;</span>:<span class="w"> </span><span class="s2">&quot;motd&quot;</span>,
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28"></a><span class="w">                        </span><span class="s2">&quot;host&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29"></a><span class="w">                        </span><span class="s2">&quot;password&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30"></a><span class="w">                        </span><span class="s2">&quot;port&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31"></a><span class="w">                        </span><span class="s2">&quot;provider&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32"></a><span class="w">                        </span><span class="s2">&quot;ssh_keyfile&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33"></a><span class="w">                        </span><span class="s2">&quot;state&quot;</span>:<span class="w"> </span><span class="s2">&quot;present&quot;</span>,
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34"></a><span class="w">                        </span><span class="s2">&quot;text&quot;</span>:<span class="w"> </span><span class="s2">&quot;===This device is being managed by Ansible===\nMaking changes at your own risk!\n&quot;</span>,
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35"></a><span class="w">                        </span><span class="s2">&quot;timeout&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36"></a><span class="w">                        </span><span class="s2">&quot;username&quot;</span>:<span class="w"> </span>null
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37"></a><span class="w">                    </span><span class="o">}</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38"></a><span class="w">                </span><span class="o">}</span>,
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39"></a><span class="w">                </span><span class="s2">&quot;item&quot;</span>:<span class="w"> </span><span class="s2">&quot;motd&quot;</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42"></a><span class="w">                </span><span class="s2">&quot;_ansible_ignore_errors&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43"></a><span class="w">                </span><span class="s2">&quot;_ansible_item_label&quot;</span>:<span class="w"> </span><span class="s2">&quot;login&quot;</span>,
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44"></a><span class="w">                </span><span class="s2">&quot;_ansible_item_result&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45"></a><span class="w">                </span><span class="s2">&quot;_ansible_no_log&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46"></a><span class="w">                </span><span class="s2">&quot;_ansible_parsed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47"></a><span class="w">                </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48"></a><span class="w">                </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[]</span>,
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49"></a><span class="w">                </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50"></a><span class="w">                </span><span class="s2">&quot;invocation&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51"></a><span class="w">                    </span><span class="s2">&quot;module_args&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52"></a><span class="w">                        </span><span class="s2">&quot;auth_pass&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53"></a><span class="w">                        </span><span class="s2">&quot;authorize&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54"></a><span class="w">                        </span><span class="s2">&quot;banner&quot;</span>:<span class="w"> </span><span class="s2">&quot;login&quot;</span>,
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55"></a><span class="w">                        </span><span class="s2">&quot;host&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56"></a><span class="w">                        </span><span class="s2">&quot;password&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57"></a><span class="w">                        </span><span class="s2">&quot;port&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58"></a><span class="w">                        </span><span class="s2">&quot;provider&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59"></a><span class="w">                        </span><span class="s2">&quot;ssh_keyfile&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60"></a><span class="w">                        </span><span class="s2">&quot;state&quot;</span>:<span class="w"> </span><span class="s2">&quot;present&quot;</span>,
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61"></a><span class="w">                        </span><span class="s2">&quot;text&quot;</span>:<span class="w"> </span><span class="s2">&quot;===This device is being managed by Ansible===\nMaking changes at your own risk!\n&quot;</span>,
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62"></a><span class="w">                        </span><span class="s2">&quot;timeout&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63"></a><span class="w">                        </span><span class="s2">&quot;username&quot;</span>:<span class="w"> </span>null
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64"></a><span class="w">                    </span><span class="o">}</span>
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65"></a><span class="w">                </span><span class="o">}</span>,
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66"></a><span class="w">                </span><span class="s2">&quot;item&quot;</span>:<span class="w"> </span><span class="s2">&quot;login&quot;</span>
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67"></a><span class="w">            </span><span class="o">}</span>,
</span><span id="__span-8-68"><a id="__codelineno-8-68" name="__codelineno-8-68"></a><span class="w">            </span><span class="o">{</span>
</span><span id="__span-8-69"><a id="__codelineno-8-69" name="__codelineno-8-69"></a><span class="w">                </span><span class="s2">&quot;_ansible_ignore_errors&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-70"><a id="__codelineno-8-70" name="__codelineno-8-70"></a><span class="w">                </span><span class="s2">&quot;_ansible_item_label&quot;</span>:<span class="w"> </span><span class="s2">&quot;exec&quot;</span>,
</span><span id="__span-8-71"><a id="__codelineno-8-71" name="__codelineno-8-71"></a><span class="w">                </span><span class="s2">&quot;_ansible_item_result&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-72"><a id="__codelineno-8-72" name="__codelineno-8-72"></a><span class="w">                </span><span class="s2">&quot;_ansible_no_log&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-8-73"><a id="__codelineno-8-73" name="__codelineno-8-73"></a><span class="w">                </span><span class="s2">&quot;_ansible_parsed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-74"><a id="__codelineno-8-74" name="__codelineno-8-74"></a><span class="w">                </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>true,
</span><span id="__span-8-75"><a id="__codelineno-8-75" name="__codelineno-8-75"></a><span class="w">                </span><span class="s2">&quot;commands&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-8-76"><a id="__codelineno-8-76" name="__codelineno-8-76"></a><span class="w">                    </span><span class="s2">&quot;banner exec @\n===This device is being managed by Ansible===\nMaking changes at your own risk!\n@&quot;</span>
</span><span id="__span-8-77"><a id="__codelineno-8-77" name="__codelineno-8-77"></a><span class="w">                </span><span class="o">]</span>,
</span><span id="__span-8-78"><a id="__codelineno-8-78" name="__codelineno-8-78"></a><span class="w">                </span><span class="s2">&quot;failed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-8-79"><a id="__codelineno-8-79" name="__codelineno-8-79"></a><span class="w">                </span><span class="s2">&quot;invocation&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-80"><a id="__codelineno-8-80" name="__codelineno-8-80"></a><span class="w">                    </span><span class="s2">&quot;module_args&quot;</span>:<span class="w"> </span><span class="o">{</span>
</span><span id="__span-8-81"><a id="__codelineno-8-81" name="__codelineno-8-81"></a><span class="w">                        </span><span class="s2">&quot;auth_pass&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-82"><a id="__codelineno-8-82" name="__codelineno-8-82"></a><span class="w">                        </span><span class="s2">&quot;authorize&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-83"><a id="__codelineno-8-83" name="__codelineno-8-83"></a><span class="w">                        </span><span class="s2">&quot;banner&quot;</span>:<span class="w"> </span><span class="s2">&quot;exec&quot;</span>,
</span><span id="__span-8-84"><a id="__codelineno-8-84" name="__codelineno-8-84"></a><span class="w">                        </span><span class="s2">&quot;host&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-85"><a id="__codelineno-8-85" name="__codelineno-8-85"></a><span class="w">                        </span><span class="s2">&quot;password&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-86"><a id="__codelineno-8-86" name="__codelineno-8-86"></a><span class="w">                        </span><span class="s2">&quot;port&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-87"><a id="__codelineno-8-87" name="__codelineno-8-87"></a><span class="w">                        </span><span class="s2">&quot;provider&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-88"><a id="__codelineno-8-88" name="__codelineno-8-88"></a><span class="w">                        </span><span class="s2">&quot;ssh_keyfile&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-89"><a id="__codelineno-8-89" name="__codelineno-8-89"></a><span class="w">                        </span><span class="s2">&quot;state&quot;</span>:<span class="w"> </span><span class="s2">&quot;present&quot;</span>,
</span><span id="__span-8-90"><a id="__codelineno-8-90" name="__codelineno-8-90"></a><span class="w">                        </span><span class="s2">&quot;text&quot;</span>:<span class="w"> </span><span class="s2">&quot;===This device is being managed by Ansible===\nMaking changes at your own risk!\n&quot;</span>,
</span><span id="__span-8-91"><a id="__codelineno-8-91" name="__codelineno-8-91"></a><span class="w">                        </span><span class="s2">&quot;timeout&quot;</span>:<span class="w"> </span>null,
</span><span id="__span-8-92"><a id="__codelineno-8-92" name="__codelineno-8-92"></a><span class="w">                        </span><span class="s2">&quot;username&quot;</span>:<span class="w"> </span>null
</span><span id="__span-8-93"><a id="__codelineno-8-93" name="__codelineno-8-93"></a><span class="w">                    </span><span class="o">}</span>
</span><span id="__span-8-94"><a id="__codelineno-8-94" name="__codelineno-8-94"></a><span class="w">                </span><span class="o">}</span>,
</span><span id="__span-8-95"><a id="__codelineno-8-95" name="__codelineno-8-95"></a><span class="w">                </span><span class="s2">&quot;item&quot;</span>:<span class="w"> </span><span class="s2">&quot;exec&quot;</span>
</span><span id="__span-8-96"><a id="__codelineno-8-96" name="__codelineno-8-96"></a><span class="w">            </span><span class="o">}</span>
</span><span id="__span-8-97"><a id="__codelineno-8-97" name="__codelineno-8-97"></a><span class="w">        </span><span class="o">]</span>
</span><span id="__span-8-98"><a id="__codelineno-8-98" name="__codelineno-8-98"></a><span class="w">    </span><span class="o">}</span>
</span><span id="__span-8-99"><a id="__codelineno-8-99" name="__codelineno-8-99"></a><span class="o">}</span>
</span></code></pre></div></td></tr></table></div></p>
<h3 id="summary"><a class="toclink" href="../../ansible-ios-banner/#summary">Summary</a></h3>
<p>The <code>ios_banner</code> module is a quick and handy module for those that need to have banners as part of
the operating entity. There are many reasons for banners that this is not going to explore further,
there are plenty of other resources (including possible Legal ones) available for this discussion.
Hopefully this has been a good primer of what things look like for the <code>ios_banner</code> and what output
looks like.</p>
    
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/22228848" alt="Josh VanDeraa">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2019-01-27 00:00:00">January 27, 2019</time></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="ansible-network-engine-and-ntc-templates"><a class="toclink" href="../../ansible-network-engine-ntc-templates/">Ansible Network Engine and NTC Templates</a></h2>
<p>In this post we will talk about primarily three components that will work together to get structured
data out of the command line of a Cisco device. The three pieces are:</p>
<ul>
<li><a href="https://github.com/ansible-network/network-engine">Ansible Network Engine</a>  </li>
<li><a href="https://github.com/google/textfsm">Google's TextFSM</a></li>
<li><a href="https://github.com/networktocode/ntc-templates">Network to Code Templates</a></li>
</ul>
<h3 id="why-this-post"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#why-this-post">Why this Post?</a></h3>
<p>I'm writing this post because I was initially hesitant to start using the Ansible role originally
when I was doing everything pretty well with the generic modules that come available with Ansible. I
was challenged to migrate a Python script that was using TextFSM and Netmiko to be in Ansible. So I
was originally aware of Ansible Network Engine, but had not done anything with it. So what better
time than to put it to practice than when it is needed.</p>
<h3 id="ansible-network-engine"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#ansible-network-engine">Ansible Network Engine</a></h3>
<p>The Ansible network engine is an Ansible role that is being developed by the Red Hat Ansible team.
From the Github page:</p>
<blockquote>
<p>This role provides the foundation for building network roles by providing modules and plug-ins that
are common to all Ansible Network roles.</p>
</blockquote>
<p>Within Ansible Network Engine you have the ability to <code>parse</code> the output of text. You can write your
own parser, or leverage some work that has been done by others (and willing to put the work out for
the good of the community - not stealing it).</p>
<blockquote>
<p>I'm going to recommend to read more on Ansible Network Engine parser with your own text parsing to
go to this site - <a href="https://termlen0.github.io/2018/06/26/observations/">https://termlen0.github.io/2018/06/26/observations/</a>
This post is more about using already existing TextFSM parsers with the help from NTC than the
parser itself.</p>
<p>A second link found recently is from the Ansible linklight (learning) team. Take a look here if
wanting to do more with Parsers. <a href="https://github.com/ansible/workshops/tree/master/exercises/ansible_network/supplemental/3-1-parser">https://github.com/ansible/workshops/tree/master/exercises/ansible_network/supplemental/3-1-parser</a></p>
</blockquote>
<h4 id="textfsm"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#textfsm">TextFSM</a></h4>
<p>From the Github page: </p>
<blockquote>
<p>TextFSM is a Python module which implements a template based state machine for parsing
semi-formatted text. Originally developed to allow programmatic access to information returned
from the command line interface (CLI) of networking devices.</p>
</blockquote>
<p>Basically the gist of things is that TextFSM takes text that is output from a show command and puts
it into structured data. It does this using a regex pattern matching setup under the hood. This can
be helpful for grabbing information out of a text blob issues to networking devices.</p>
<p>You <strong>must</strong> first install the textfsm python module for this to work. To install, I recommend
installing on both Python2 and Python3 in case the Ansible version is still using Python2:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip install textfsm
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>pip3 install textfsm
</span></code></pre></div>
<h4 id="textfsm-parser"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#textfsm-parser">TextFSM Parser</a></h4>
<p>Digging into the code on the Ansible Network Engine Github page you will find the file:
<a href="https://github.com/ansible-network/network-engine/blob/devel/library/textfsm_parser.py">https://github.com/ansible-network/network-engine/blob/devel/library/textfsm_parser.py</a></p>
<p>This is the TextFSM parser engine that is able to be leveraged. Looking at the Python file and the
<code>EXAMPLES</code> section you can find much more information about how to leverage the particular module.
From the Python file it has the following section:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">store returned facts into a key call output</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="nt">textfsm_parser</span><span class="p">:</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">files/parser_templates/show_interface.yaml</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">lookup(&#39;file&#39;,</span><span class="nv"> </span><span class="s">&#39;output/show_interfaces.txt&#39;)</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output</span>
</span></code></pre></div>
<p>Breaking this down further helps to get to the point. </p>
<p>Line 1: This is the name of the Ansible task, nothing new here<br />
Line 2: Calls the plugin <code>textfsm_parser</code><br />
Line 3: <code>File</code>, this is the parsing file that you are leveraging in the task, and where you would
call the file location for the ntc template
Line 4: <code>Content</code>, this is what you are going to send through the parser. In the example given it is
a file, but you can also have a variable of say output from a previous command run put in here
Line 5: <code>name</code>, this is where you will store the output data, it will be in a structured format</p>
<blockquote>
<p>This will not get into reading the output of the structured data. For more on that please take a
look back at my <a href="https://josh-v.com/blog/2019/01/05/ansible-output-work.html">previous post on working without output</a> </p>
</blockquote>
<p>The original tricky part was the part about the <code>File</code>. Originally a lot of posts related to having
a parser file all set to go. My original thinking was I don't see those parsers, but they are in the
examples. I decided to try to point the textfsm parser at an NTC template that had been downloaded.
After this, success. </p>
<p><code>Content</code> is the text that you want to send through the parser. So a variable or a text file</p>
<p>The <code>name</code> portion is what you are <em>registering</em> as facts that can be accessed underneath
<code>ansible_facts</code>. </p>
<h4 id="ntc-templates"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#ntc-templates">NTC Templates</a></h4>
<p>NTC (Network to Code) has a community environment with a significant number of parsers available. I
have found these particularly helpful in the Cisco environment. To install - checkout the Github
page.</p>
<p><a href="https://github.com/networktocode/ntc-templates">https://github.com/networktocode/ntc-templates</a></p>
<p>These are files, so the best methodology I have found is to download these to your machine using the
git process of cloning. There are updates made regularly, so make sure to do <code>git pull</code> to get the
most recent version. </p>
<blockquote>
<p>Pro tip: You may want to install these to your home directory. This is the default directory if
memory serves me right that Netmiko will look for the textfsm templates as well</p>
</blockquote>
<h3 id="sample"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#sample">Sample</a></h3>
<p>Here is the playbook that I will run against the lab environment.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nn">---</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1"># yamllint disable rule:truthy</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1"># yamllint disable rule:line-length</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Switch config</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span><span class="nt">connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network_cli</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">switches</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">  </span><span class="nt">become_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">  </span><span class="nt">roles</span><span class="p">:</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible-network.network-engine</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CLI &gt;&gt; Get CDP neighbors</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">      </span><span class="nt">ios_command</span><span class="p">:</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">        </span><span class="nt">commands</span><span class="p">:</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">show cdp neighbors</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">command_output</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SYS &gt;&gt; Parse CDP Information</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">      </span><span class="nt">textfsm_parser</span><span class="p">:</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">        </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/opt/ntc-templates/templates/cisco_ios_show_cdp_neighbors.template&quot;</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="w">        </span><span class="nt">content</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">command_output.stdout[0]</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cdp_facts</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG &gt;&gt; Print output</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">ansible_facts.cdp_facts</span><span class="nv"> </span><span class="s">}}&quot;</span>
</span></code></pre></div>
<h5 id="task-1-get-cdp-neighbor-information"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#task-1-get-cdp-neighbor-information">Task 1: Get CDP Neighbor information</a></h5>
<p>This task is going to log in and get the CDP neighbor information from the device and register it to
a fact <code>command_output</code></p>
<h5 id="task-2-send-through-the-parser"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#task-2-send-through-the-parser">Task 2: Send through the parser</a></h5>
<p>This is where the parser comes in, it will take the command output taken in the first task and send
it through the textfsm parser. This then registers the information underneath <code>ansible_facts</code>. The
next task is where you will see that output.</p>
<h5 id="task-3-prints-the-output"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#task-3-prints-the-output">Task 3: Prints the output</a></h5>
<p>You will see the information underneath the <code>ansible_facts</code> to get at the information as it sits
parsed.</p>
<h4 id="sample-output"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#sample-output">Sample Output</a></h4>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a>PLAY<span class="w"> </span><span class="o">[</span>Switch<span class="w"> </span>config<span class="o">]</span><span class="w"> </span>*******************************************************************************
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a>TASK<span class="w"> </span><span class="o">[</span>CLI<span class="w"> </span>&gt;&gt;<span class="w"> </span>Get<span class="w"> </span>CDP<span class="w"> </span>neighbors<span class="o">]</span><span class="w"> </span>********************************************************************
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>ok:<span class="w"> </span><span class="o">[</span>sw01<span class="o">]</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>TASK<span class="w"> </span><span class="o">[</span>SYS<span class="w"> </span>&gt;&gt;<span class="w"> </span>Parse<span class="w"> </span>CDP<span class="w"> </span>Information<span class="o">]</span><span class="w"> </span>****************************************************************
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a>ok:<span class="w"> </span><span class="o">[</span>sw01<span class="o">]</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>TASK<span class="w"> </span><span class="o">[</span>DEBUG<span class="w"> </span>&gt;&gt;<span class="w"> </span>Print<span class="w"> </span>output<span class="o">]</span><span class="w"> </span>***********************************************************************
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a>ok:<span class="w"> </span><span class="o">[</span>sw01<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="o">[</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">            </span><span class="s2">&quot;CAPABILITY&quot;</span>:<span class="w"> </span><span class="s2">&quot;R S&quot;</span>,
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">            </span><span class="s2">&quot;LOCAL_INTERFACE&quot;</span>:<span class="w"> </span><span class="s2">&quot;Gig 1/0&quot;</span>,
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">            </span><span class="s2">&quot;NEIGHBOR&quot;</span>:<span class="w"> </span><span class="s2">&quot;Switch&quot;</span>,
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">            </span><span class="s2">&quot;NEIGHBOR_INTERFACE&quot;</span>:<span class="w"> </span><span class="s2">&quot;Gig 1/0&quot;</span>,
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">            </span><span class="s2">&quot;PLATFORM&quot;</span>:<span class="w"> </span><span class="s2">&quot;I&quot;</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">        </span><span class="o">}</span>,
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">            </span><span class="s2">&quot;CAPABILITY&quot;</span>:<span class="w"> </span><span class="s2">&quot;R S&quot;</span>,
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">            </span><span class="s2">&quot;LOCAL_INTERFACE&quot;</span>:<span class="w"> </span><span class="s2">&quot;Gig 1/1&quot;</span>,
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">            </span><span class="s2">&quot;NEIGHBOR&quot;</span>:<span class="w"> </span><span class="s2">&quot;Switch&quot;</span>,
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">            </span><span class="s2">&quot;NEIGHBOR_INTERFACE&quot;</span>:<span class="w"> </span><span class="s2">&quot;Gig 1/1&quot;</span>,
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">            </span><span class="s2">&quot;PLATFORM&quot;</span>:<span class="w"> </span><span class="s2">&quot;I&quot;</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">        </span><span class="o">}</span>,
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="w">        </span><span class="o">{</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27"></a><span class="w">            </span><span class="s2">&quot;CAPABILITY&quot;</span>:<span class="w"> </span><span class="s2">&quot;R&quot;</span>,
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="w">            </span><span class="s2">&quot;LOCAL_INTERFACE&quot;</span>:<span class="w"> </span><span class="s2">&quot;Gig 0/0&quot;</span>,
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="w">            </span><span class="s2">&quot;NEIGHBOR&quot;</span>:<span class="w"> </span><span class="s2">&quot;router_edge&quot;</span>,
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="w">            </span><span class="s2">&quot;NEIGHBOR_INTERFACE&quot;</span>:<span class="w"> </span><span class="s2">&quot;Gig 0/2&quot;</span>,
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="w">            </span><span class="s2">&quot;PLATFORM&quot;</span>:<span class="w"> </span><span class="s2">&quot;B&quot;</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32"></a><span class="w">        </span><span class="o">}</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="w">    </span><span class="o">]</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="o">}</span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35"></a>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>*****************************************************************************************
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37"></a>sw01<span class="w">                       </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">3</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="summary"><a class="toclink" href="../../ansible-network-engine-ntc-templates/#summary">Summary</a></h3>
<p>Putting all of these together into a playbook you can more easily get at information presented from
a network device command line. Let's say you wanted to get CDP neighbors. The CDP neighbor command
output is tough to work with, other than seeing if something is in the output. </p>
    
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  <a class="md-pagination__link" href="../..">1</a> <span class="md-pagination__dots">..</span> <a class="md-pagination__link" href="../6/">6</a> <a class="md-pagination__link" href="../7/">7</a> <span class="md-pagination__current">8</span> <a class="md-pagination__link" href="../9/">9</a>
</nav>
        
      
    </div>
  </div>

          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" hidden>
        
        
          
          <a href="../../about/" class="md-footer__link md-footer__link--next" aria-label="Next: üë§ About">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                üë§ About
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2018 - 2024 Josh VanDeraa ‚Äì <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jvanderaa" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/josh-vanderaa/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/vanderaaj" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://fosstodon.org/@jvanderaa" target="_blank" rel="noopener me" title="fosstodon.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "content.code.copy", "content.action.view", "content.tabs.link", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.081f42fc.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>